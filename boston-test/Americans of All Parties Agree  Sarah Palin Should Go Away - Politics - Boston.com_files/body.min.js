
// Source: /js/libs/underscore-min.js
try{
//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/underscore-min.js", e)}};

// Source: /js/libs/backbone-min.js
try{
(function(){var t=this;var e=t.Backbone;var i=[];var r=i.push;var s=i.slice;var n=i.splice;var a;if(typeof exports!=="undefined"){a=exports}else{a=t.Backbone={}}a.VERSION="1.0.0";var h=t._;if(!h&&typeof require!=="undefined")h=require("underscore");a.$=t.jQuery||t.Zepto||t.ender||t.$;a.noConflict=function(){t.Backbone=e;return this};a.emulateHTTP=false;a.emulateJSON=false;var o=a.Events={on:function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);r.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var r=this;var s=h.once(function(){r.off(t,s);e.apply(this,arguments)});s._callback=e;return this.on(t,s,i)},off:function(t,e,i){var r,s,n,a,o,u,c,f;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}a=t?[t]:h.keys(this._events);for(o=0,u=a.length;o<u;o++){t=a[o];if(n=this._events[t]){this._events[t]=r=[];if(e||i){for(c=0,f=n.length;c<f;c++){s=n[c];if(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context){r.push(s)}}}if(!r.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t];var r=this._events.all;if(i)c(i,e);if(r)c(r,arguments);return this},stopListening:function(t,e,i){var r=this._listeners;if(!r)return this;var s=!e&&!i;if(typeof e==="object")i=this;if(t)(r={})[t._listenerId]=t;for(var n in r){r[n].off(e,i,this);if(s)delete this._listeners[n]}return this}};var u=/\s+/;var l=function(t,e,i,r){if(!i)return true;if(typeof i==="object"){for(var s in i){t[e].apply(t,[s,i[s]].concat(r))}return false}if(u.test(i)){var n=i.split(u);for(var a=0,h=n.length;a<h;a++){t[e].apply(t,[n[a]].concat(r))}return false}return true};var c=function(t,e){var i,r=-1,s=t.length,n=e[0],a=e[1],h=e[2];switch(e.length){case 0:while(++r<s)(i=t[r]).callback.call(i.ctx);return;case 1:while(++r<s)(i=t[r]).callback.call(i.ctx,n);return;case 2:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a);return;case 3:while(++r<s)(i=t[r]).callback.call(i.ctx,n,a,h);return;default:while(++r<s)(i=t[r]).callback.apply(i.ctx,e)}};var f={listenTo:"on",listenToOnce:"once"};h.each(f,function(t,e){o[e]=function(e,i,r){var s=this._listeners||(this._listeners={});var n=e._listenerId||(e._listenerId=h.uniqueId("l"));s[n]=e;if(typeof i==="object")r=this;e[t](i,r,this);return this}});o.bind=o.on;o.unbind=o.off;h.extend(a,o);var d=a.Model=function(t,e){var i;var r=t||{};e||(e={});this.cid=h.uniqueId("c");this.attributes={};h.extend(this,h.pick(e,p));if(e.parse)r=this.parse(r,e)||{};if(i=h.result(this,"defaults")){r=h.defaults({},r,i)}this.set(r,e);this.changed={};this.initialize.apply(this,arguments)};var p=["url","urlRoot","collection"];h.extend(d.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return h.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return h.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var r,s,n,a,o,u,l,c;if(t==null)return this;if(typeof t==="object"){s=t;i=e}else{(s={})[t]=e}i||(i={});if(!this._validate(s,i))return false;n=i.unset;o=i.silent;a=[];u=this._changing;this._changing=true;if(!u){this._previousAttributes=h.clone(this.attributes);this.changed={}}c=this.attributes,l=this._previousAttributes;if(this.idAttribute in s)this.id=s[this.idAttribute];for(r in s){e=s[r];if(!h.isEqual(c[r],e))a.push(r);if(!h.isEqual(l[r],e)){this.changed[r]=e}else{delete this.changed[r]}n?delete c[r]:c[r]=e}if(!o){if(a.length)this._pending=true;for(var f=0,d=a.length;f<d;f++){this.trigger("change:"+a[f],this,c[a[f]],i)}}if(u)return this;if(!o){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,h.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,h.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!h.isEmpty(this.changed);return h.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?h.clone(this.changed):false;var e,i=false;var r=this._changing?this._previousAttributes:this.attributes;for(var s in t){if(h.isEqual(r[s],e=t[s]))continue;(i||(i={}))[s]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return h.clone(this._previousAttributes)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(r){if(!e.set(e.parse(r,t),t))return false;if(i)i(e,r,t);e.trigger("sync",e,r,t)};R(this,t);return this.sync("read",this,t)},save:function(t,e,i){var r,s,n,a=this.attributes;if(t==null||typeof t==="object"){r=t;i=e}else{(r={})[t]=e}if(r&&(!i||!i.wait)&&!this.set(r,i))return false;i=h.extend({validate:true},i);if(!this._validate(r,i))return false;if(r&&i.wait){this.attributes=h.extend({},a,r)}if(i.parse===void 0)i.parse=true;var o=this;var u=i.success;i.success=function(t){o.attributes=a;var e=o.parse(t,i);if(i.wait)e=h.extend(r||{},e);if(h.isObject(e)&&!o.set(e,i)){return false}if(u)u(o,t,i);o.trigger("sync",o,t,i)};R(this,i);s=this.isNew()?"create":i.patch?"patch":"update";if(s==="patch")i.attrs=r;n=this.sync(s,this,i);if(r&&i.wait)this.attributes=a;return n},destroy:function(t){t=t?h.clone(t):{};var e=this;var i=t.success;var r=function(){e.trigger("destroy",e,e.collection,t)};t.success=function(s){if(t.wait||e.isNew())r();if(i)i(e,s,t);if(!e.isNew())e.trigger("sync",e,s,t)};if(this.isNew()){t.success();return false}R(this,t);var s=this.sync("delete",this,t);if(!t.wait)r();return s},url:function(){var t=h.result(this,"urlRoot")||h.result(this.collection,"url")||U();if(this.isNew())return t;return t+(t.charAt(t.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},h.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=h.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger("invalid",this,i,h.extend(e||{},{validationError:i}));return false}});var v=["keys","values","pairs","invert","pick","omit"];h.each(v,function(t){d.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.attributes);return h[t].apply(h,e)}});var g=a.Collection=function(t,e){e||(e={});if(e.url)this.url=e.url;if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,h.extend({silent:true},e))};var m={add:true,remove:true,merge:true};var y={add:true,merge:false,remove:false};h.extend(g.prototype,o,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(t,e){return this.set(t,h.defaults(e||{},y))},remove:function(t,e){t=h.isArray(t)?t.slice():[t];e||(e={});var i,r,s,n;for(i=0,r=t.length;i<r;i++){n=this.get(t[i]);if(!n)continue;delete this._byId[n.id];delete this._byId[n.cid];s=this.indexOf(n);this.models.splice(s,1);this.length--;if(!e.silent){e.index=s;n.trigger("remove",n,this,e)}this._removeReference(n)}return this},set:function(t,e){e=h.defaults(e||{},m);if(e.parse)t=this.parse(t,e);if(!h.isArray(t))t=t?[t]:[];var i,s,a,o,u,l;var c=e.at;var f=this.comparator&&c==null&&e.sort!==false;var d=h.isString(this.comparator)?this.comparator:null;var p=[],v=[],g={};for(i=0,s=t.length;i<s;i++){if(!(a=this._prepareModel(t[i],e)))continue;if(u=this.get(a)){if(e.remove)g[u.cid]=true;if(e.merge){u.set(a.attributes,e);if(f&&!l&&u.hasChanged(d))l=true}}else if(e.add){p.push(a);a.on("all",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}}if(e.remove){for(i=0,s=this.length;i<s;++i){if(!g[(a=this.models[i]).cid])v.push(a)}if(v.length)this.remove(v,e)}if(p.length){if(f)l=true;this.length+=p.length;if(c!=null){n.apply(this.models,[c,0].concat(p))}else{r.apply(this.models,p)}}if(l)this.sort({silent:true});if(e.silent)return this;for(i=0,s=p.length;i<s;i++){(a=p[i]).trigger("add",a,this,e)}if(l)this.trigger("sort",this,e);return this},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;i<r;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();this.add(t,h.extend({silent:true},e));if(!e.silent)this.trigger("reset",this,e);return this},push:function(t,e){t=this._prepareModel(t,e);this.add(t,h.extend({at:this.length},e));return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){t=this._prepareModel(t,e);this.add(t,h.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){if(t==null)return void 0;return this._byId[t.id!=null?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){if(h.isEmpty(t))return e?void 0:[];return this[e?"find":"filter"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");t||(t={});if(h.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(h.bind(this.comparator,this))}if(!t.silent)this.trigger("sort",this,t);return this},sortedIndex:function(t,e,i){e||(e=this.comparator);var r=h.isFunction(e)?e:function(t){return t.get(e)};return h.sortedIndex(this.models,t,r,i)},pluck:function(t){return h.invoke(this.models,"get",t)},fetch:function(t){t=t?h.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(r){var s=t.reset?"reset":"set";i[s](r,t);if(e)e(i,r,t);i.trigger("sync",i,r,t)};R(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?h.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var r=e.success;e.success=function(s){if(e.wait)i.add(t,e);if(r)r(t,s,e)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof d){if(!t.collection)t.collection=this;return t}e||(e={});e.collection=this;var i=new this.model(t,e);if(!i._validate(t,e)){this.trigger("invalid",this,t,e);return false}return i},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,r){if((t==="add"||t==="remove")&&i!==this)return;if(t==="destroy")this.remove(e,r);if(e&&t==="change:"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];h.each(_,function(t){g.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.models);return h[t].apply(h,e)}});var w=["groupBy","countBy","sortBy"];h.each(w,function(t){g.prototype[t]=function(e,i){var r=h.isFunction(e)?e:function(t){return t.get(e)};return h[t](this.models,r,i)}});var b=a.View=function(t){this.cid=h.uniqueId("view");this._configure(t||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var x=/^(\S+)\s*(.*)$/;var E=["model","collection","el","id","attributes","className","tagName","events"];h.extend(b.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){if(this.$el)this.undelegateEvents();this.$el=t instanceof a.$?t:a.$(t);this.el=this.$el[0];if(e!==false)this.delegateEvents();return this},delegateEvents:function(t){if(!(t||(t=h.result(this,"events"))))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(!h.isFunction(i))i=this[t[e]];if(!i)continue;var r=e.match(x);var s=r[1],n=r[2];i=h.bind(i,this);s+=".delegateEvents"+this.cid;if(n===""){this.$el.on(s,i)}else{this.$el.on(s,n,i)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(t){if(this.options)t=h.extend({},h.result(this,"options"),t);h.extend(this,h.pick(t,E));this.options=t},_ensureElement:function(){if(!this.el){var t=h.extend({},h.result(this,"attributes"));if(this.id)t.id=h.result(this,"id");if(this.className)t["class"]=h.result(this,"className");var e=a.$("<"+h.result(this,"tagName")+">").attr(t);this.setElement(e,false)}else{this.setElement(h.result(this,"el"),false)}}});a.sync=function(t,e,i){var r=k[t];h.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var s={type:r,dataType:"json"};if(!i.url){s.url=h.result(e,"url")||U()}if(i.data==null&&e&&(t==="create"||t==="update"||t==="patch")){s.contentType="application/json";s.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){s.contentType="application/x-www-form-urlencoded";s.data=s.data?{model:s.data}:{}}if(i.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){s.type="POST";if(i.emulateJSON)s.data._method=r;var n=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",r);if(n)return n.apply(this,arguments)}}if(s.type!=="GET"&&!i.emulateJSON){s.processData=false}if(s.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var o=i.xhr=a.ajax(h.extend(s,i));e.trigger("request",e,o,i);return o};var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var S=a.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var $=/\((.*?)\)/g;var T=/(\(\?)?:\w+/g;var H=/\*\w+/g;var A=/[\-{}\[\]+?.,\\\^$|#\s]/g;h.extend(S.prototype,o,{initialize:function(){},route:function(t,e,i){if(!h.isRegExp(t))t=this._routeToRegExp(t);if(h.isFunction(e)){i=e;e=""}if(!i)i=this[e];var r=this;a.history.route(t,function(s){var n=r._extractParameters(t,s);i&&i.apply(r,n);r.trigger.apply(r,["route:"+e].concat(n));r.trigger("route",e,n);a.history.trigger("route",r,e,n)});return this},navigate:function(t,e){a.history.navigate(t,e);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=h.result(this,"routes");var t,e=h.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(A,"\\$&").replace($,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/]+)"}).replace(H,"(.*?)");return new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return h.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=a.History=function(){this.handlers=[];h.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var N=/^[#\/]|\s+$/g;var P=/^\/+|\/+$/g;var O=/msie [\w.]+/;var C=/\/$/;I.started=false;h.extend(I.prototype,o,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(t==null){if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,"");if(!t.indexOf(i))t=t.substr(i.length)}else{t=this.getHash()}}return t.replace(N,"")},start:function(t){if(I.started)throw new Error("Backbone.history has already been started");I.started=true;this.options=h.extend({},{root:"/"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment();var i=document.documentMode;var r=O.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(P,"/");if(r&&this._wantsHashChange){this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(e)}if(this._hasPushState){a.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!r){a.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=e;var s=this.location;var n=s.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!n){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&n&&s.hash){this.fragment=this.getHash().replace(N,"");this.history.replaceState({},document.title,this.root+this.fragment+s.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getFragment(this.getHash(this.iframe))}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(t){var e=this.fragment=this.getFragment(t);var i=h.any(this.handlers,function(t){if(t.route.test(e)){t.callback(e);return true}});return i},navigate:function(t,e){if(!I.started)return false;if(!e||e===true)e={trigger:e};t=this.getFragment(t||"");if(this.fragment===t)return;this.fragment=t;var i=this.root+t;if(this._hasPushState){this.history[e.replace?"replaceState":"pushState"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){if(!e.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}else{return this.location.assign(i)}if(e.trigger)this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else{t.hash="#"+e}}});a.history=new I;var j=function(t,e){var i=this;var r;if(t&&h.has(t,"constructor")){r=t.constructor}else{r=function(){return i.apply(this,arguments)}}h.extend(r,i,e);var s=function(){this.constructor=r};s.prototype=i.prototype;r.prototype=new s;if(t)h.extend(r.prototype,t);r.__super__=i.prototype;return r};d.extend=g.extend=S.extend=b.extend=I.extend=j;var U=function(){throw new Error('A "url" property or function must be specified')};var R=function(t,e){var i=e.error;e.error=function(r){if(i)i(t,r,e);t.trigger("error",t,r,e)}}}).call(this);
/*
//@ sourceMappingURL=backbone-min.map
*/
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/backbone-min.js", e)}};

// Source: /js/libs/backbone.layoutmanager.min.js
try{
/*!
 * backbone.layoutmanager.js v0.9.5
 * Copyright 2013, Tim Branyen (@tbranyen)
 * backbone.layoutmanager.js may be freely distributed under the MIT license.
 */
(function(window,factory){if(typeof define==="function"&&define.amd){return define(["backbone","underscore","jquery"],function(){return factory.apply(window,arguments)})}else{if(typeof exports==="object"){var Backbone=require("backbone");var _=require("underscore");Backbone.$=Backbone.$||require("jquery");module.exports=factory.call(window,Backbone,_,Backbone.$)}else{factory.call(window,window.Backbone,window._,window.Backbone.$)}}}(typeof global==="object"?global:this,function(Backbone,_,$){var window=this;var ViewConstructor=Backbone.View;var aPush=Array.prototype.push;var aConcat=Array.prototype.concat;var aSplice=Array.prototype.splice;var trim=String.prototype.trim?_.bind(String.prototype.trim.call,String.prototype.trim):$.trim;var LayoutManager=Backbone.View.extend({_render:function(){var view=this;var manager=view.__manager__;var beforeRender=view.beforeRender;var def=view.deferred();if(view.hasRendered){view._removeViews()}manager.callback=function(){delete manager.isAsync;delete manager.callback;view.trigger("beforeRender",view);view._viewRender(manager).render().then(function(){def.resolve()})};if(beforeRender){beforeRender.call(view,view)}if(!manager.isAsync){manager.callback()}return def.promise()},_applyTemplate:function(rendered,manager,def){if(_.isString(rendered)){if(manager.noel){rendered=$.parseHTML(rendered,true);this.$el.slice(1).remove();this.$el.replaceWith(rendered);this.setElement(rendered,false)}else{this.html(this.$el,rendered)}}def.resolveWith(this,[this])},_viewRender:function(manager){var url,contents,def;var root=this;function done(context,template){var rendered;manager.callback=function(rendered){delete manager.isAsync;delete manager.callback;root._applyTemplate(rendered,manager,def)};LayoutManager.cache(url,template);if(template){rendered=root.renderTemplate.call(root,template,context)}if(!manager.isAsync){root._applyTemplate(rendered,manager,def)}}return{render:function(){var context=root.serialize;var template=root.template;def=root.deferred();if(_.isFunction(context)){context=context.call(root)}manager.callback=function(contents){delete manager.isAsync;delete manager.callback;done(context,contents)};if(typeof template==="string"){url=root.prefix+template}if(contents=LayoutManager.cache(url)){done(context,contents,url);return def}if(typeof template==="string"){contents=root.fetchTemplate.call(root,root.prefix+template)}else{if(typeof template==="function"){contents=template}else{if(template!=null){contents=root.fetchTemplate.call(root,template)}}}if(!manager.isAsync){done(context,contents)}return def}}},constructor:function Layout(options){this.manage=true;_.extend(this,options);Backbone.View.apply(this,arguments)},async:function(){var manager=this.__manager__;manager.isAsync=true;return manager.callback},promise:function(){return this.__manager__.renderDeferred.promise()},renderViews:function(){var root=this;var manager=root.__manager__;var newDeferred=root.deferred();var promises=root.getViews().map(function(view){return view.render().__manager__.renderDeferred}).value();manager.renderDeferred=newDeferred.promise();root.when(promises).then(function(){newDeferred.resolveWith(root,[root])});return root},insertView:function(selector,view){if(view){return this.setView(selector,view,true)}return this.setView(selector,true)},insertViews:function(views){if(_.isArray(views)){return this.setViews({"":views})}_.each(views,function(view,selector){views[selector]=_.isArray(view)?view:[view]});return this.setViews(views)},getView:function(fn){if(fn==null){fn=arguments[1]}return this.getViews(fn).first().value()},getViews:function(fn){var views;if(typeof fn==="string"){fn=this.sections[fn]||fn;views=this.views[fn]||[];return _.chain([].concat(views))}views=_.chain(this.views).map(function(view){return _.isArray(view)?view:[view]},this).flatten();if(typeof fn==="object"){return views.where(fn)}return typeof fn==="function"?views.filter(fn):views},removeView:function(fn){return this.getViews(fn).each(function(nestedView){nestedView.remove()})},setView:function(name,view,insert){var manager,selector;var root=this;if(typeof name!=="string"){insert=view;view=name;name=""}manager=view.__manager__;if(!manager){throw new Error("The argument associated with selector '"+name+"' is defined and a View.  Set `manage` property to true for Backbone.View instances.")}manager.parent=root;selector=manager.selector=root.sections[name]||name;if(!insert){if(root.getView(name)!==view){root.removeView(name)}return root.views[selector]=view}root.views[selector]=aConcat.call([],root.views[name]||[],view);root.__manager__.insert=true;return view},setViews:function(views){_.each(views,function(view,name){if(_.isArray(view)){return _.each(view,function(view){this.insertView(name,view)},this)}this.setView(name,view)},this);return this},render:function(){var root=this;var manager=root.__manager__;var parent=manager.parent;var rentManager=parent&&parent.__manager__;var def=root.deferred();function resolve(){var next;_.each(root.views,function(views,selector){if(_.isArray(views)){root.htmlBatch(root,views,selector)}});if(parent&&!manager.insertedViaFragment){if(!root.contains(parent.el,root.el)){parent.partial(parent.$el,root.$el,rentManager,manager)}}root.delegateEvents();root.hasRendered=true;if(next=manager.queue.shift()){next()}else{delete manager.queue}function completeRender(){var console=window.console;var afterRender=root.afterRender;if(afterRender){afterRender.call(root,root)}root.trigger("afterRender",root);if(manager.noel&&root.$el.length>1){if(_.isFunction(console.warn)&&!root.suppressWarnings){console.warn("`el: false` with multiple top level elements is not supported.");if(_.isFunction(console.trace)){console.trace()}}}}if(rentManager&&rentManager.queue){parent.once("afterRender",completeRender)}else{completeRender()}return def.resolveWith(root,[root])}function actuallyRender(){root._render().done(function(){if(!_.keys(root.views).length){return resolve()}var promises=_.map(root.views,function(view){var insert=_.isArray(view);if(insert&&view.length){return root.when(_.map(view,function(subView){subView.__manager__.insertedViaFragment=true;return subView.render().__manager__.renderDeferred}))}return !insert?view.render().__manager__.renderDeferred:view});root.when(promises).done(resolve)})}if(manager.queue){aPush.call(manager.queue,actuallyRender)}else{manager.queue=[];actuallyRender(root,def)}root.__manager__.renderDeferred=def;return root},remove:function(){LayoutManager._removeView(this,true);return this._remove.apply(this,arguments)}},{_cache:{},_removeViews:function(root,force){if(typeof root==="boolean"){force=root;root=this}root=root||this;root.getViews().each(function(view){if(view.hasRendered||force){LayoutManager._removeView(view,force)}})},_removeView:function(view,force){var parentViews;var manager=view.__manager__;var rentManager=manager.parent&&manager.parent.__manager__;var keep=typeof view.keep==="boolean"?view.keep:view.options.keep;if((!keep&&rentManager&&rentManager.insert===true)||force){LayoutManager.cleanViews(view);view._removeViews(true);view.$el.remove();if(!manager.parent){return}parentViews=manager.parent.views[manager.selector];if(_.isArray(parentViews)){return _.each(_.clone(parentViews),function(view,i){if(view&&view.__manager__===manager){aSplice.call(parentViews,i,1)}})}delete manager.parent.views[manager.selector]}},cache:function(path,contents){if(path in this._cache&&contents==null){return this._cache[path]}else{if(path!=null&&contents!=null){return this._cache[path]=contents}}},cleanViews:function(views){_.each(aConcat.call([],views),function(view){view.unbind();if(view.model instanceof Backbone.Model){view.model.off(null,null,view)}if(view.collection instanceof Backbone.Collection){view.collection.off(null,null,view)}view.stopListening();if(_.isFunction(view.cleanup)){view.cleanup()}})},configure:function(options){_.extend(LayoutManager.prototype,options);if(options.manage){Backbone.View.prototype.manage=true}if(options.el===false){Backbone.View.prototype.el=false}if(options.suppressWarnings===true){Backbone.View.prototype.suppressWarnings=true}},setupView:function(views,options){options=_.extend({},options);_.each(aConcat.call([],views),function(view){if(view.__manager__){return}var views,declaredViews;var proto=LayoutManager.prototype;_.defaults(view,{views:{},sections:{},__manager__:{},_removeViews:LayoutManager._removeViews,_removeView:LayoutManager._removeView},LayoutManager.prototype);view.options=options;_.extend(view,options);view._remove=Backbone.View.prototype.remove;view.render=LayoutManager.prototype.render;if(view.remove!==proto.remove){view._remove=view.remove;view.remove=proto.remove}views=options.views||view.views;if(_.keys(views).length){declaredViews=views;view.views={};_.each(declaredViews,function(declaredView,key){if(typeof declaredView==="function"){declaredViews[key]=declaredView.call(view,view)}});view.setViews(declaredViews)}})}});LayoutManager.VERSION="0.9.5";Backbone.Layout=LayoutManager;Backbone.View=function(options){var noel;options=options||{};if("el" in options?options.el===false:this.el===false){noel=true}if(options.manage||this.manage){LayoutManager.setupView(this,options)}if(this.__manager__){this.__manager__.noel=noel;this.__manager__.suppressWarnings=options.suppressWarnings}ViewConstructor.apply(this,arguments)};Backbone.View.extend=ViewConstructor.extend;Backbone.View.prototype=ViewConstructor.prototype;var defaultOptions={prefix:"",deferred:function(){return $.Deferred()},fetchTemplate:function(path){return _.template($(path).html())},renderTemplate:function(template,context){return trim(template.call(this,context))},serialize:function(){return this.model?_.clone(this.model.attributes):{}},partial:function($root,$el,rentManager,manager){var $filtered;if(manager.selector){if(rentManager.noel){$filtered=$root.filter(manager.selector);$root=$filtered.length?$filtered:$root.find(manager.selector)}else{$root=$root.find(manager.selector)}}if(rentManager.insert){this.insert($root,$el)}else{this.html($root,$el)}},html:function($root,content){$root.html(content)},htmlBatch:function(rootView,subViews,selector){var rentManager=rootView.__manager__;var manager={selector:selector};var els=_.reduce(subViews,function(memo,sub){var keep=typeof sub.keep==="boolean"?sub.keep:sub.options.keep;var exists=keep&&$.contains(rootView.el,sub.el);if(sub.el&&!exists){memo.push(sub.el)}return memo},[]);return this.partial(rootView.$el,$(els),rentManager,manager)},insert:function($root,$el){$root.append($el)},when:function(promises){return $.when.apply(null,promises)},contains:function(parent,child){return $.contains(parent,child)}};_.extend(LayoutManager.prototype,defaultOptions);return LayoutManager}));
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/backbone.layoutmanager.min.js", e)}};

// Source: /js/libs/pubnub.min.js
try{
// Version: 3.5.4
(function(){
var m=null,t=!1;function u(){return function(){}}
window.JSON&&window.JSON.stringify||function(){function a(){try{return this.valueOf()}catch(a){return m}}function c(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=E[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(d,g){var p,l,q,r,i,j=e,h=g[d];h&&"object"===typeof h&&(h=a.call(h));"function"===typeof f&&(h=f.call(g,d,h));switch(typeof h){case "string":return c(h);case "number":return isFinite(h)?String(h):"null";case "boolean":case "null":return String(h);
case "object":if(!h)return"null";e+=s;i=[];if("[object Array]"===Object.prototype.toString.apply(h)){r=h.length;for(p=0;p<r;p+=1)i[p]=b(p,h)||"null";q=0===i.length?"[]":e?"[\n"+e+i.join(",\n"+e)+"\n"+j+"]":"["+i.join(",")+"]";e=j;return q}if(f&&"object"===typeof f){r=f.length;for(p=0;p<r;p+=1)l=f[p],"string"===typeof l&&(q=b(l,h))&&i.push(c(l)+(e?": ":":")+q)}else for(l in h)Object.hasOwnProperty.call(h,l)&&(q=b(l,h))&&i.push(c(l)+(e?": ":":")+q);q=0===i.length?"{}":e?"{\n"+e+i.join(",\n"+e)+"\n"+
j+"}":"{"+i.join(",")+"}";e=j;return q}}window.JSON||(window.JSON={});var d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,s,E={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},f;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,c,d){var l;s=e="";if("number"===typeof d)for(l=0;l<d;l+=1)s+=" ";else"string"===typeof d&&(s=d);if((f=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==
typeof c.length))throw Error("JSON.stringify");return b("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a){return eval("("+a+")")})}();var aa=1,v=t,ba=[],z="-pnpres",D=1E3,da="/",ea="&",fa=/{([\w\-]+)}/g;function ga(){return"x"+ ++aa+""+ +new Date}function F(){return+new Date}var G,ha=Math.floor(20*Math.random());G=function(a,c){return 0<a.indexOf("pubsub.")&&a.replace("pubsub","ps"+(c?ja().split("-")[0]:20>++ha?ha:ha=1))||a};
function ka(a,c){var b=a.join(da),d=[];if(!c)return b;P(c,function(a,b){"undefined"!=typeof b&&(b!=m&&0<la(b,".!~*'()").length)&&d.push(a+"="+la(b,".!~*'()"))});return b+="?"+d.join(ea)}function na(a,c){function b(){e+c>F()?(clearTimeout(d),d=setTimeout(b,c)):(e=F(),a())}var d,e=0;return b}function oa(a,c){var b=[];P(a||[],function(a){c(a)&&b.push(a)});return b}function pa(a,c){return a.replace(fa,function(a,d){return c[d]||a})}
function ja(a){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)});a&&a(c);return c}function P(a,c){if(a&&c)if("undefined"!=typeof a[0])for(var b=0,d=a.length;b<d;)c.call(a[b],a[b],b++);else for(b in a)a.hasOwnProperty&&a.hasOwnProperty(b)&&c.call(a[b],b,a[b])}function Q(a,c){var b=[];P(a||[],function(a,e){b.push(c(a,e))});return b}
function la(a,c){return Q(encodeURIComponent(a).split(""),function(a){return 0>c.indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")}function U(a){return la(a,"-_.!~*'()")}function qa(a){var c=[];P(a,function(a,d){d.j&&c.push(a)});return c.sort()}function ra(){setTimeout(function(){v||(v=1,P(ba,function(a){a()}))},D)}
if(!window.PUBNUB){var sa=function(a,c){return CryptoJS.HmacSHA256(a,c).toString(CryptoJS.enc.Base64)},ta=function(a){return document.getElementById(a)},ua=function(a){console.error(a)},va=function(a,c){var b=[];P(a.split(/\s+/),function(a){P((c||document).getElementsByTagName(a),function(a){b.push(a)})});return b},V=function(a,c,b){P(a.split(","),function(a){function e(a){a||(a=window.event);b(a)||(a.cancelBubble=!0,a.returnValue=t,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}
c.addEventListener?c.addEventListener(a,e,t):c.attachEvent?c.attachEvent("on"+a,e):c["on"+a]=e})},xa=function(){return va("head")[0]},W=function(a,c,b){if(b)a.setAttribute(c,b);else return a&&a.getAttribute&&a.getAttribute(c)},ya=function(a,c){for(var b in c)if(c.hasOwnProperty(b))try{a.style[b]=c[b]+(0<"|width|height|top|left|".indexOf(b)&&"number"==typeof c[b]?"px":"")}catch(d){}},Ba=function(a){return document.createElement(a)},Da=function(){return Ca||X()?0:ga()},Fa=function(a){function c(a,b){K||
(K=1,h.onerror=m,clearTimeout(L),a||!b||M(b),setTimeout(function(){a&&ca();var b=ta(A),c=b&&b.parentNode;c&&c.removeChild(b)},D))}if(Ca||X()){a:{var b,d,e=function(){if(!E){E=1;clearTimeout(O);try{d=JSON.parse(b.responseText)}catch(a){return r(1)}s=1;l(d)}},s=0,E=0,f=a.timeout||1E4,O=setTimeout(function(){r(1)},f),g=a.b||u(),p=a.data||{},l=a.c||u(),q="undefined"===typeof a.g,r=function(a,c){s||(s=1,clearTimeout(O),b&&(b.onerror=b.onload=m,b.abort&&b.abort(),b=m),a&&g(c))};try{b=X()||window.XDomainRequest&&
new XDomainRequest||new XMLHttpRequest;b.onerror=b.onabort=function(){r(1,b.responseText||{error:"Network Connection Error"})};b.onload=b.onloadend=e;b.onreadystatechange=function(){if(4==b.readyState)switch(b.status){case 401:case 402:case 403:try{d=JSON.parse(b.responseText),r(1,d)}catch(a){return r(1,b.responseText)}}};q&&(b.timeout=f);p.pnsdk=Ea;var i=ka(a.url,p);b.open("GET",i,q);b.send()}catch(j){r(0);Ca=0;a=Fa(a);break a}a=r}return a}var h=Ba("script"),e=a.a,A=ga(),K=0,L=setTimeout(function(){c(1)},
a.timeout||1E4),ca=a.b||u(),f=a.data||{},M=a.c||u();window[e]=function(a){c(0,a)};a.g||(h[Ga]=Ga);h.onerror=function(){c(1)};f.pnsdk=Ea;h.src=ka(a.url,f);W(h,"id",A);xa().appendChild(h);return c},Ha=function(){return!("onLine"in navigator)?1:navigator.onLine},X=function(){if(!Ia||!Ia.get)return 0;var a={id:X.id++,send:u(),abort:function(){a.id={}},open:function(c,b){X[a.id]=a;Ia.get(a.id,b)}};return a},Ga="async",Ea="PubNub-JS-Web/3.5.4",Ca=-1==navigator.userAgent.indexOf("MSIE 6");window.console||
(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||u());var Ja,Ka=window.localStorage;Ja={get:function(a){try{return Ka?Ka.getItem(a):-1==document.cookie.indexOf(a)?m:((document.cookie||"").match(RegExp(a+"=([^;]+)"))||[])[1]||m}catch(c){}},set:function(a,c){try{if(Ka)return Ka.setItem(a,c)&&0;document.cookie=a+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(b){}}};var Y={list:{},unbind:function(a){Y.list[a]=[]},bind:function(a,c){(Y.list[a]=
Y.list[a]||[]).push(c)},fire:function(a,c){P(Y.list[a]||[],function(a){a(c)})}},Z=ta("pubnub")||0,La=function(a){function c(){}function b(a,b){function c(b){b&&(ia=F()-(b/1E4+(F()-d)/2),a&&a(ia))}var d=F();b&&c(b)||w.time(c)}function d(a,b){R&&R(a,b);R=m}function e(){w.time(function(a){b(u(),a);a||d(1,{error:"Heartbeat failed to connect to Pubnub Servers. Please check your network settings."});setTimeout(e,q)})}function s(){Na()||d(1,{error:"Offline. Please check your network settings. "});setTimeout(s,
D)}function E(a){var b=0;P(qa(I),function(c){if(c=I[c])b++,(a||u())(c)});return b}function f(a){a&&(B.h=0);!B.h&&B.length&&(B.h=1,x(B.shift()))}a.jsonp&&(Ca=0);var O=a.subscribe_key||"";a.uuid||Ja.get(O+"uuid");a.xdr=Fa;a.db=Ja;a.error=ua;a._is_online=Ha;a.jsonp_cb=Da;a.PNSDK=Ea;a.hmac_SHA256=sa;var g,p=+a.windowing||10,l=(+a.timeout||310)*D,q=(+a.keepalive||60)*D,r=a.noleave||0,i=a.publish_key||"",j=a.subscribe_key||"",h=a.auth_key||"",A=a.secret_key||"",K=a.PNSDK||"",L=a.hmac_SHA256,ca=a.ssl?"s":
"",M="http"+ca+"://"+(a.origin||"pubsub.pubnub.com"),H=G(M),wa=G(M),B=[],ia=0,za=0,Aa=0,R=0,ma=0,S=0,I={},x=a.xdr,k=a.error||u(),Na=a._is_online||function(){return 1},C=a.jsonp_cb||function(){return 0},T=a.db||{get:u(),set:u()},J=a.uuid||T&&T.get(j+"uuid")||"",w={LEAVE:function(a,b){var c={uuid:J,auth:h},d=G(M),e=C();!(0<a.indexOf(z))&&!r&&("0"!=e&&(c.callback=e),x({g:b||ca,timeout:2E3,a:e,data:c,url:[d,"v2","presence","sub_key",j,"channel",U(a),"leave"]}))},history:function(a,b){var b=a.callback||
b,c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||u(),Oa=a.auth_key||h,y=a.channel,N=a.start,g=a.end,n={},i=C();if(!y)return k("Missing Channel");if(!b)return k("Missing Callback");if(!j)return k("Missing Subscribe Key");n.stringtoken="true";n.count=c;n.reverse=d;n.auth=Oa;i&&(n.callback=i);N&&(n.start=N);g&&(n.end=g);x({a:i,data:n,c:function(a){"object"==typeof a&&a.error?e(a):b(a)},b:e,url:[H,"v2","history","sub-key",j,"channel",U(y)]})},replay:function(a){var b=b||a.callback||u(),c=a.auth_key||
h,d=a.source,e=a.destination,g=a.stop,y=a.start,N=a.end,l=a.reverse,a=a.limit,n=C(),f={};if(!d)return k("Missing Source Channel");if(!e)return k("Missing Destination Channel");if(!i)return k("Missing Publish Key");if(!j)return k("Missing Subscribe Key");"0"!=n&&(f.callback=n);g&&(f.stop="all");l&&(f.reverse="true");y&&(f.start=y);N&&(f.end=N);a&&(f.count=a);f.auth=c;x({a:n,c:function(a){"object"==typeof a&&a.error?err(a):b(a)},b:function(){b([0,"Disconnected"])},url:[H,"v1","replay",i,j,d,e],data:f})},
auth:function(a){h=a;c()},time:function(a){var b=C();x({a:b,data:{uuid:J,auth:h},timeout:5*D,url:[H,"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,b){var b=b||a.callback||u(),c=a.message,d=a.channel,e=a.auth_key||h,g=a.error||u(),y=C();if(!c)return k("Missing Message");if(!d)return k("Missing Channel");if(!i)return k("Missing Publish Key");if(!j)return k("Missing Subscribe Key");c=JSON.stringify(c);c=[H,"publish",i,j,0,U(d),y,U(c)];B.push({a:y,timeout:5*D,url:c,data:{uuid:J,
auth:e},c:function(a){"object"==typeof a&&a.error?g(a):b(a);f(1)},b:function(a){g(a);f(1)}});f()},unsubscribe:function(a){a=a.channel;S=0;ma=1;a=Q((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+z}).join(",");P(a.split(","),function(a){v&&w.LEAVE(a,0);I[a]=0});c()},subscribe:function(a,b){function e(a){a?setTimeout(c,D):(H=G(M,1),wa=G(M,1),setTimeout(function(){w.time(e)},D));E(function(b){if(a&&b.d)return b.d=0,b.m(b.name);!a&&!b.d&&(b.d=1,b.l(b.name))})}function g(){var a=C(),b=
qa(I).join(",");b&&(d(),R=x({timeout:O,a:a,b:function(a){n(a);R=m;w.time(e)},data:{uuid:J,auth:i},url:[wa,"subscribe",j,U(b),a,S],c:function(a){R=m;if(!a||"object"==typeof a&&"error"in a&&a.error)return n(a),setTimeout(c,D);r(a[1]);S=!S&&ma&&T.get(j)||a[1];E(function(a){a.f||(a.f=1,a.k(a.name))});B&&(S=1E4,B=0);T.set(j,a[1]);var b,d=(2<a.length?a[2]:Q(I,function(b){return Q(Array(a[0].length).join(",").split(","),function(){return b})}).join(",")).split(",");b=function(){var a=d.shift()||Aa;return[(I[a]||
{}).a||za,a.split(z)[0]]};var e=F()-ia-+a[1]/1E4;P(a[0],function(c){var d=b();d[0](c,a,d[1],e)});setTimeout(g,L)}}))}var f=a.channel,b=(b=b||a.callback)||a.message,i=a.auth_key||h,y=a.connect||u(),N=a.reconnect||u(),q=a.disconnect||u(),n=a.error||u(),r=a.idle||u(),s=a.presence||0,A=a.noheresync||0,B=a.backfill||0,K=a.timetoken||0,O=a.timeout||l,L=a.windowing||p;ma=a.restore;S=K;if(!f)return k("Missing Channel");if(!b)return k("Missing Callback");if(!j)return k("Missing Subscribe Key");P((f.join?f.join(","):
""+f).split(","),function(a){var c=I[a]||{};I[Aa=a]={name:a,f:c.f,d:c.d,j:1,a:za=b,k:y,l:q,m:N};s&&(w.subscribe({channel:a+z,callback:s}),!c.j&&!A&&w.here_now({channel:a,callback:function(b){P("uuids"in b?b.uuids:[],function(c){s({action:"join",uuid:c,timestamp:F(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){d();setTimeout(g,L)};if(!v)return ba.push(c);c()},here_now:function(a,b){var b=a.callback||b,c=a.error||u(),d=a.auth_key||h,e=a.channel,g=C(),d={uuid:J,auth:d};if(!e)return k("Missing Channel");
if(!b)return k("Missing Callback");if(!j)return k("Missing Subscribe Key");"0"!=g&&(d.callback=g);x({a:g,data:d,c:function(a){"object"==typeof a&&a.error?c(a):b(a)},b:c,url:[H,"v2","presence","sub_key",j,"channel",U(e)]})},grant:function(a,b){var b=a.callback||b,c=a.error||u(),d=a.channel,e=C(),g=a.ttl||-1,h=a.read?"1":"0",f=a.write?"1":"0",l=a.auth_key;if(!d)return k("Missing Channel");if(!b)return k("Missing Callback");if(!j)return k("Missing Subscribe Key");if(!i)return k("Missing Publish Key");
if(!A)return k("Missing Secret Key");"0"!=e&&(n.callback=e);var n=Math.floor((new Date).getTime()/1E3),p=L(j+"\n"+i+"\ngrant\n"+(l&&0<encodeURIComponent(l).length?"auth="+encodeURIComponent(l)+"&":"")+"channel="+encodeURIComponent(d)+"&pnsdk="+encodeURIComponent(K)+"&r="+h+"&timestamp="+encodeURIComponent(n)+(-1<g?"&ttl="+g:"")+"&w="+f,A),p=p.replace(RegExp("\\+","g"),"-"),p=p.replace(RegExp("\\/","g"),"_"),n={w:f,r:h,signature:p,channel:encodeURIComponent(d),timestamp:n};-1<g&&(n.ttl=g);l&&(n.auth=
encodeURIComponent(l));x({a:e,data:n,c:function(a){b(a)},b:c,url:[H,"v1","auth","grant","sub-key",j]})},audit:function(a,b){var b=a.callback||b,c=a.error||u(),d=a.channel,e=C(),g=a.auth_key;if(!b)return k("Missing Callback");if(!j)return k("Missing Subscribe Key");if(!i)return k("Missing Publish Key");if(!A)return k("Missing Secret Key");"0"!=e&&(h.callback=e);var h=Math.floor((new Date).getTime()/1E3),f=j+"\n"+i+"\naudit\n";g&&(f+="auth="+encodeURIComponent(g)+"&");d&&(f+="channel="+encodeURIComponent(d)+
"&");var f=f+("pnsdk="+encodeURIComponent(K)+"&timestamp="+h),f=L(f,A),f=f.replace(RegExp("\\+","g"),"-"),f=f.replace(RegExp("\\/","g"),"_"),h={signature:f,timestamp:h};d&&(h.channel=encodeURIComponent(d));g&&(h.auth=encodeURIComponent(g));x({a:e,data:h,c:function(a){b(a)},b:c,url:[H,"v1","auth","audit","sub-key",j]})},revoke:function(a,b){a.read=t;a.write=t;w.grant(a,b)},xdr:x,ready:ra,db:T,uuid:ja,map:Q,each:P,"each-channel":E,grep:oa,offline:function(){d(1)},supplant:pa,now:F,unique:ga,updater:na};
J||(J=w.uuid());T.set(j+"uuid",J);setTimeout(s,D);setTimeout(e,q);b();g=w;g.css=ya;g.$=ta;g.create=Ba;g.bind=V;g.head=xa;g.search=va;g.attr=W;g.events=Y;g.init=La;V("beforeunload",window,function(){g["each-channel"](function(a){g.LEAVE(a.name,0)});return!0});if(a.notest)return g;V("offline",window,g.offline);V("offline",document,g.offline);return g};V("load",window,function(){setTimeout(ra,0)});var $=Z||{};PUBNUB=La({notest:1,publish_key:W($,"pub-key"),subscribe_key:W($,"sub-key"),ssl:!document.location.href.indexOf("https")||
"on"==W($,"ssl"),origin:W($,"origin"),uuid:W($,"uuid")});window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);"undefined"!==typeof module&&(module.exports=PUBNUB)&&ra();var Ia=ta("pubnubs")||0;if(Z){ya(Z,{position:"absolute",top:-D});if("opera"in window||W(Z,"flash"))Z.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";PUBNUB.rdx=function(a,c){if(!c)return X[a].onerror();
X[a].responseText=unescape(c);X[a].onload()};X.id=D}}
var Ma=PUBNUB.ws=function(a,c){if(!(this instanceof Ma))return new Ma(a,c);var b=this,a=b.url=a||"";b.protocol=c||"Sec-WebSocket-Protocol";var d=a.split("/"),d={ssl:"wss:"===d[0],origin:d[2],publish_key:d[3],subscribe_key:d[4],channel:d[5]};b.CONNECTING=0;b.OPEN=1;b.CLOSING=2;b.CLOSED=3;b.CLOSE_NORMAL=1E3;b.CLOSE_GOING_AWAY=1001;b.CLOSE_PROTOCOL_ERROR=1002;b.CLOSE_UNSUPPORTED=1003;b.CLOSE_TOO_LARGE=1004;b.CLOSE_NO_STATUS=1005;b.CLOSE_ABNORMAL=1006;b.onclose=b.onerror=b.onmessage=b.onopen=b.onsend=
u();b.binaryType="";b.extensions="";b.bufferedAmount=0;b.trasnmitting=t;b.buffer=[];b.readyState=b.CONNECTING;if(!a)return b.readyState=b.CLOSED,b.onclose({code:b.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),b;b.e=PUBNUB.init(d);b.e.i=d;b.i=d;b.e.subscribe({restore:t,channel:d.channel,disconnect:b.onerror,reconnect:b.onopen,error:function(){b.onclose({code:b.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:t})},callback:function(a){b.onmessage({data:a})},connect:function(){b.readyState=b.OPEN;b.onopen()}})};
Ma.prototype.send=function(a){var c=this;c.e.publish({channel:c.e.i.channel,message:a,callback:function(a){c.onsend({data:a})}})};
})();

}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/pubnub.min.js", e)}};

// Source: /js/libs/notify.min.js
try{
(function(root,factory){if(typeof define==="function"&&define.amd){define("notify",[],function(){return factory(root,document)})}else{root.Notify=factory(root,document)}}(this,function(w,d){function Notify(title,options){this.title=typeof title==="string"?title:null;this.options={icon:"",body:"",tag:"",notifyShow:null,notifyClose:null,notifyClick:null,notifyError:null,permissionGranted:null,permissionDenied:null,timeout:null};this.permission=null;if(!Notify.isSupported()){return}if(!this.title){throw new Error("Notify(): first arg (title) must be a string.")}if(typeof options==="object"){for(var i in options){if(options.hasOwnProperty(i)){this.options[i]=options[i]}}if(typeof this.options.notifyShow==="function"){this.onShowCallback=this.options.notifyShow}if(typeof this.options.notifyClose==="function"){this.onCloseCallback=this.options.notifyClose}if(typeof this.options.notifyClick==="function"){this.onClickCallback=this.options.notifyClick}if(typeof this.options.notifyError==="function"){this.onErrorCallback=this.options.notifyError}}}Notify.isSupported=function(){if("Notification" in w){return true}return false};Notify.needsPermission=function(){if(Notify.isSupported()&&Notification.permission==="granted"){return false}return true};Notify.requestPermission=function(onPermissionGrantedCallback,onPermissionDeniedCallback){if(Notify.isSupported()){w.Notification.requestPermission(function(perm){switch(perm){case"granted":if(typeof onPermissionGrantedCallback==="function"){onPermissionGrantedCallback()}break;case"denied":if(typeof onPermissionDeniedCallback==="function"){onPermissionDeniedCallback()}break}})}};Notify.prototype.show=function(){var that=this;if(!Notify.isSupported()){return}this.myNotify=new Notification(this.title,{body:this.options.body,tag:this.options.tag,icon:this.options.icon});if(this.options.timeout&&!isNaN(this.options.timeout)){setTimeout(this.close.bind(this),this.options.timeout*1000)}this.myNotify.addEventListener("show",this,false);this.myNotify.addEventListener("error",this,false);this.myNotify.addEventListener("close",this,false);this.myNotify.addEventListener("click",this,false)};Notify.prototype.onShowNotification=function(e){if(this.onShowCallback){this.onShowCallback(e)}};Notify.prototype.onCloseNotification=function(){if(this.onCloseCallback){this.onCloseCallback()}this.destroy()};Notify.prototype.onClickNotification=function(){if(this.onClickCallback){this.onClickCallback()}};Notify.prototype.onErrorNotification=function(){if(this.onErrorCallback){this.onErrorCallback()}this.destroy()};Notify.prototype.destroy=function(){this.myNotify.removeEventListener("show",this,false);this.myNotify.removeEventListener("error",this,false);this.myNotify.removeEventListener("close",this,false);this.myNotify.removeEventListener("click",this,false)};Notify.prototype.close=function(){this.myNotify.close()};Notify.prototype.handleEvent=function(e){switch(e.type){case"show":this.onShowNotification(e);break;case"close":this.onCloseNotification(e);break;case"click":this.onClickNotification(e);break;case"error":this.onErrorNotification(e);break}};return Notify}));
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/notify.min.js", e)}};

// Source: /js/libs/mustache.min.js
try{
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
(function(root,factory){if(typeof exports==="object"&&exports){factory(exports)}else{var mustache={};factory(mustache);if(typeof define==="function"&&define.amd){define(mustache)}else{root.Mustache=mustache}}}(this,function(mustache){var RegExp_test=RegExp.prototype.test;function testRegExp(re,string){return RegExp_test.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return !testRegExp(nonSpaceRe,string)}var Object_toString=Object.prototype.toString;var isArray=Array.isArray||function(object){return Object_toString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeHtml(string){return String(string).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})}function escapeTags(tags){if(!isArray(tags)||tags.length!==2){throw new Error("Invalid tags: "+tags)}return[new RegExp(escapeRegExp(tags[0])+"\\s*"),new RegExp("\\s*"+escapeRegExp(tags[1]))]}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){tags=tags||mustache.tags;template=template||"";if(typeof tags==="string"){tags=tags.split(spaceRe)}var tagRes=escapeTags(tags);var scanner=new Scanner(template);var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length){delete tokens[spaces.pop()]}}else{spaces=[]}hasTag=false;nonSpace=false}var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(tagRes[0]);if(value){for(var i=0,len=value.length;i<len;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n"){stripSpace()}}}if(!scanner.scan(tagRes[0])){break}hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(tagRes[1])}else{if(type==="{"){value=scanner.scanUntil(new RegExp("\\s*"+escapeRegExp("}"+tags[1])));scanner.scan(curlyRe);scanner.scanUntil(tagRes[1]);type="&"}else{value=scanner.scanUntil(tagRes[1])}}if(!scanner.scan(tagRes[1])){throw new Error("Unclosed tag at "+scanner.pos)}token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else{if(type==="/"){openSection=sections.pop();if(!openSection){throw new Error('Unopened section "'+value+'" at '+start)}if(openSection[1]!==value){throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}}else{if(type==="name"||type==="{"||type==="&"){nonSpace=true}else{if(type==="="){tagRes=escapeTags(tags=value.split(spaceRe))}}}}}openSection=sections.pop();if(openSection){throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos)}return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function(){return this.tail===""};Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(match&&match.index===0){var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string}return""};Scanner.prototype.scanUntil=function(re){var index=this.tail.search(re),match;switch(index){case -1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view==null?{}:view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function(view){return new Context(view,this)};Context.prototype.lookup=function(name){var value;if(name in this.cache){value=this.cache[name]}else{var context=this;while(context){if(name.indexOf(".")>0){value=context.view;var names=name.split("."),i=0;while(value!=null&&i<names.length){value=value[names[i++]]}}else{value=context.view[name]}if(value!=null){break}context=context.parent}this.cache[name]=value}if(isFunction(value)){value=value.call(this.view)}return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function(){this.cache={}};Writer.prototype.parse=function(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null){tokens=cache[template]=parseTemplate(template,tags)}return tokens};Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template);var context=(view instanceof Context)?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){var buffer="";var self=this;function subRender(template){return self.render(template,context,partials)}var token,value;for(var i=0,len=tokens.length;i<len;++i){token=tokens[i];switch(token[0]){case"#":value=context.lookup(token[1]);if(!value){continue}if(isArray(value)){for(var j=0,jlen=value.length;j<jlen;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else{if(typeof value==="object"||typeof value==="string"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else{if(isFunction(value)){if(typeof originalTemplate!=="string"){throw new Error("Cannot use higher-order sections without the original template")}value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null){buffer+=value}}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}}}break;case"^":value=context.lookup(token[1]);if(!value||(isArray(value)&&value.length===0)){buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}break;case">":if(!partials){continue}value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null){buffer+=this.renderTokens(this.parse(value),context,partials,value)}break;case"&":value=context.lookup(token[1]);if(value!=null){buffer+=value}break;case"name":value=context.lookup(token[1]);if(value!=null){buffer+=mustache.escape(value)}break;case"text":buffer+=token[1];break}}return buffer};mustache.name="mustache.js";mustache.version="0.8.1";mustache.tags=["{{","}}"];var defaultWriter=new Writer();mustache.clearCache=function(){return defaultWriter.clearCache()};mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function(template,view,partials){return defaultWriter.render(template,view,partials)};mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer}));
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/mustache.min.js", e)}};

// Source: /js/libs/magnific-popup/dist/jquery.magnific-popup.min.js
try{
/*! Magnific Popup - v0.9.8 - 2013-10-26
* http://dimsemenov.com/plugins/magnific-popup/
* Copyright (c) 2013 Dmitry Semenov; */
(function(e){var t,i,n,o,r,a,s,l="Close",c="BeforeClose",d="AfterClose",u="BeforeAppend",p="MarkupParse",f="Open",m="Change",g="mfp",v="."+g,h="mfp-ready",C="mfp-removing",y="mfp-prevent-close",w=function(){},b=!!window.jQuery,I=e(window),x=function(e,i){t.ev.on(g+e+v,i)},k=function(t,i,n,o){var r=document.createElement("div");return r.className="mfp-"+t,n&&(r.innerHTML=n),o?i&&i.appendChild(r):(r=e(r),i&&r.appendTo(i)),r},T=function(i,n){t.ev.triggerHandler(g+i,n),t.st.callbacks&&(i=i.charAt(0).toLowerCase()+i.slice(1),t.st.callbacks[i]&&t.st.callbacks[i].apply(t,e.isArray(n)?n:[n]))},E=function(){(t.st.focus?t.content.find(t.st.focus).eq(0):t.wrap).focus()},S=function(i){return i===s&&t.currTemplate.closeBtn||(t.currTemplate.closeBtn=e(t.st.closeMarkup.replace("%title%",t.st.tClose)),s=i),t.currTemplate.closeBtn},P=function(){e.magnificPopup.instance||(t=new w,t.init(),e.magnificPopup.instance=t)},_=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(void 0!==e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1};w.prototype={constructor:w,init:function(){var i=navigator.appVersion;t.isIE7=-1!==i.indexOf("MSIE 7."),t.isIE8=-1!==i.indexOf("MSIE 8."),t.isLowIE=t.isIE7||t.isIE8,t.isAndroid=/android/gi.test(i),t.isIOS=/iphone|ipad|ipod/gi.test(i),t.supportsTransition=_(),t.probablyMobile=t.isAndroid||t.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),n=e(document.body),o=e(document),t.popupsCache={}},open:function(i){var n;if(i.isObj===!1){t.items=i.items.toArray(),t.index=0;var r,s=i.items;for(n=0;s.length>n;n++)if(r=s[n],r.parsed&&(r=r.el[0]),r===i.el[0]){t.index=n;break}}else t.items=e.isArray(i.items)?i.items:[i.items],t.index=i.index||0;if(t.isOpen)return t.updateItemHTML(),void 0;t.types=[],a="",t.ev=i.mainEl&&i.mainEl.length?i.mainEl.eq(0):o,i.key?(t.popupsCache[i.key]||(t.popupsCache[i.key]={}),t.currTemplate=t.popupsCache[i.key]):t.currTemplate={},t.st=e.extend(!0,{},e.magnificPopup.defaults,i),t.fixedContentPos="auto"===t.st.fixedContentPos?!t.probablyMobile:t.st.fixedContentPos,t.st.modal&&(t.st.closeOnContentClick=!1,t.st.closeOnBgClick=!1,t.st.showCloseBtn=!1,t.st.enableEscapeKey=!1),t.bgOverlay||(t.bgOverlay=k("bg").on("click"+v,function(){t.close()}),t.wrap=k("wrap").attr("tabindex",-1).on("click"+v,function(e){t._checkIfClose(e.target)&&t.close()}),t.container=k("container",t.wrap)),t.contentContainer=k("content"),t.st.preloader&&(t.preloader=k("preloader",t.container,t.st.tLoading));var l=e.magnificPopup.modules;for(n=0;l.length>n;n++){var c=l[n];c=c.charAt(0).toUpperCase()+c.slice(1),t["init"+c].call(t)}T("BeforeOpen"),t.st.showCloseBtn&&(t.st.closeBtnInside?(x(p,function(e,t,i,n){i.close_replaceWith=S(n.type)}),a+=" mfp-close-btn-in"):t.wrap.append(S())),t.st.alignTop&&(a+=" mfp-align-top"),t.fixedContentPos?t.wrap.css({overflow:t.st.overflowY,overflowX:"hidden",overflowY:t.st.overflowY}):t.wrap.css({top:I.scrollTop(),position:"absolute"}),(t.st.fixedBgPos===!1||"auto"===t.st.fixedBgPos&&!t.fixedContentPos)&&t.bgOverlay.css({height:o.height(),position:"absolute"}),t.st.enableEscapeKey&&o.on("keyup"+v,function(e){27===e.keyCode&&t.close()}),I.on("resize"+v,function(){t.updateSize()}),t.st.closeOnContentClick||(a+=" mfp-auto-cursor"),a&&t.wrap.addClass(a);var d=t.wH=I.height(),u={};if(t.fixedContentPos&&t._hasScrollBar(d)){var m=t._getScrollbarSize();m&&(u.marginRight=m)}t.fixedContentPos&&(t.isIE7?e("body, html").css("overflow","hidden"):u.overflow="hidden");var g=t.st.mainClass;return t.isIE7&&(g+=" mfp-ie7"),g&&t._addClassToMFP(g),t.updateItemHTML(),T("BuildControls"),e("html").css(u),t.bgOverlay.add(t.wrap).prependTo(document.body),t._lastFocusedEl=document.activeElement,setTimeout(function(){t.content?(t._addClassToMFP(h),E()):t.bgOverlay.addClass(h),o.on("focusin"+v,function(i){return i.target===t.wrap[0]||e.contains(t.wrap[0],i.target)?void 0:(E(),!1)})},16),t.isOpen=!0,t.updateSize(d),T(f),i},close:function(){t.isOpen&&(T(c),t.isOpen=!1,t.st.removalDelay&&!t.isLowIE&&t.supportsTransition?(t._addClassToMFP(C),setTimeout(function(){t._close()},t.st.removalDelay)):t._close())},_close:function(){T(l);var i=C+" "+h+" ";if(t.bgOverlay.detach(),t.wrap.detach(),t.container.empty(),t.st.mainClass&&(i+=t.st.mainClass+" "),t._removeClassFromMFP(i),t.fixedContentPos){var n={marginRight:""};t.isIE7?e("body, html").css("overflow",""):n.overflow="",e("html").css(n)}o.off("keyup"+v+" focusin"+v),t.ev.off(v),t.wrap.attr("class","mfp-wrap").removeAttr("style"),t.bgOverlay.attr("class","mfp-bg"),t.container.attr("class","mfp-container"),!t.st.showCloseBtn||t.st.closeBtnInside&&t.currTemplate[t.currItem.type]!==!0||t.currTemplate.closeBtn&&t.currTemplate.closeBtn.detach(),t._lastFocusedEl&&e(t._lastFocusedEl).focus(),t.currItem=null,t.content=null,t.currTemplate=null,t.prevHeight=0,T(d)},updateSize:function(e){if(t.isIOS){var i=document.documentElement.clientWidth/window.innerWidth,n=window.innerHeight*i;t.wrap.css("height",n),t.wH=n}else t.wH=e||I.height();t.fixedContentPos||t.wrap.css("height",t.wH),T("Resize")},updateItemHTML:function(){var i=t.items[t.index];t.contentContainer.detach(),t.content&&t.content.detach(),i.parsed||(i=t.parseEl(t.index));var n=i.type;if(T("BeforeChange",[t.currItem?t.currItem.type:"",n]),t.currItem=i,!t.currTemplate[n]){var o=t.st[n]?t.st[n].markup:!1;T("FirstMarkupParse",o),t.currTemplate[n]=o?e(o):!0}r&&r!==i.type&&t.container.removeClass("mfp-"+r+"-holder");var a=t["get"+n.charAt(0).toUpperCase()+n.slice(1)](i,t.currTemplate[n]);t.appendContent(a,n),i.preloaded=!0,T(m,i),r=i.type,t.container.prepend(t.contentContainer),T("AfterChange")},appendContent:function(e,i){t.content=e,e?t.st.showCloseBtn&&t.st.closeBtnInside&&t.currTemplate[i]===!0?t.content.find(".mfp-close").length||t.content.append(S()):t.content=e:t.content="",T(u),t.container.addClass("mfp-"+i+"-holder"),t.contentContainer.append(t.content)},parseEl:function(i){var n=t.items[i],o=n.type;if(n=n.tagName?{el:e(n)}:{data:n,src:n.src},n.el){for(var r=t.types,a=0;r.length>a;a++)if(n.el.hasClass("mfp-"+r[a])){o=r[a];break}n.src=n.el.attr("data-mfp-src"),n.src||(n.src=n.el.attr("href"))}return n.type=o||t.st.type||"inline",n.index=i,n.parsed=!0,t.items[i]=n,T("ElementParse",n),t.items[i]},addGroup:function(e,i){var n=function(n){n.mfpEl=this,t._openClick(n,e,i)};i||(i={});var o="click.magnificPopup";i.mainEl=e,i.items?(i.isObj=!0,e.off(o).on(o,n)):(i.isObj=!1,i.delegate?e.off(o).on(o,i.delegate,n):(i.items=e,e.off(o).on(o,n)))},_openClick:function(i,n,o){var r=void 0!==o.midClick?o.midClick:e.magnificPopup.defaults.midClick;if(r||2!==i.which&&!i.ctrlKey&&!i.metaKey){var a=void 0!==o.disableOn?o.disableOn:e.magnificPopup.defaults.disableOn;if(a)if(e.isFunction(a)){if(!a.call(t))return!0}else if(a>I.width())return!0;i.type&&(i.preventDefault(),t.isOpen&&i.stopPropagation()),o.el=e(i.mfpEl),o.delegate&&(o.items=n.find(o.delegate)),t.open(o)}},updateStatus:function(e,n){if(t.preloader){i!==e&&t.container.removeClass("mfp-s-"+i),n||"loading"!==e||(n=t.st.tLoading);var o={status:e,text:n};T("UpdateStatus",o),e=o.status,n=o.text,t.preloader.html(n),t.preloader.find("a").on("click",function(e){e.stopImmediatePropagation()}),t.container.addClass("mfp-s-"+e),i=e}},_checkIfClose:function(i){if(!e(i).hasClass(y)){var n=t.st.closeOnContentClick,o=t.st.closeOnBgClick;if(n&&o)return!0;if(!t.content||e(i).hasClass("mfp-close")||t.preloader&&i===t.preloader[0])return!0;if(i===t.content[0]||e.contains(t.content[0],i)){if(n)return!0}else if(o&&e.contains(document,i))return!0;return!1}},_addClassToMFP:function(e){t.bgOverlay.addClass(e),t.wrap.addClass(e)},_removeClassFromMFP:function(e){this.bgOverlay.removeClass(e),t.wrap.removeClass(e)},_hasScrollBar:function(e){return(t.isIE7?o.height():document.body.scrollHeight)>(e||I.height())},_parseMarkup:function(t,i,n){var o;n.data&&(i=e.extend(n.data,i)),T(p,[t,i,n]),e.each(i,function(e,i){if(void 0===i||i===!1)return!0;if(o=e.split("_"),o.length>1){var n=t.find(v+"-"+o[0]);if(n.length>0){var r=o[1];"replaceWith"===r?n[0]!==i[0]&&n.replaceWith(i):"img"===r?n.is("img")?n.attr("src",i):n.replaceWith('<img src="'+i+'" class="'+n.attr("class")+'" />'):n.attr(o[1],i)}}else t.find(v+"-"+e).html(i)})},_getScrollbarSize:function(){if(void 0===t.scrollbarSize){var e=document.createElement("div");e.id="mfp-sbm",e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t.scrollbarSize=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t.scrollbarSize}},e.magnificPopup={instance:null,proto:w.prototype,modules:[],open:function(t,i){return P(),t=t?e.extend(!0,{},t):{},t.isObj=!0,t.index=i||0,this.instance.open(t)},close:function(){return e.magnificPopup.instance&&e.magnificPopup.instance.close()},registerModule:function(t,i){i.options&&(e.magnificPopup.defaults[t]=i.options),e.extend(this.proto,i.proto),this.modules.push(t)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&times;</button>',tClose:"Close (Esc)",tLoading:"Loading..."}},e.fn.magnificPopup=function(i){P();var n=e(this);if("string"==typeof i)if("open"===i){var o,r=b?n.data("magnificPopup"):n[0].magnificPopup,a=parseInt(arguments[1],10)||0;r.items?o=r.items[a]:(o=n,r.delegate&&(o=o.find(r.delegate)),o=o.eq(a)),t._openClick({mfpEl:o},n,r)}else t.isOpen&&t[i].apply(t,Array.prototype.slice.call(arguments,1));else i=e.extend(!0,{},i),b?n.data("magnificPopup",i):n[0].magnificPopup=i,t.addGroup(n,i);return n};var O,z,M,B="inline",H=function(){M&&(z.after(M.addClass(O)).detach(),M=null)};e.magnificPopup.registerModule(B,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){t.types.push(B),x(l+"."+B,function(){H()})},getInline:function(i,n){if(H(),i.src){var o=t.st.inline,r=e(i.src);if(r.length){var a=r[0].parentNode;a&&a.tagName&&(z||(O=o.hiddenClass,z=k(O),O="mfp-"+O),M=r.after(z).detach().removeClass(O)),t.updateStatus("ready")}else t.updateStatus("error",o.tNotFound),r=e("<div>");return i.inlineElement=r,r}return t.updateStatus("ready"),t._parseMarkup(n,{},i),n}}});var L,A="ajax",F=function(){L&&n.removeClass(L)},j=function(){F(),t.req&&t.req.abort()};e.magnificPopup.registerModule(A,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){t.types.push(A),L=t.st.ajax.cursor,x(l+"."+A,j),x("BeforeChange."+A,j)},getAjax:function(i){L&&n.addClass(L),t.updateStatus("loading");var o=e.extend({url:i.src,success:function(n,o,r){var a={data:n,xhr:r};T("ParseAjax",a),t.appendContent(e(a.data),A),i.finished=!0,F(),E(),setTimeout(function(){t.wrap.addClass(h)},16),t.updateStatus("ready"),T("AjaxContentAdded")},error:function(){F(),i.finished=i.loadError=!0,t.updateStatus("error",t.st.ajax.tError.replace("%url%",i.src))}},t.st.ajax.settings);return t.req=e.ajax(o),""}}});var N,W=function(i){if(i.data&&void 0!==i.data.title)return i.data.title;var n=t.st.image.titleSrc;if(n){if(e.isFunction(n))return n.call(t,i);if(i.el)return i.el.attr(n)||""}return""};e.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure"><div class="mfp-close"></div><figure><div class="mfp-img"></div><figcaption><div class="mfp-bottom-bar"><div class="mfp-title"></div><div class="mfp-counter"></div></div></figcaption></figure></div>',cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:!0,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var e=t.st.image,i=".image";t.types.push("image"),x(f+i,function(){"image"===t.currItem.type&&e.cursor&&n.addClass(e.cursor)}),x(l+i,function(){e.cursor&&n.removeClass(e.cursor),I.off("resize"+v)}),x("Resize"+i,t.resizeImage),t.isLowIE&&x("AfterChange",t.resizeImage)},resizeImage:function(){var e=t.currItem;if(e&&e.img&&t.st.image.verticalFit){var i=0;t.isLowIE&&(i=parseInt(e.img.css("padding-top"),10)+parseInt(e.img.css("padding-bottom"),10)),e.img.css("max-height",t.wH-i)}},_onImageHasSize:function(e){e.img&&(e.hasSize=!0,N&&clearInterval(N),e.isCheckingImgSize=!1,T("ImageHasSize",e),e.imgHidden&&(t.content&&t.content.removeClass("mfp-loading"),e.imgHidden=!1))},findImageSize:function(e){var i=0,n=e.img[0],o=function(r){N&&clearInterval(N),N=setInterval(function(){return n.naturalWidth>0?(t._onImageHasSize(e),void 0):(i>200&&clearInterval(N),i++,3===i?o(10):40===i?o(50):100===i&&o(500),void 0)},r)};o(1)},getImage:function(i,n){var o=0,r=function(){i&&(i.img[0].complete?(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("ready")),i.hasSize=!0,i.loaded=!0,T("ImageLoadComplete")):(o++,200>o?setTimeout(r,100):a()))},a=function(){i&&(i.img.off(".mfploader"),i===t.currItem&&(t._onImageHasSize(i),t.updateStatus("error",s.tError.replace("%url%",i.src))),i.hasSize=!0,i.loaded=!0,i.loadError=!0)},s=t.st.image,l=n.find(".mfp-img");if(l.length){var c=document.createElement("img");c.className="mfp-img",i.img=e(c).on("load.mfploader",r).on("error.mfploader",a),c.src=i.src,l.is("img")&&(i.img=i.img.clone()),i.img[0].naturalWidth>0&&(i.hasSize=!0)}return t._parseMarkup(n,{title:W(i),img_replaceWith:i.img},i),t.resizeImage(),i.hasSize?(N&&clearInterval(N),i.loadError?(n.addClass("mfp-loading"),t.updateStatus("error",s.tError.replace("%url%",i.src))):(n.removeClass("mfp-loading"),t.updateStatus("ready")),n):(t.updateStatus("loading"),i.loading=!0,i.hasSize||(i.imgHidden=!0,n.addClass("mfp-loading"),t.findImageSize(i)),n)}}});var R,Z=function(){return void 0===R&&(R=void 0!==document.createElement("p").style.MozTransform),R};e.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(e){return e.is("img")?e:e.find("img")}},proto:{initZoom:function(){var e,i=t.st.zoom,n=".zoom";if(i.enabled&&t.supportsTransition){var o,r,a=i.duration,s=function(e){var t=e.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),n="all "+i.duration/1e3+"s "+i.easing,o={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},r="transition";return o["-webkit-"+r]=o["-moz-"+r]=o["-o-"+r]=o[r]=n,t.css(o),t},d=function(){t.content.css("visibility","visible")};x("BuildControls"+n,function(){if(t._allowZoom()){if(clearTimeout(o),t.content.css("visibility","hidden"),e=t._getItemToZoom(),!e)return d(),void 0;r=s(e),r.css(t._getOffset()),t.wrap.append(r),o=setTimeout(function(){r.css(t._getOffset(!0)),o=setTimeout(function(){d(),setTimeout(function(){r.remove(),e=r=null,T("ZoomAnimationEnded")},16)},a)},16)}}),x(c+n,function(){if(t._allowZoom()){if(clearTimeout(o),t.st.removalDelay=a,!e){if(e=t._getItemToZoom(),!e)return;r=s(e)}r.css(t._getOffset(!0)),t.wrap.append(r),t.content.css("visibility","hidden"),setTimeout(function(){r.css(t._getOffset())},16)}}),x(l+n,function(){t._allowZoom()&&(d(),r&&r.remove(),e=null)})}},_allowZoom:function(){return"image"===t.currItem.type},_getItemToZoom:function(){return t.currItem.hasSize?t.currItem.img:!1},_getOffset:function(i){var n;n=i?t.currItem.img:t.st.zoom.opener(t.currItem.el||t.currItem);var o=n.offset(),r=parseInt(n.css("padding-top"),10),a=parseInt(n.css("padding-bottom"),10);o.top-=e(window).scrollTop()-r;var s={width:n.width(),height:(b?n.innerHeight():n[0].offsetHeight)-a-r};return Z()?s["-moz-transform"]=s.transform="translate("+o.left+"px,"+o.top+"px)":(s.left=o.left,s.top=o.top),s}}});var q="iframe",D="//about:blank",K=function(e){if(t.currTemplate[q]){var i=t.currTemplate[q].find("iframe");i.length&&(e||(i[0].src=D),t.isIE8&&i.css("display",e?"block":"none"))}};e.magnificPopup.registerModule(q,{options:{markup:'<div class="mfp-iframe-scaler"><div class="mfp-close"></div><iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe></div>',srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){t.types.push(q),x("BeforeChange",function(e,t,i){t!==i&&(t===q?K():i===q&&K(!0))}),x(l+"."+q,function(){K()})},getIframe:function(i,n){var o=i.src,r=t.st.iframe;e.each(r.patterns,function(){return o.indexOf(this.index)>-1?(this.id&&(o="string"==typeof this.id?o.substr(o.lastIndexOf(this.id)+this.id.length,o.length):this.id.call(this,o)),o=this.src.replace("%id%",o),!1):void 0});var a={};return r.srcAction&&(a[r.srcAction]=o),t._parseMarkup(n,a,i),t.updateStatus("ready"),n}}});var Y=function(e){var i=t.items.length;return e>i-1?e-i:0>e?i+e:e},U=function(e,t,i){return e.replace(/%curr%/gi,t+1).replace(/%total%/gi,i)};e.magnificPopup.registerModule("gallery",{options:{enabled:!1,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:!0,arrows:!0,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var i=t.st.gallery,n=".mfp-gallery",r=Boolean(e.fn.mfpFastClick);return t.direction=!0,i&&i.enabled?(a+=" mfp-gallery",x(f+n,function(){i.navigateByImgClick&&t.wrap.on("click"+n,".mfp-img",function(){return t.items.length>1?(t.next(),!1):void 0}),o.on("keydown"+n,function(e){37===e.keyCode?t.prev():39===e.keyCode&&t.next()})}),x("UpdateStatus"+n,function(e,i){i.text&&(i.text=U(i.text,t.currItem.index,t.items.length))}),x(p+n,function(e,n,o,r){var a=t.items.length;o.counter=a>1?U(i.tCounter,r.index,a):""}),x("BuildControls"+n,function(){if(t.items.length>1&&i.arrows&&!t.arrowLeft){var n=i.arrowMarkup,o=t.arrowLeft=e(n.replace(/%title%/gi,i.tPrev).replace(/%dir%/gi,"left")).addClass(y),a=t.arrowRight=e(n.replace(/%title%/gi,i.tNext).replace(/%dir%/gi,"right")).addClass(y),s=r?"mfpFastClick":"click";o[s](function(){t.prev()}),a[s](function(){t.next()}),t.isIE7&&(k("b",o[0],!1,!0),k("a",o[0],!1,!0),k("b",a[0],!1,!0),k("a",a[0],!1,!0)),t.container.append(o.add(a))}}),x(m+n,function(){t._preloadTimeout&&clearTimeout(t._preloadTimeout),t._preloadTimeout=setTimeout(function(){t.preloadNearbyImages(),t._preloadTimeout=null},16)}),x(l+n,function(){o.off(n),t.wrap.off("click"+n),t.arrowLeft&&r&&t.arrowLeft.add(t.arrowRight).destroyMfpFastClick(),t.arrowRight=t.arrowLeft=null}),void 0):!1},next:function(){t.direction=!0,t.index=Y(t.index+1),t.updateItemHTML()},prev:function(){t.direction=!1,t.index=Y(t.index-1),t.updateItemHTML()},goTo:function(e){t.direction=e>=t.index,t.index=e,t.updateItemHTML()},preloadNearbyImages:function(){var e,i=t.st.gallery.preload,n=Math.min(i[0],t.items.length),o=Math.min(i[1],t.items.length);for(e=1;(t.direction?o:n)>=e;e++)t._preloadItem(t.index+e);for(e=1;(t.direction?n:o)>=e;e++)t._preloadItem(t.index-e)},_preloadItem:function(i){if(i=Y(i),!t.items[i].preloaded){var n=t.items[i];n.parsed||(n=t.parseEl(i)),T("LazyLoad",n),"image"===n.type&&(n.img=e('<img class="mfp-img" />').on("load.mfploader",function(){n.hasSize=!0}).on("error.mfploader",function(){n.hasSize=!0,n.loadError=!0,T("LazyLoadError",n)}).attr("src",n.src)),n.preloaded=!0}}}});var G="retina";e.magnificPopup.registerModule(G,{options:{replaceSrc:function(e){return e.src.replace(/\.\w+$/,function(e){return"@2x"+e})},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var e=t.st.retina,i=e.ratio;i=isNaN(i)?i():i,i>1&&(x("ImageHasSize."+G,function(e,t){t.img.css({"max-width":t.img[0].naturalWidth/i,width:"100%"})}),x("ElementParse."+G,function(t,n){n.src=e.replaceSrc(n,i)}))}}}}),function(){var t=1e3,i="ontouchstart"in window,n=function(){I.off("touchmove"+r+" touchend"+r)},o="mfpFastClick",r="."+o;e.fn.mfpFastClick=function(o){return e(this).each(function(){var a,s=e(this);if(i){var l,c,d,u,p,f;s.on("touchstart"+r,function(e){u=!1,f=1,p=e.originalEvent?e.originalEvent.touches[0]:e.touches[0],c=p.clientX,d=p.clientY,I.on("touchmove"+r,function(e){p=e.originalEvent?e.originalEvent.touches:e.touches,f=p.length,p=p[0],(Math.abs(p.clientX-c)>10||Math.abs(p.clientY-d)>10)&&(u=!0,n())}).on("touchend"+r,function(e){n(),u||f>1||(a=!0,e.preventDefault(),clearTimeout(l),l=setTimeout(function(){a=!1},t),o())})})}s.on("click"+r,function(){a||o()})})},e.fn.destroyMfpFastClick=function(){e(this).off("touchstart"+r+" click"+r),i&&I.off("touchmove"+r+" touchend"+r)}}()})(window.jQuery||window.Zepto);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/magnific-popup/dist/jquery.magnific-popup.min.js", e)}};

// Source: /js/libs/swiper/dist/idangerous.swiper.min.js
try{
/*
 * Swiper 2.6.0
 * Mobile touch slider and framework with hardware accelerated transitions
 *
 * http://www.idangero.us/sliders/swiper/
 *
 * Copyright 2010-2014, Vladimir Kharlampidi
 * The iDangero.us
 * http://www.idangero.us/
 *
 * Licensed under GPL & MIT
 *
 * Released on: April 9, 2014
*/
var Swiper=function(a,b){"use strict";function c(a,b){return document.querySelectorAll?(b||document).querySelectorAll(a):jQuery(a,b)}function d(a){return"[object Array]"===Object.prototype.toString.apply(a)?!0:!1}function e(){var a=F-I;return b.freeMode&&(a=F-I),b.slidesPerView>C.slides.length&&!b.centeredSlides&&(a=0),0>a&&(a=0),a}function f(){function a(a){var c=new Image;c.onload=function(){C&&void 0!==C.imagesLoaded&&C.imagesLoaded++,C.imagesLoaded===C.imagesToLoad.length&&(C.reInit(),b.onImagesReady&&C.fireCallback(b.onImagesReady,C))},c.src=a}var d=C.h.addEventListener,e="wrapper"===b.eventTarget?C.wrapper:C.container;if(C.browser.ie10||C.browser.ie11?(d(e,C.touchEvents.touchStart,p),d(document,C.touchEvents.touchMove,q),d(document,C.touchEvents.touchEnd,r)):(C.support.touch&&(d(e,"touchstart",p),d(e,"touchmove",q),d(e,"touchend",r)),b.simulateTouch&&(d(e,"mousedown",p),d(document,"mousemove",q),d(document,"mouseup",r))),b.autoResize&&d(window,"resize",C.resizeFix),g(),C._wheelEvent=!1,b.mousewheelControl){if(void 0!==document.onmousewheel&&(C._wheelEvent="mousewheel"),!C._wheelEvent)try{new WheelEvent("wheel"),C._wheelEvent="wheel"}catch(f){}C._wheelEvent||(C._wheelEvent="DOMMouseScroll"),C._wheelEvent&&d(C.container,C._wheelEvent,j)}if(b.keyboardControl&&d(document,"keydown",i),b.updateOnImagesReady){C.imagesToLoad=c("img",C.container);for(var h=0;h<C.imagesToLoad.length;h++)a(C.imagesToLoad[h].getAttribute("src"))}}function g(){var a,d=C.h.addEventListener;if(b.preventLinks){var e=c("a",C.container);for(a=0;a<e.length;a++)d(e[a],"click",n)}if(b.releaseFormElements){var f=c("input, textarea, select",C.container);for(a=0;a<f.length;a++)d(f[a],C.touchEvents.touchStart,o,!0)}if(b.onSlideClick)for(a=0;a<C.slides.length;a++)d(C.slides[a],"click",k);if(b.onSlideTouch)for(a=0;a<C.slides.length;a++)d(C.slides[a],C.touchEvents.touchStart,l)}function h(){var a,d=C.h.removeEventListener;if(b.onSlideClick)for(a=0;a<C.slides.length;a++)d(C.slides[a],"click",k);if(b.onSlideTouch)for(a=0;a<C.slides.length;a++)d(C.slides[a],C.touchEvents.touchStart,l);if(b.releaseFormElements){var e=c("input, textarea, select",C.container);for(a=0;a<e.length;a++)d(e[a],C.touchEvents.touchStart,o,!0)}if(b.preventLinks){var f=c("a",C.container);for(a=0;a<f.length;a++)d(f[a],"click",n)}}function i(a){var b=a.keyCode||a.charCode;if(!(a.shiftKey||a.altKey||a.ctrlKey||a.metaKey)){if(37===b||39===b||38===b||40===b){for(var c=!1,d=C.h.getOffset(C.container),e=C.h.windowScroll().left,f=C.h.windowScroll().top,g=C.h.windowWidth(),h=C.h.windowHeight(),i=[[d.left,d.top],[d.left+C.width,d.top],[d.left,d.top+C.height],[d.left+C.width,d.top+C.height]],j=0;j<i.length;j++){var k=i[j];k[0]>=e&&k[0]<=e+g&&k[1]>=f&&k[1]<=f+h&&(c=!0)}if(!c)return}M?((37===b||39===b)&&(a.preventDefault?a.preventDefault():a.returnValue=!1),39===b&&C.swipeNext(),37===b&&C.swipePrev()):((38===b||40===b)&&(a.preventDefault?a.preventDefault():a.returnValue=!1),40===b&&C.swipeNext(),38===b&&C.swipePrev())}}function j(a){var c=C._wheelEvent,d=0;if(a.detail)d=-a.detail;else if("mousewheel"===c)if(b.mousewheelControlForceToAxis)if(M){if(!(Math.abs(a.wheelDeltaX)>Math.abs(a.wheelDeltaY)))return;d=a.wheelDeltaX}else{if(!(Math.abs(a.wheelDeltaY)>Math.abs(a.wheelDeltaX)))return;d=a.wheelDeltaY}else d=a.wheelDelta;else if("DOMMouseScroll"===c)d=-a.detail;else if("wheel"===c)if(b.mousewheelControlForceToAxis)if(M){if(!(Math.abs(a.deltaX)>Math.abs(a.deltaY)))return;d=-a.deltaX}else{if(!(Math.abs(a.deltaY)>Math.abs(a.deltaX)))return;d=-a.deltaY}else d=Math.abs(a.deltaX)>Math.abs(a.deltaY)?-a.deltaX:-a.deltaY;if(b.freeMode){var f=C.getWrapperTranslate()+d;if(f>0&&(f=0),f<-e()&&(f=-e()),C.setWrapperTransition(0),C.setWrapperTranslate(f),C.updateActiveSlide(f),0===f||f===-e())return}else(new Date).getTime()-U>60&&(0>d?C.swipeNext():C.swipePrev()),U=(new Date).getTime();return b.autoplay&&C.stopAutoplay(!0),a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function k(a){C.allowSlideClick&&(m(a),C.fireCallback(b.onSlideClick,C,a))}function l(a){m(a),C.fireCallback(b.onSlideTouch,C,a)}function m(a){if(a.currentTarget)C.clickedSlide=a.currentTarget;else{var c=a.srcElement;do{if(c.className.indexOf(b.slideClass)>-1)break;c=c.parentNode}while(c);C.clickedSlide=c}C.clickedSlideIndex=C.slides.indexOf(C.clickedSlide),C.clickedSlideLoopIndex=C.clickedSlideIndex-(C.loopedSlides||0)}function n(a){return C.allowLinks?void 0:(a.preventDefault?a.preventDefault():a.returnValue=!1,b.preventLinksPropagation&&"stopPropagation"in a&&a.stopPropagation(),!1)}function o(a){return a.stopPropagation?a.stopPropagation():a.returnValue=!1,!1}function p(a){if(b.preventLinks&&(C.allowLinks=!0),C.isTouched||b.onlyExternal)return!1;if(b.noSwiping&&(a.target||a.srcElement)&&s(a.target||a.srcElement))return!1;if($=!1,C.isTouched=!0,Z="touchstart"===a.type,!Z||1===a.targetTouches.length){C.callPlugins("onTouchStartBegin"),Z||C.isAndroid||(a.preventDefault?a.preventDefault():a.returnValue=!1);var c=Z?a.targetTouches[0].pageX:a.pageX||a.clientX,d=Z?a.targetTouches[0].pageY:a.pageY||a.clientY;C.touches.startX=C.touches.currentX=c,C.touches.startY=C.touches.currentY=d,C.touches.start=C.touches.current=M?c:d,C.setWrapperTransition(0),C.positions.start=C.positions.current=C.getWrapperTranslate(),C.setWrapperTranslate(C.positions.start),C.times.start=(new Date).getTime(),H=void 0,b.moveStartThreshold>0&&(W=!1),b.onTouchStart&&C.fireCallback(b.onTouchStart,C,a),C.callPlugins("onTouchStartEnd")}}function q(a){if(C.isTouched&&!b.onlyExternal&&(!Z||"mousemove"!==a.type)){var c=Z?a.targetTouches[0].pageX:a.pageX||a.clientX,d=Z?a.targetTouches[0].pageY:a.pageY||a.clientY;if("undefined"==typeof H&&M&&(H=!!(H||Math.abs(d-C.touches.startY)>Math.abs(c-C.touches.startX))),"undefined"!=typeof H||M||(H=!!(H||Math.abs(d-C.touches.startY)<Math.abs(c-C.touches.startX))),H)return void(C.isTouched=!1);if(a.assignedToSwiper)return void(C.isTouched=!1);if(a.assignedToSwiper=!0,b.preventLinks&&(C.allowLinks=!1),b.onSlideClick&&(C.allowSlideClick=!1),b.autoplay&&C.stopAutoplay(!0),!Z||1===a.touches.length){if(C.isMoved||(C.callPlugins("onTouchMoveStart"),b.loop&&(C.fixLoop(),C.positions.start=C.getWrapperTranslate()),b.onTouchMoveStart&&C.fireCallback(b.onTouchMoveStart,C)),C.isMoved=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,C.touches.current=M?c:d,C.positions.current=(C.touches.current-C.touches.start)*b.touchRatio+C.positions.start,C.positions.current>0&&b.onResistanceBefore&&C.fireCallback(b.onResistanceBefore,C,C.positions.current),C.positions.current<-e()&&b.onResistanceAfter&&C.fireCallback(b.onResistanceAfter,C,Math.abs(C.positions.current+e())),b.resistance&&"100%"!==b.resistance){var f;if(C.positions.current>0&&(f=1-C.positions.current/I/2,C.positions.current=.5>f?I/2:C.positions.current*f),C.positions.current<-e()){var g=(C.touches.current-C.touches.start)*b.touchRatio+(e()+C.positions.start);f=(I+g)/I;var h=C.positions.current-g*(1-f)/2,i=-e()-I/2;C.positions.current=i>h||0>=f?i:h}}if(b.resistance&&"100%"===b.resistance&&(C.positions.current>0&&(!b.freeMode||b.freeModeFluid)&&(C.positions.current=0),C.positions.current<-e()&&(!b.freeMode||b.freeModeFluid)&&(C.positions.current=-e())),!b.followFinger)return;if(b.moveStartThreshold)if(Math.abs(C.touches.current-C.touches.start)>b.moveStartThreshold||W){if(!W)return W=!0,void(C.touches.start=C.touches.current);C.setWrapperTranslate(C.positions.current)}else C.positions.current=C.positions.start;else C.setWrapperTranslate(C.positions.current);return(b.freeMode||b.watchActiveIndex)&&C.updateActiveSlide(C.positions.current),b.grabCursor&&(C.container.style.cursor="move",C.container.style.cursor="grabbing",C.container.style.cursor="-moz-grabbin",C.container.style.cursor="-webkit-grabbing"),X||(X=C.touches.current),Y||(Y=(new Date).getTime()),C.velocity=(C.touches.current-X)/((new Date).getTime()-Y)/2,Math.abs(C.touches.current-X)<2&&(C.velocity=0),X=C.touches.current,Y=(new Date).getTime(),C.callPlugins("onTouchMoveEnd"),b.onTouchMove&&C.fireCallback(b.onTouchMove,C,a),!1}}}function r(a){if(H&&C.swipeReset(),!b.onlyExternal&&C.isTouched){C.isTouched=!1,b.grabCursor&&(C.container.style.cursor="move",C.container.style.cursor="grab",C.container.style.cursor="-moz-grab",C.container.style.cursor="-webkit-grab"),C.positions.current||0===C.positions.current||(C.positions.current=C.positions.start),b.followFinger&&C.setWrapperTranslate(C.positions.current),C.times.end=(new Date).getTime(),C.touches.diff=C.touches.current-C.touches.start,C.touches.abs=Math.abs(C.touches.diff),C.positions.diff=C.positions.current-C.positions.start,C.positions.abs=Math.abs(C.positions.diff);var c=C.positions.diff,d=C.positions.abs,f=C.times.end-C.times.start;5>d&&300>f&&C.allowLinks===!1&&(b.freeMode||0===d||C.swipeReset(),b.preventLinks&&(C.allowLinks=!0),b.onSlideClick&&(C.allowSlideClick=!0)),setTimeout(function(){b.preventLinks&&(C.allowLinks=!0),b.onSlideClick&&(C.allowSlideClick=!0)},100);var g=e();if(!C.isMoved&&b.freeMode)return C.isMoved=!1,b.onTouchEnd&&C.fireCallback(b.onTouchEnd,C,a),void C.callPlugins("onTouchEnd");if(!C.isMoved||C.positions.current>0||C.positions.current<-g)return C.swipeReset(),b.onTouchEnd&&C.fireCallback(b.onTouchEnd,C,a),void C.callPlugins("onTouchEnd");if(C.isMoved=!1,b.freeMode){if(b.freeModeFluid){var h,i=1e3*b.momentumRatio,j=C.velocity*i,k=C.positions.current+j,l=!1,m=20*Math.abs(C.velocity)*b.momentumBounceRatio;-g>k&&(b.momentumBounce&&C.support.transitions?(-m>k+g&&(k=-g-m),h=-g,l=!0,$=!0):k=-g),k>0&&(b.momentumBounce&&C.support.transitions?(k>m&&(k=m),h=0,l=!0,$=!0):k=0),0!==C.velocity&&(i=Math.abs((k-C.positions.current)/C.velocity)),C.setWrapperTranslate(k),C.setWrapperTransition(i),b.momentumBounce&&l&&C.wrapperTransitionEnd(function(){$&&(b.onMomentumBounce&&C.fireCallback(b.onMomentumBounce,C),C.callPlugins("onMomentumBounce"),C.setWrapperTranslate(h),C.setWrapperTransition(300))}),C.updateActiveSlide(k)}return(!b.freeModeFluid||f>=300)&&C.updateActiveSlide(C.positions.current),b.onTouchEnd&&C.fireCallback(b.onTouchEnd,C,a),void C.callPlugins("onTouchEnd")}G=0>c?"toNext":"toPrev","toNext"===G&&300>=f&&(30>d||!b.shortSwipes?C.swipeReset():C.swipeNext(!0)),"toPrev"===G&&300>=f&&(30>d||!b.shortSwipes?C.swipeReset():C.swipePrev(!0));var n=0;if("auto"===b.slidesPerView){for(var o,p=Math.abs(C.getWrapperTranslate()),q=0,r=0;r<C.slides.length;r++)if(o=M?C.slides[r].getWidth(!0,b.roundLengths):C.slides[r].getHeight(!0,b.roundLengths),q+=o,q>p){n=o;break}n>I&&(n=I)}else n=E*b.slidesPerView;"toNext"===G&&f>300&&(d>=n*b.longSwipesRatio?C.swipeNext(!0):C.swipeReset()),"toPrev"===G&&f>300&&(d>=n*b.longSwipesRatio?C.swipePrev(!0):C.swipeReset()),b.onTouchEnd&&C.fireCallback(b.onTouchEnd,C,a),C.callPlugins("onTouchEnd")}}function s(a){var c=!1;do a.className.indexOf(b.noSwipingClass)>-1&&(c=!0),a=a.parentElement;while(!c&&a.parentElement&&-1===a.className.indexOf(b.wrapperClass));return!c&&a.className.indexOf(b.wrapperClass)>-1&&a.className.indexOf(b.noSwipingClass)>-1&&(c=!0),c}function t(a,b){var c,d=document.createElement("div");return d.innerHTML=b,c=d.firstChild,c.className+=" "+a,c.outerHTML}function u(a,c,d){function e(){var f=+new Date,l=f-g;h+=i*l/(1e3/60),k="toNext"===j?h>a:a>h,k?(C.setWrapperTranslate(Math.round(h)),C._DOMAnimating=!0,window.setTimeout(function(){e()},1e3/60)):(b.onSlideChangeEnd&&("to"===c?d.runCallbacks===!0&&C.fireCallback(b.onSlideChangeEnd,C):C.fireCallback(b.onSlideChangeEnd,C)),C.setWrapperTranslate(a),C._DOMAnimating=!1)}var f="to"===c&&d.speed>=0?d.speed:b.speed,g=+new Date;if(C.support.transitions||!b.DOMAnimation)C.setWrapperTranslate(a),C.setWrapperTransition(f);else{var h=C.getWrapperTranslate(),i=Math.ceil((a-h)/f*(1e3/60)),j=h>a?"toNext":"toPrev",k="toNext"===j?h>a:a>h;if(C._DOMAnimating)return;e()}C.updateActiveSlide(a),b.onSlideNext&&"next"===c&&C.fireCallback(b.onSlideNext,C,a),b.onSlidePrev&&"prev"===c&&C.fireCallback(b.onSlidePrev,C,a),b.onSlideReset&&"reset"===c&&C.fireCallback(b.onSlideReset,C,a),("next"===c||"prev"===c||"to"===c&&d.runCallbacks===!0)&&v(c)}function v(a){if(C.callPlugins("onSlideChangeStart"),b.onSlideChangeStart)if(b.queueStartCallbacks&&C.support.transitions){if(C._queueStartCallbacks)return;C._queueStartCallbacks=!0,C.fireCallback(b.onSlideChangeStart,C,a),C.wrapperTransitionEnd(function(){C._queueStartCallbacks=!1})}else C.fireCallback(b.onSlideChangeStart,C,a);if(b.onSlideChangeEnd)if(C.support.transitions)if(b.queueEndCallbacks){if(C._queueEndCallbacks)return;C._queueEndCallbacks=!0,C.wrapperTransitionEnd(function(c){C.fireCallback(b.onSlideChangeEnd,c,a)})}else C.wrapperTransitionEnd(function(c){C.fireCallback(b.onSlideChangeEnd,c,a)});else b.DOMAnimation||setTimeout(function(){C.fireCallback(b.onSlideChangeEnd,C,a)},10)}function w(){var a=C.paginationButtons;if(a)for(var b=0;b<a.length;b++)C.h.removeEventListener(a[b],"click",y)}function x(){var a=C.paginationButtons;if(a)for(var b=0;b<a.length;b++)C.h.addEventListener(a[b],"click",y)}function y(a){for(var b,c=a.target||a.srcElement,d=C.paginationButtons,e=0;e<d.length;e++)c===d[e]&&(b=e);C.swipeTo(b)}function z(){_=setTimeout(function(){b.loop?(C.fixLoop(),C.swipeNext(!0)):C.swipeNext(!0)||(b.autoplayStopOnLast?(clearTimeout(_),_=void 0):C.swipeTo(0)),C.wrapperTransitionEnd(function(){"undefined"!=typeof _&&z()})},b.autoplay)}function A(){C.calcSlides(),b.loader.slides.length>0&&0===C.slides.length&&C.loadSlides(),b.loop&&C.createLoop(),C.init(),f(),b.pagination&&C.createPagination(!0),b.loop||b.initialSlide>0?C.swipeTo(b.initialSlide,0,!1):C.updateActiveSlide(0),b.autoplay&&C.startAutoplay(),C.centerIndex=C.activeIndex,b.onSwiperCreated&&C.fireCallback(b.onSwiperCreated,C),C.callPlugins("onSwiperCreated")}if(document.body.__defineGetter__&&HTMLElement){var B=HTMLElement.prototype;B.__defineGetter__&&B.__defineGetter__("outerHTML",function(){return(new XMLSerializer).serializeToString(this)})}if(window.getComputedStyle||(window.getComputedStyle=function(a){return this.el=a,this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"===b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),(document.querySelectorAll||window.jQuery)&&"undefined"!=typeof a&&(a.nodeType||0!==c(a).length)){var C=this;C.touches={start:0,startX:0,startY:0,current:0,currentX:0,currentY:0,diff:0,abs:0},C.positions={start:0,abs:0,diff:0,current:0},C.times={start:0,end:0},C.id=(new Date).getTime(),C.container=a.nodeType?a:c(a)[0],C.isTouched=!1,C.isMoved=!1,C.activeIndex=0,C.centerIndex=0,C.activeLoaderIndex=0,C.activeLoopIndex=0,C.previousIndex=null,C.velocity=0,C.snapGrid=[],C.slidesGrid=[],C.imagesToLoad=[],C.imagesLoaded=0,C.wrapperLeft=0,C.wrapperRight=0,C.wrapperTop=0,C.wrapperBottom=0,C.isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>=0;var D,E,F,G,H,I,J={eventTarget:"wrapper",mode:"horizontal",touchRatio:1,speed:300,freeMode:!1,freeModeFluid:!1,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,slidesPerView:1,slidesPerGroup:1,slidesPerViewFit:!0,simulateTouch:!0,followFinger:!0,shortSwipes:!0,longSwipesRatio:.5,moveStartThreshold:!1,onlyExternal:!1,createPagination:!0,pagination:!1,paginationElement:"span",paginationClickable:!1,paginationAsRange:!0,resistance:!0,scrollContainer:!1,preventLinks:!0,preventLinksPropagation:!1,noSwiping:!1,noSwipingClass:"swiper-no-swiping",initialSlide:0,keyboardControl:!1,mousewheelControl:!1,mousewheelControlForceToAxis:!1,useCSS3Transforms:!0,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,loop:!1,loopAdditionalSlides:0,roundLengths:!1,calculateHeight:!1,cssWidthAndHeight:!1,updateOnImagesReady:!0,releaseFormElements:!0,watchActiveIndex:!1,visibilityFullFit:!1,offsetPxBefore:0,offsetPxAfter:0,offsetSlidesBefore:0,offsetSlidesAfter:0,centeredSlides:!1,queueStartCallbacks:!1,queueEndCallbacks:!1,autoResize:!0,resizeReInit:!1,DOMAnimation:!0,loader:{slides:[],slidesHTMLType:"inner",surroundGroups:1,logic:"reload",loadAllSlides:!1},slideElement:"div",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",wrapperClass:"swiper-wrapper",paginationElementClass:"swiper-pagination-switch",paginationActiveClass:"swiper-active-switch",paginationVisibleClass:"swiper-visible-switch"};b=b||{};for(var K in J)if(K in b&&"object"==typeof b[K])for(var L in J[K])L in b[K]||(b[K][L]=J[K][L]);else K in b||(b[K]=J[K]);C.params=b,b.scrollContainer&&(b.freeMode=!0,b.freeModeFluid=!0),b.loop&&(b.resistance="100%");var M="horizontal"===b.mode,N=["mousedown","mousemove","mouseup"];C.browser.ie10&&(N=["MSPointerDown","MSPointerMove","MSPointerUp"]),C.browser.ie11&&(N=["pointerdown","pointermove","pointerup"]),C.touchEvents={touchStart:C.support.touch||!b.simulateTouch?"touchstart":N[0],touchMove:C.support.touch||!b.simulateTouch?"touchmove":N[1],touchEnd:C.support.touch||!b.simulateTouch?"touchend":N[2]};for(var O=C.container.childNodes.length-1;O>=0;O--)if(C.container.childNodes[O].className)for(var P=C.container.childNodes[O].className.split(/\s+/),Q=0;Q<P.length;Q++)P[Q]===b.wrapperClass&&(D=C.container.childNodes[O]);C.wrapper=D,C._extendSwiperSlide=function(a){return a.append=function(){return b.loop?a.insertAfter(C.slides.length-C.loopedSlides):(C.wrapper.appendChild(a),C.reInit()),a},a.prepend=function(){return b.loop?(C.wrapper.insertBefore(a,C.slides[C.loopedSlides]),C.removeLoopedSlides(),C.calcSlides(),C.createLoop()):C.wrapper.insertBefore(a,C.wrapper.firstChild),C.reInit(),a},a.insertAfter=function(c){if("undefined"==typeof c)return!1;var d;return b.loop?(d=C.slides[c+1+C.loopedSlides],d?C.wrapper.insertBefore(a,d):C.wrapper.appendChild(a),C.removeLoopedSlides(),C.calcSlides(),C.createLoop()):(d=C.slides[c+1],C.wrapper.insertBefore(a,d)),C.reInit(),a},a.clone=function(){return C._extendSwiperSlide(a.cloneNode(!0))},a.remove=function(){C.wrapper.removeChild(a),C.reInit()},a.html=function(b){return"undefined"==typeof b?a.innerHTML:(a.innerHTML=b,a)},a.index=function(){for(var b,c=C.slides.length-1;c>=0;c--)a===C.slides[c]&&(b=c);return b},a.isActive=function(){return a.index()===C.activeIndex?!0:!1},a.swiperSlideDataStorage||(a.swiperSlideDataStorage={}),a.getData=function(b){return a.swiperSlideDataStorage[b]},a.setData=function(b,c){return a.swiperSlideDataStorage[b]=c,a},a.data=function(b,c){return"undefined"==typeof c?a.getAttribute("data-"+b):(a.setAttribute("data-"+b,c),a)},a.getWidth=function(b,c){return C.h.getWidth(a,b,c)},a.getHeight=function(b,c){return C.h.getHeight(a,b,c)},a.getOffset=function(){return C.h.getOffset(a)},a},C.calcSlides=function(a){var c=C.slides?C.slides.length:!1;C.slides=[],C.displaySlides=[];for(var d=0;d<C.wrapper.childNodes.length;d++)if(C.wrapper.childNodes[d].className)for(var e=C.wrapper.childNodes[d].className,f=e.split(/\s+/),i=0;i<f.length;i++)f[i]===b.slideClass&&C.slides.push(C.wrapper.childNodes[d]);for(d=C.slides.length-1;d>=0;d--)C._extendSwiperSlide(C.slides[d]);c!==!1&&(c!==C.slides.length||a)&&(h(),g(),C.updateActiveSlide(),C.params.pagination&&C.createPagination(),C.callPlugins("numberOfSlidesChanged"))},C.createSlide=function(a,c,d){c=c||C.params.slideClass,d=d||b.slideElement;var e=document.createElement(d);return e.innerHTML=a||"",e.className=c,C._extendSwiperSlide(e)},C.appendSlide=function(a,b,c){return a?a.nodeType?C._extendSwiperSlide(a).append():C.createSlide(a,b,c).append():void 0},C.prependSlide=function(a,b,c){return a?a.nodeType?C._extendSwiperSlide(a).prepend():C.createSlide(a,b,c).prepend():void 0},C.insertSlideAfter=function(a,b,c,d){return"undefined"==typeof a?!1:b.nodeType?C._extendSwiperSlide(b).insertAfter(a):C.createSlide(b,c,d).insertAfter(a)},C.removeSlide=function(a){if(C.slides[a]){if(b.loop){if(!C.slides[a+C.loopedSlides])return!1;C.slides[a+C.loopedSlides].remove(),C.removeLoopedSlides(),C.calcSlides(),C.createLoop()}else C.slides[a].remove();return!0}return!1},C.removeLastSlide=function(){return C.slides.length>0?(b.loop?(C.slides[C.slides.length-1-C.loopedSlides].remove(),C.removeLoopedSlides(),C.calcSlides(),C.createLoop()):C.slides[C.slides.length-1].remove(),!0):!1},C.removeAllSlides=function(){for(var a=C.slides.length-1;a>=0;a--)C.slides[a].remove()},C.getSlide=function(a){return C.slides[a]},C.getLastSlide=function(){return C.slides[C.slides.length-1]},C.getFirstSlide=function(){return C.slides[0]},C.activeSlide=function(){return C.slides[C.activeIndex]},C.fireCallback=function(){var a=arguments[0];if("[object Array]"===Object.prototype.toString.call(a))for(var c=0;c<a.length;c++)"function"==typeof a[c]&&a[c](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);else"[object String]"===Object.prototype.toString.call(a)?b["on"+a]&&C.fireCallback(b["on"+a]):a(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},C.addCallback=function(a,b){var c,e=this;return e.params["on"+a]?d(this.params["on"+a])?this.params["on"+a].push(b):"function"==typeof this.params["on"+a]?(c=this.params["on"+a],this.params["on"+a]=[],this.params["on"+a].push(c),this.params["on"+a].push(b)):void 0:(this.params["on"+a]=[],this.params["on"+a].push(b))},C.removeCallbacks=function(a){C.params["on"+a]&&(C.params["on"+a]=null)};var R=[];for(var S in C.plugins)if(b[S]){var T=C.plugins[S](C,b[S]);T&&R.push(T)}C.callPlugins=function(a,b){b||(b={});for(var c=0;c<R.length;c++)a in R[c]&&R[c][a](b)},!C.browser.ie10&&!C.browser.ie11||b.onlyExternal||C.wrapper.classList.add("swiper-wp8-"+(M?"horizontal":"vertical")),b.freeMode&&(C.container.className+=" swiper-free-mode"),C.initialized=!1,C.init=function(a,c){var d=C.h.getWidth(C.container,!1,b.roundLengths),e=C.h.getHeight(C.container,!1,b.roundLengths);if(d!==C.width||e!==C.height||a){C.width=d,C.height=e;var f,g,h,i,j,k,l;I=M?d:e;var m=C.wrapper;if(a&&C.calcSlides(c),"auto"===b.slidesPerView){var n=0,o=0;b.slidesOffset>0&&(m.style.paddingLeft="",m.style.paddingRight="",m.style.paddingTop="",m.style.paddingBottom=""),m.style.width="",m.style.height="",b.offsetPxBefore>0&&(M?C.wrapperLeft=b.offsetPxBefore:C.wrapperTop=b.offsetPxBefore),b.offsetPxAfter>0&&(M?C.wrapperRight=b.offsetPxAfter:C.wrapperBottom=b.offsetPxAfter),b.centeredSlides&&(M?(C.wrapperLeft=(I-this.slides[0].getWidth(!0,b.roundLengths))/2,C.wrapperRight=(I-C.slides[C.slides.length-1].getWidth(!0,b.roundLengths))/2):(C.wrapperTop=(I-C.slides[0].getHeight(!0,b.roundLengths))/2,C.wrapperBottom=(I-C.slides[C.slides.length-1].getHeight(!0,b.roundLengths))/2)),M?(C.wrapperLeft>=0&&(m.style.paddingLeft=C.wrapperLeft+"px"),C.wrapperRight>=0&&(m.style.paddingRight=C.wrapperRight+"px")):(C.wrapperTop>=0&&(m.style.paddingTop=C.wrapperTop+"px"),C.wrapperBottom>=0&&(m.style.paddingBottom=C.wrapperBottom+"px")),k=0;var p=0;for(C.snapGrid=[],C.slidesGrid=[],h=0,l=0;l<C.slides.length;l++){f=C.slides[l].getWidth(!0,b.roundLengths),g=C.slides[l].getHeight(!0,b.roundLengths),b.calculateHeight&&(h=Math.max(h,g));var q=M?f:g;if(b.centeredSlides){var r=l===C.slides.length-1?0:C.slides[l+1].getWidth(!0,b.roundLengths),s=l===C.slides.length-1?0:C.slides[l+1].getHeight(!0,b.roundLengths),t=M?r:s;if(q>I){if(b.slidesPerViewFit)C.snapGrid.push(k+C.wrapperLeft),C.snapGrid.push(k+q-I+C.wrapperLeft);else for(var u=0;u<=Math.floor(q/(I+C.wrapperLeft));u++)C.snapGrid.push(0===u?k+C.wrapperLeft:k+C.wrapperLeft+I*u);C.slidesGrid.push(k+C.wrapperLeft)}else C.snapGrid.push(p),C.slidesGrid.push(p);p+=q/2+t/2}else{if(q>I)if(b.slidesPerViewFit)C.snapGrid.push(k),C.snapGrid.push(k+q-I);else if(0!==I)for(var v=0;v<=Math.floor(q/I);v++)C.snapGrid.push(k+I*v);else C.snapGrid.push(k);else C.snapGrid.push(k);C.slidesGrid.push(k)}k+=q,n+=f,o+=g}b.calculateHeight&&(C.height=h),M?(F=n+C.wrapperRight+C.wrapperLeft,m.style.width=n+"px",m.style.height=C.height+"px"):(F=o+C.wrapperTop+C.wrapperBottom,m.style.width=C.width+"px",m.style.height=o+"px")}else if(b.scrollContainer)m.style.width="",m.style.height="",i=C.slides[0].getWidth(!0,b.roundLengths),j=C.slides[0].getHeight(!0,b.roundLengths),F=M?i:j,m.style.width=i+"px",m.style.height=j+"px",E=M?i:j;else{if(b.calculateHeight){for(h=0,j=0,M||(C.container.style.height=""),m.style.height="",l=0;l<C.slides.length;l++)C.slides[l].style.height="",h=Math.max(C.slides[l].getHeight(!0),h),M||(j+=C.slides[l].getHeight(!0));g=h,C.height=g,M?j=g:(I=g,C.container.style.height=I+"px")}else g=M?C.height:C.height/b.slidesPerView,b.roundLengths&&(g=Math.round(g)),j=M?C.height:C.slides.length*g;for(f=M?C.width/b.slidesPerView:C.width,b.roundLengths&&(f=Math.round(f)),i=M?C.slides.length*f:C.width,E=M?f:g,b.offsetSlidesBefore>0&&(M?C.wrapperLeft=E*b.offsetSlidesBefore:C.wrapperTop=E*b.offsetSlidesBefore),b.offsetSlidesAfter>0&&(M?C.wrapperRight=E*b.offsetSlidesAfter:C.wrapperBottom=E*b.offsetSlidesAfter),b.offsetPxBefore>0&&(M?C.wrapperLeft=b.offsetPxBefore:C.wrapperTop=b.offsetPxBefore),b.offsetPxAfter>0&&(M?C.wrapperRight=b.offsetPxAfter:C.wrapperBottom=b.offsetPxAfter),b.centeredSlides&&(M?(C.wrapperLeft=(I-E)/2,C.wrapperRight=(I-E)/2):(C.wrapperTop=(I-E)/2,C.wrapperBottom=(I-E)/2)),M?(C.wrapperLeft>0&&(m.style.paddingLeft=C.wrapperLeft+"px"),C.wrapperRight>0&&(m.style.paddingRight=C.wrapperRight+"px")):(C.wrapperTop>0&&(m.style.paddingTop=C.wrapperTop+"px"),C.wrapperBottom>0&&(m.style.paddingBottom=C.wrapperBottom+"px")),F=M?i+C.wrapperRight+C.wrapperLeft:j+C.wrapperTop+C.wrapperBottom,b.cssWidthAndHeight||(parseFloat(i)>0&&(m.style.width=i+"px"),parseFloat(j)>0&&(m.style.height=j+"px")),k=0,C.snapGrid=[],C.slidesGrid=[],l=0;l<C.slides.length;l++)C.snapGrid.push(k),C.slidesGrid.push(k),k+=E,b.cssWidthAndHeight||(parseFloat(f)>0&&(C.slides[l].style.width=f+"px"),parseFloat(g)>0&&(C.slides[l].style.height=g+"px"))}C.initialized?(C.callPlugins("onInit"),b.onInit&&C.fireCallback(b.onInit,C)):(C.callPlugins("onFirstInit"),b.onFirstInit&&C.fireCallback(b.onFirstInit,C)),C.initialized=!0}},C.reInit=function(a){C.init(!0,a)},C.resizeFix=function(a){C.callPlugins("beforeResizeFix"),C.init(b.resizeReInit||a),b.freeMode?C.getWrapperTranslate()<-e()&&(C.setWrapperTransition(0),C.setWrapperTranslate(-e())):(C.swipeTo(b.loop?C.activeLoopIndex:C.activeIndex,0,!1),b.autoplay&&(C.support.transitions&&"undefined"!=typeof _?"undefined"!=typeof _&&(clearTimeout(_),_=void 0,C.startAutoplay()):"undefined"!=typeof ab&&(clearInterval(ab),ab=void 0,C.startAutoplay()))),C.callPlugins("afterResizeFix")},C.destroy=function(){var a=C.h.removeEventListener,c="wrapper"===b.eventTarget?C.wrapper:C.container;C.browser.ie10||C.browser.ie11?(a(c,C.touchEvents.touchStart,p),a(document,C.touchEvents.touchMove,q),a(document,C.touchEvents.touchEnd,r)):(C.support.touch&&(a(c,"touchstart",p),a(c,"touchmove",q),a(c,"touchend",r)),b.simulateTouch&&(a(c,"mousedown",p),a(document,"mousemove",q),a(document,"mouseup",r))),b.autoResize&&a(window,"resize",C.resizeFix),h(),b.paginationClickable&&w(),b.mousewheelControl&&C._wheelEvent&&a(C.container,C._wheelEvent,j),b.keyboardControl&&a(document,"keydown",i),b.autoplay&&C.stopAutoplay(),C.callPlugins("onDestroy"),C=null},C.disableKeyboardControl=function(){b.keyboardControl=!1,C.h.removeEventListener(document,"keydown",i)},C.enableKeyboardControl=function(){b.keyboardControl=!0,C.h.addEventListener(document,"keydown",i)};var U=(new Date).getTime();if(C.disableMousewheelControl=function(){return C._wheelEvent?(b.mousewheelControl=!1,C.h.removeEventListener(C.container,C._wheelEvent,j),!0):!1},C.enableMousewheelControl=function(){return C._wheelEvent?(b.mousewheelControl=!0,C.h.addEventListener(C.container,C._wheelEvent,j),!0):!1},b.grabCursor){var V=C.container.style;V.cursor="move",V.cursor="grab",V.cursor="-moz-grab",V.cursor="-webkit-grab"}C.allowSlideClick=!0,C.allowLinks=!0;var W,X,Y,Z=!1,$=!0;C.swipeNext=function(a){!a&&b.loop&&C.fixLoop(),!a&&b.autoplay&&C.stopAutoplay(!0),C.callPlugins("onSwipeNext");var c=C.getWrapperTranslate(),d=c;if("auto"===b.slidesPerView){for(var f=0;f<C.snapGrid.length;f++)if(-c>=C.snapGrid[f]&&-c<C.snapGrid[f+1]){d=-C.snapGrid[f+1];break}}else{var g=E*b.slidesPerGroup;d=-(Math.floor(Math.abs(c)/Math.floor(g))*g+g)}return d<-e()&&(d=-e()),d===c?!1:(u(d,"next"),!0)},C.swipePrev=function(a){!a&&b.loop&&C.fixLoop(),!a&&b.autoplay&&C.stopAutoplay(!0),C.callPlugins("onSwipePrev");var c,d=Math.ceil(C.getWrapperTranslate());if("auto"===b.slidesPerView){c=0;for(var e=1;e<C.snapGrid.length;e++){if(-d===C.snapGrid[e]){c=-C.snapGrid[e-1];break}if(-d>C.snapGrid[e]&&-d<C.snapGrid[e+1]){c=-C.snapGrid[e];break}}}else{var f=E*b.slidesPerGroup;c=-(Math.ceil(-d/f)-1)*f}return c>0&&(c=0),c===d?!1:(u(c,"prev"),!0)},C.swipeReset=function(){C.callPlugins("onSwipeReset");{var a,c=C.getWrapperTranslate(),d=E*b.slidesPerGroup;-e()}if("auto"===b.slidesPerView){a=0;for(var f=0;f<C.snapGrid.length;f++){if(-c===C.snapGrid[f])return;if(-c>=C.snapGrid[f]&&-c<C.snapGrid[f+1]){a=C.positions.diff>0?-C.snapGrid[f+1]:-C.snapGrid[f];break}}-c>=C.snapGrid[C.snapGrid.length-1]&&(a=-C.snapGrid[C.snapGrid.length-1]),c<=-e()&&(a=-e())}else a=0>c?Math.round(c/d)*d:0;return b.scrollContainer&&(a=0>c?c:0),a<-e()&&(a=-e()),b.scrollContainer&&I>E&&(a=0),a===c?!1:(u(a,"reset"),!0)},C.swipeTo=function(a,c,d){a=parseInt(a,10),C.callPlugins("onSwipeTo",{index:a,speed:c}),b.loop&&(a+=C.loopedSlides);var f=C.getWrapperTranslate();if(!(a>C.slides.length-1||0>a)){var g;return g="auto"===b.slidesPerView?-C.slidesGrid[a]:-a*E,g<-e()&&(g=-e()),g===f?!1:(d=d===!1?!1:!0,u(g,"to",{index:a,speed:c,runCallbacks:d}),!0)}},C._queueStartCallbacks=!1,C._queueEndCallbacks=!1,C.updateActiveSlide=function(a){if(C.initialized&&0!==C.slides.length){C.previousIndex=C.activeIndex,"undefined"==typeof a&&(a=C.getWrapperTranslate()),a>0&&(a=0);var c;if("auto"===b.slidesPerView){if(C.activeIndex=C.slidesGrid.indexOf(-a),C.activeIndex<0){for(c=0;c<C.slidesGrid.length-1&&!(-a>C.slidesGrid[c]&&-a<C.slidesGrid[c+1]);c++);var d=Math.abs(C.slidesGrid[c]+a),e=Math.abs(C.slidesGrid[c+1]+a);C.activeIndex=e>=d?c:c+1}}else C.activeIndex=Math[b.visibilityFullFit?"ceil":"round"](-a/E);if(C.activeIndex===C.slides.length&&(C.activeIndex=C.slides.length-1),C.activeIndex<0&&(C.activeIndex=0),C.slides[C.activeIndex]){if(C.calcVisibleSlides(a),C.support.classList){var f;for(c=0;c<C.slides.length;c++)f=C.slides[c],f.classList.remove(b.slideActiveClass),C.visibleSlides.indexOf(f)>=0?f.classList.add(b.slideVisibleClass):f.classList.remove(b.slideVisibleClass);C.slides[C.activeIndex].classList.add(b.slideActiveClass)}else{var g=new RegExp("\\s*"+b.slideActiveClass),h=new RegExp("\\s*"+b.slideVisibleClass);for(c=0;c<C.slides.length;c++)C.slides[c].className=C.slides[c].className.replace(g,"").replace(h,""),C.visibleSlides.indexOf(C.slides[c])>=0&&(C.slides[c].className+=" "+b.slideVisibleClass);C.slides[C.activeIndex].className+=" "+b.slideActiveClass}if(b.loop){var i=C.loopedSlides;C.activeLoopIndex=C.activeIndex-i,C.activeLoopIndex>=C.slides.length-2*i&&(C.activeLoopIndex=C.slides.length-2*i-C.activeLoopIndex),C.activeLoopIndex<0&&(C.activeLoopIndex=C.slides.length-2*i+C.activeLoopIndex),C.activeLoopIndex<0&&(C.activeLoopIndex=0)}else C.activeLoopIndex=C.activeIndex;b.pagination&&C.updatePagination(a)}}},C.createPagination=function(a){if(b.paginationClickable&&C.paginationButtons&&w(),C.paginationContainer=b.pagination.nodeType?b.pagination:c(b.pagination)[0],b.createPagination){var d="",e=C.slides.length,f=e;b.loop&&(f-=2*C.loopedSlides);for(var g=0;f>g;g++)d+="<"+b.paginationElement+' class="'+b.paginationElementClass+'"></'+b.paginationElement+">";C.paginationContainer.innerHTML=d}C.paginationButtons=c("."+b.paginationElementClass,C.paginationContainer),a||C.updatePagination(),C.callPlugins("onCreatePagination"),b.paginationClickable&&x()},C.updatePagination=function(a){if(b.pagination&&!(C.slides.length<1)){var d=c("."+b.paginationActiveClass,C.paginationContainer);
if(d){var e=C.paginationButtons;if(0!==e.length){for(var f=0;f<e.length;f++)e[f].className=b.paginationElementClass;var g=b.loop?C.loopedSlides:0;if(b.paginationAsRange){C.visibleSlides||C.calcVisibleSlides(a);var h,i=[];for(h=0;h<C.visibleSlides.length;h++){var j=C.slides.indexOf(C.visibleSlides[h])-g;b.loop&&0>j&&(j=C.slides.length-2*C.loopedSlides+j),b.loop&&j>=C.slides.length-2*C.loopedSlides&&(j=C.slides.length-2*C.loopedSlides-j,j=Math.abs(j)),i.push(j)}for(h=0;h<i.length;h++)e[i[h]]&&(e[i[h]].className+=" "+b.paginationVisibleClass);b.loop?void 0!==e[C.activeLoopIndex]&&(e[C.activeLoopIndex].className+=" "+b.paginationActiveClass):e[C.activeIndex].className+=" "+b.paginationActiveClass}else b.loop?e[C.activeLoopIndex]&&(e[C.activeLoopIndex].className+=" "+b.paginationActiveClass+" "+b.paginationVisibleClass):e[C.activeIndex].className+=" "+b.paginationActiveClass+" "+b.paginationVisibleClass}}}},C.calcVisibleSlides=function(a){var c=[],d=0,e=0,f=0;M&&C.wrapperLeft>0&&(a+=C.wrapperLeft),!M&&C.wrapperTop>0&&(a+=C.wrapperTop);for(var g=0;g<C.slides.length;g++){d+=e,e="auto"===b.slidesPerView?M?C.h.getWidth(C.slides[g],!0,b.roundLengths):C.h.getHeight(C.slides[g],!0,b.roundLengths):E,f=d+e;var h=!1;b.visibilityFullFit?(d>=-a&&-a+I>=f&&(h=!0),-a>=d&&f>=-a+I&&(h=!0)):(f>-a&&-a+I>=f&&(h=!0),d>=-a&&-a+I>d&&(h=!0),-a>d&&f>-a+I&&(h=!0)),h&&c.push(C.slides[g])}0===c.length&&(c=[C.slides[C.activeIndex]]),C.visibleSlides=c};var _,ab;C.startAutoplay=function(){if(C.support.transitions){if("undefined"!=typeof _)return!1;if(!b.autoplay)return;C.callPlugins("onAutoplayStart"),b.onAutoplayStart&&C.fireCallback(b.onAutoplayStart,C),z()}else{if("undefined"!=typeof ab)return!1;if(!b.autoplay)return;C.callPlugins("onAutoplayStart"),b.onAutoplayStart&&C.fireCallback(b.onAutoplayStart,C),ab=setInterval(function(){b.loop?(C.fixLoop(),C.swipeNext(!0)):C.swipeNext(!0)||(b.autoplayStopOnLast?(clearInterval(ab),ab=void 0):C.swipeTo(0))},b.autoplay)}},C.stopAutoplay=function(a){if(C.support.transitions){if(!_)return;_&&clearTimeout(_),_=void 0,a&&!b.autoplayDisableOnInteraction&&C.wrapperTransitionEnd(function(){z()}),C.callPlugins("onAutoplayStop"),b.onAutoplayStop&&C.fireCallback(b.onAutoplayStop,C)}else ab&&clearInterval(ab),ab=void 0,C.callPlugins("onAutoplayStop"),b.onAutoplayStop&&C.fireCallback(b.onAutoplayStop,C)},C.loopCreated=!1,C.removeLoopedSlides=function(){if(C.loopCreated)for(var a=0;a<C.slides.length;a++)C.slides[a].getData("looped")===!0&&C.wrapper.removeChild(C.slides[a])},C.createLoop=function(){if(0!==C.slides.length){C.loopedSlides="auto"===b.slidesPerView?b.loopedSlides||1:b.slidesPerView+b.loopAdditionalSlides,C.loopedSlides>C.slides.length&&(C.loopedSlides=C.slides.length);var a,c="",d="",e="",f=C.slides.length,g=Math.floor(C.loopedSlides/f),h=C.loopedSlides%f;for(a=0;g*f>a;a++){var i=a;if(a>=f){var j=Math.floor(a/f);i=a-f*j}e+=C.slides[i].outerHTML}for(a=0;h>a;a++)d+=t(b.slideDuplicateClass,C.slides[a].outerHTML);for(a=f-h;f>a;a++)c+=t(b.slideDuplicateClass,C.slides[a].outerHTML);var k=c+e+D.innerHTML+e+d;for(D.innerHTML=k,C.loopCreated=!0,C.calcSlides(),a=0;a<C.slides.length;a++)(a<C.loopedSlides||a>=C.slides.length-C.loopedSlides)&&C.slides[a].setData("looped",!0);C.callPlugins("onCreateLoop")}},C.fixLoop=function(){var a;C.activeIndex<C.loopedSlides?(a=C.slides.length-3*C.loopedSlides+C.activeIndex,C.swipeTo(a,0,!1)):("auto"===b.slidesPerView&&C.activeIndex>=2*C.loopedSlides||C.activeIndex>C.slides.length-2*b.slidesPerView)&&(a=-C.slides.length+C.activeIndex+C.loopedSlides,C.swipeTo(a,0,!1))},C.loadSlides=function(){var a="";C.activeLoaderIndex=0;for(var c=b.loader.slides,d=b.loader.loadAllSlides?c.length:b.slidesPerView*(1+b.loader.surroundGroups),e=0;d>e;e++)a+="outer"===b.loader.slidesHTMLType?c[e]:"<"+b.slideElement+' class="'+b.slideClass+'" data-swiperindex="'+e+'">'+c[e]+"</"+b.slideElement+">";C.wrapper.innerHTML=a,C.calcSlides(!0),b.loader.loadAllSlides||C.wrapperTransitionEnd(C.reloadSlides,!0)},C.reloadSlides=function(){var a=b.loader.slides,c=parseInt(C.activeSlide().data("swiperindex"),10);if(!(0>c||c>a.length-1)){C.activeLoaderIndex=c;var d=Math.max(0,c-b.slidesPerView*b.loader.surroundGroups),e=Math.min(c+b.slidesPerView*(1+b.loader.surroundGroups)-1,a.length-1);if(c>0){var f=-E*(c-d);C.setWrapperTranslate(f),C.setWrapperTransition(0)}var g;if("reload"===b.loader.logic){C.wrapper.innerHTML="";var h="";for(g=d;e>=g;g++)h+="outer"===b.loader.slidesHTMLType?a[g]:"<"+b.slideElement+' class="'+b.slideClass+'" data-swiperindex="'+g+'">'+a[g]+"</"+b.slideElement+">";C.wrapper.innerHTML=h}else{var i=1e3,j=0;for(g=0;g<C.slides.length;g++){var k=C.slides[g].data("swiperindex");d>k||k>e?C.wrapper.removeChild(C.slides[g]):(i=Math.min(k,i),j=Math.max(k,j))}for(g=d;e>=g;g++){var l;i>g&&(l=document.createElement(b.slideElement),l.className=b.slideClass,l.setAttribute("data-swiperindex",g),l.innerHTML=a[g],C.wrapper.insertBefore(l,C.wrapper.firstChild)),g>j&&(l=document.createElement(b.slideElement),l.className=b.slideClass,l.setAttribute("data-swiperindex",g),l.innerHTML=a[g],C.wrapper.appendChild(l))}}C.reInit(!0)}},A()}};Swiper.prototype={plugins:{},wrapperTransitionEnd:function(a,b){"use strict";function c(){if(a(e),e.params.queueEndCallbacks&&(e._queueEndCallbacks=!1),!b)for(d=0;d<g.length;d++)e.h.removeEventListener(f,g[d],c)}var d,e=this,f=e.wrapper,g=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];if(a)for(d=0;d<g.length;d++)e.h.addEventListener(f,g[d],c)},getWrapperTranslate:function(a){"use strict";var b,c,d,e,f=this.wrapper;return"undefined"==typeof a&&(a="horizontal"===this.params.mode?"x":"y"),this.support.transforms&&this.params.useCSS3Transforms?(d=window.getComputedStyle(f,null),window.WebKitCSSMatrix?e=new WebKitCSSMatrix("none"===d.webkitTransform?"":d.webkitTransform):(e=d.MozTransform||d.OTransform||d.MsTransform||d.msTransform||d.transform||d.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),b=e.toString().split(",")),"x"===a&&(c=window.WebKitCSSMatrix?e.m41:parseFloat(16===b.length?b[12]:b[4])),"y"===a&&(c=window.WebKitCSSMatrix?e.m42:parseFloat(16===b.length?b[13]:b[5]))):("x"===a&&(c=parseFloat(f.style.left,10)||0),"y"===a&&(c=parseFloat(f.style.top,10)||0)),c||0},setWrapperTranslate:function(a,b,c){"use strict";var d,e=this.wrapper.style,f={x:0,y:0,z:0};3===arguments.length?(f.x=a,f.y=b,f.z=c):("undefined"==typeof b&&(b="horizontal"===this.params.mode?"x":"y"),f[b]=a),this.support.transforms&&this.params.useCSS3Transforms?(d=this.support.transforms3d?"translate3d("+f.x+"px, "+f.y+"px, "+f.z+"px)":"translate("+f.x+"px, "+f.y+"px)",e.webkitTransform=e.MsTransform=e.msTransform=e.MozTransform=e.OTransform=e.transform=d):(e.left=f.x+"px",e.top=f.y+"px"),this.callPlugins("onSetWrapperTransform",f),this.params.onSetWrapperTransform&&this.fireCallback(this.params.onSetWrapperTransform,this,f)},setWrapperTransition:function(a){"use strict";var b=this.wrapper.style;b.webkitTransitionDuration=b.MsTransitionDuration=b.msTransitionDuration=b.MozTransitionDuration=b.OTransitionDuration=b.transitionDuration=a/1e3+"s",this.callPlugins("onSetWrapperTransition",{duration:a}),this.params.onSetWrapperTransition&&this.fireCallback(this.params.onSetWrapperTransition,this,a)},h:{getWidth:function(a,b,c){"use strict";var d=window.getComputedStyle(a,null).getPropertyValue("width"),e=parseFloat(d);return(isNaN(e)||d.indexOf("%")>0)&&(e=a.offsetWidth-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-left"))-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-right"))),b&&(e+=parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-left"))+parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-right"))),c?Math.round(e):e},getHeight:function(a,b,c){"use strict";if(b)return a.offsetHeight;var d=window.getComputedStyle(a,null).getPropertyValue("height"),e=parseFloat(d);return(isNaN(e)||d.indexOf("%")>0)&&(e=a.offsetHeight-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-top"))-parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-bottom"))),b&&(e+=parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-top"))+parseFloat(window.getComputedStyle(a,null).getPropertyValue("padding-bottom"))),c?Math.round(e):e},getOffset:function(a){"use strict";var b=a.getBoundingClientRect(),c=document.body,d=a.clientTop||c.clientTop||0,e=a.clientLeft||c.clientLeft||0,f=window.pageYOffset||a.scrollTop,g=window.pageXOffset||a.scrollLeft;return document.documentElement&&!window.pageYOffset&&(f=document.documentElement.scrollTop,g=document.documentElement.scrollLeft),{top:b.top+f-d,left:b.left+g-e}},windowWidth:function(){"use strict";return window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:void 0},windowHeight:function(){"use strict";return window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:void 0},windowScroll:function(){"use strict";return"undefined"!=typeof pageYOffset?{left:window.pageXOffset,top:window.pageYOffset}:document.documentElement?{left:document.documentElement.scrollLeft,top:document.documentElement.scrollTop}:void 0},addEventListener:function(a,b,c,d){"use strict";"undefined"==typeof d&&(d=!1),a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},removeEventListener:function(a,b,c,d){"use strict";"undefined"==typeof d&&(d=!1),a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)}},setTransform:function(a,b){"use strict";var c=a.style;c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=b},setTranslate:function(a,b){"use strict";var c=a.style,d={x:b.x||0,y:b.y||0,z:b.z||0},e=this.support.transforms3d?"translate3d("+d.x+"px,"+d.y+"px,"+d.z+"px)":"translate("+d.x+"px,"+d.y+"px)";c.webkitTransform=c.MsTransform=c.msTransform=c.MozTransform=c.OTransform=c.transform=e,this.support.transforms||(c.left=d.x+"px",c.top=d.y+"px")},setTransition:function(a,b){"use strict";var c=a.style;c.webkitTransitionDuration=c.MsTransitionDuration=c.msTransitionDuration=c.MozTransitionDuration=c.OTransitionDuration=c.transitionDuration=b+"ms"},support:{touch:window.Modernizr&&Modernizr.touch===!0||function(){"use strict";return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){"use strict";var a=document.createElement("div").style;return"webkitPerspective"in a||"MozPerspective"in a||"OPerspective"in a||"MsPerspective"in a||"perspective"in a}(),transforms:window.Modernizr&&Modernizr.csstransforms===!0||function(){"use strict";var a=document.createElement("div").style;return"transform"in a||"WebkitTransform"in a||"MozTransform"in a||"msTransform"in a||"MsTransform"in a||"OTransform"in a}(),transitions:window.Modernizr&&Modernizr.csstransitions===!0||function(){"use strict";var a=document.createElement("div").style;return"transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"MsTransition"in a||"OTransition"in a}(),classList:function(){"use strict";var a=document.createElement("div").style;return"classList"in a}()},browser:{ie8:function(){"use strict";var a=-1;if("Microsoft Internet Explorer"===navigator.appName){var b=navigator.userAgent,c=new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/);null!==c.exec(b)&&(a=parseFloat(RegExp.$1))}return-1!==a&&9>a}(),ie10:window.navigator.msPointerEnabled,ie11:window.navigator.pointerEnabled}},(window.jQuery||window.Zepto)&&!function(a){"use strict";a.fn.swiper=function(b){var c=new Swiper(a(this)[0],b);return a(this).data("swiper",c),c}}(window.jQuery||window.Zepto),"undefined"!=typeof module&&(module.exports=Swiper),"function"==typeof define&&define.amd&&define([],function(){"use strict";return Swiper});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/swiper/dist/idangerous.swiper.min.js", e)}};

// Source: /js/libs/jquery.serializeObject.js
try{
/*
 * jQuery serializeObject - v0.2 - 1/20/2010
 * http://benalman.com/projects/jquery-misc-plugins/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,a){$.fn.serializeObject=function(){var b={};$.each(this.serializeArray(),function(d,e){var f=e.name,c=e.value;b[f]=b[f]===a?c:$.isArray(b[f])?b[f].concat(c):[b[f],c]});return b}})(jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/jquery.serializeObject.js", e)}};

// Source: /js/libs/jquery.debouncedresize.min.js
try{
(function($){var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize";$event.dispatch.apply(context,args)};if(resizeTimeout){clearTimeout(resizeTimeout)}execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold)},threshold:150}})(jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/jquery.debouncedresize.min.js", e)}};

// Source: /js/libs/jquery.deparam.min.js
try{
//from: https://github.com/AceMetrix/jquery-deparam
!function(deparam){if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){var jquery=require("jquery");module.exports=deparam(jquery)}else if(typeof define==="function"&&define.amd){define(["jquery"],function(jquery){return deparam(jquery)})}else{var global=(false||eval)("this");global.deparam=deparam(jQuery)}}(function($){return function(params,coerce){var obj={},coerce_types={"true":!0,"false":!1,"null":null};$.each(params.replace(/\+/g," ").split("&"),function(j,v){var param=v.split("="),key=decodeURIComponent(param[0]),val,cur=obj,i=0,keys=key.split("]["),keys_last=keys.length-1;if(/\[/.test(keys[0])&&/\]$/.test(keys[keys_last])){keys[keys_last]=keys[keys_last].replace(/\]$/,"");keys=keys.shift().split("[").concat(keys);keys_last=keys.length-1}else{keys_last=0}if(param.length===2){val=decodeURIComponent(param[1]);if(coerce){val=val&&!isNaN(val)?+val:val==="undefined"?undefined:coerce_types[val]!==undefined?coerce_types[val]:val}if(keys_last){for(;i<=keys_last;i++){key=keys[i]===""?cur.length:keys[i];cur=cur[key]=i<keys_last?cur[key]||(keys[i+1]&&isNaN(keys[i+1])?{}:[]):val}}else{if($.isArray(obj[key])){obj[key].push(val)}else if(obj[key]!==undefined){obj[key]=[obj[key],val]}else{obj[key]=val}}}else if(key){obj[key]=coerce?undefined:""}});return obj}});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/jquery.deparam.min.js", e)}};

// Source: /js/libs/jquery.mCustomScrollbar.js
try{
/*
== malihu jquery custom scrollbars plugin == 
version: 2.8.3 
author: malihu (http://manos.malihu.gr) 
plugin home: http://manos.malihu.gr/jquery-custom-content-scroller 
*/

/*
Copyright 2010-2013 Manos Malihutsakis 

This program is free software: you can redistribute it and/or modify 
it under the terms of the GNU Lesser General Public License as published by 
the Free Software Foundation, either version 3 of the License, or 
any later version. 

This program is distributed in the hope that it will be useful, 
but WITHOUT ANY WARRANTY; without even the implied warranty of 
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
GNU Lesser General Public License for more details. 

You should have received a copy of the GNU Lesser General Public License 
along with this program.  If not, see http://www.gnu.org/licenses/lgpl.html. 
*/
(function($){
	/*plugin script*/
	var methods={
		init:function(options){
			var defaults={ 
				set_width:false, /*optional element width: boolean, pixels, percentage*/
				set_height:false, /*optional element height: boolean, pixels, percentage*/
				horizontalScroll:false, /*scroll horizontally: boolean*/
				scrollInertia:950, /*scrolling inertia: integer (milliseconds)*/
				mouseWheel:true, /*mousewheel support: boolean*/
				mouseWheelPixels:"auto", /*mousewheel pixels amount: integer, "auto"*/
				autoDraggerLength:true, /*auto-adjust scrollbar dragger length: boolean*/
				autoHideScrollbar:false, /*auto-hide scrollbar when idle*/
				alwaysShowScrollbar:false, /*always show scrollbar even when there's nothing to scroll (disables autoHideScrollbar): boolean*/
				snapAmount:null, /* optional element always snaps to a multiple of this number in pixels */
				snapOffset:0, /* when snapping, snap with this number in pixels as an offset */
				scrollButtons:{ /*scroll buttons*/
					enable:false, /*scroll buttons support: boolean*/
					scrollType:"continuous", /*scroll buttons scrolling type: "continuous", "pixels"*/
					scrollSpeed:"auto", /*scroll buttons continuous scrolling speed: integer, "auto"*/
					scrollAmount:40 /*scroll buttons pixels scroll amount: integer (pixels)*/
				},
				advanced:{
					updateOnBrowserResize:true, /*update scrollbars on browser resize (for layouts based on percentages): boolean*/
					updateOnContentResize:false, /*auto-update scrollbars on content resize (for dynamic content): boolean*/
					autoExpandHorizontalScroll:false, /*auto-expand width for horizontal scrolling: boolean*/
					autoScrollOnFocus:true, /*auto-scroll on focused elements: boolean*/
					normalizeMouseWheelDelta:false /*normalize mouse-wheel delta (-1/1)*/
				},
				contentTouchScroll:true, /*scrolling by touch-swipe content: boolean*/
				callbacks:{
					onScrollStart:function(){}, /*user custom callback function on scroll start event*/
					onScroll:function(){}, /*user custom callback function on scroll event*/
					onTotalScroll:function(){}, /*user custom callback function on scroll end reached event*/
					onTotalScrollBack:function(){}, /*user custom callback function on scroll begin reached event*/
					onTotalScrollOffset:0, /*scroll end reached offset: integer (pixels)*/
					onTotalScrollBackOffset:0, /*scroll begin reached offset: integer (pixels)*/
					whileScrolling:function(){} /*user custom callback function on scrolling event*/
				},
				theme:"light" /*"light", "dark", "light-2", "dark-2", "light-thick", "dark-thick", "light-thin", "dark-thin"*/
			},
			options=$.extend(true,defaults,options);
			return this.each(function(){
				var $this=$(this);
				/*set element width/height, create markup for custom scrollbars, add classes*/
				if(options.set_width){
					$this.css("width",options.set_width);
				}
				if(options.set_height){
					$this.css("height",options.set_height);
				}
				if(!$(document).data("mCustomScrollbar-index")){
					$(document).data("mCustomScrollbar-index","1");
				}else{
					var mCustomScrollbarIndex=parseInt($(document).data("mCustomScrollbar-index"));
					$(document).data("mCustomScrollbar-index",mCustomScrollbarIndex+1);
				}
				$this.wrapInner("<div class='mCustomScrollBox"+" mCS-"+options.theme+"' id='mCSB_"+$(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+$(document).data("mCustomScrollbar-index"));
				var mCustomScrollBox=$this.children(".mCustomScrollBox");
				if(options.horizontalScroll){
					mCustomScrollBox.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");
					var mCSB_h_wrapper=mCustomScrollBox.children(".mCSB_h_wrapper");
					mCSB_h_wrapper.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({"width":mCSB_h_wrapper.children().outerWidth(),"position":"relative"}).unwrap();
				}else{
					mCustomScrollBox.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");
				}
				var mCSB_container=mCustomScrollBox.children(".mCSB_container");
				if($.support.touch){
					mCSB_container.addClass("mCS_touch");
				}
				mCSB_container.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");
				var mCSB_scrollTools=mCustomScrollBox.children(".mCSB_scrollTools"),
					mCSB_draggerContainer=mCSB_scrollTools.children(".mCSB_draggerContainer"),
					mCSB_dragger=mCSB_draggerContainer.children(".mCSB_dragger");
				if(options.horizontalScroll){
					mCSB_dragger.data("minDraggerWidth",mCSB_dragger.width());
				}else{
					mCSB_dragger.data("minDraggerHeight",mCSB_dragger.height());
				}
				if(options.scrollButtons.enable){
					if(options.horizontalScroll){
						mCSB_scrollTools.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>");
					}else{
						mCSB_scrollTools.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>");
					}
				}
				/*mCustomScrollBox scrollTop and scrollLeft is always 0 to prevent browser focus scrolling*/
				mCustomScrollBox.bind("scroll",function(){
					if(!$this.is(".mCS_disabled")){ /*native focus scrolling for disabled scrollbars*/
						mCustomScrollBox.scrollTop(0).scrollLeft(0);
					}
				});
				/*store options, global vars/states, intervals*/
				$this.data({
					/*init state*/
					"mCS_Init":true,
					/*instance index*/
					"mCustomScrollbarIndex":$(document).data("mCustomScrollbar-index"),
					/*option parameters*/
					"horizontalScroll":options.horizontalScroll,
					"scrollInertia":options.scrollInertia,
					"scrollEasing":"mcsEaseOut",
					"mouseWheel":options.mouseWheel,
					"mouseWheelPixels":options.mouseWheelPixels,
					"autoDraggerLength":options.autoDraggerLength,
					"autoHideScrollbar":options.autoHideScrollbar,
					"alwaysShowScrollbar":options.alwaysShowScrollbar,
					"snapAmount":options.snapAmount,
					"snapOffset":options.snapOffset,
					"scrollButtons_enable":options.scrollButtons.enable,
					"scrollButtons_scrollType":options.scrollButtons.scrollType,
					"scrollButtons_scrollSpeed":options.scrollButtons.scrollSpeed,
					"scrollButtons_scrollAmount":options.scrollButtons.scrollAmount,
					"autoExpandHorizontalScroll":options.advanced.autoExpandHorizontalScroll,
					"autoScrollOnFocus":options.advanced.autoScrollOnFocus,
					"normalizeMouseWheelDelta":options.advanced.normalizeMouseWheelDelta,
					"contentTouchScroll":options.contentTouchScroll,
					"onScrollStart_Callback":options.callbacks.onScrollStart,
					"onScroll_Callback":options.callbacks.onScroll,
					"onTotalScroll_Callback":options.callbacks.onTotalScroll,
					"onTotalScrollBack_Callback":options.callbacks.onTotalScrollBack,
					"onTotalScroll_Offset":options.callbacks.onTotalScrollOffset,
					"onTotalScrollBack_Offset":options.callbacks.onTotalScrollBackOffset,
					"whileScrolling_Callback":options.callbacks.whileScrolling,
					/*events binding state*/
					"bindEvent_scrollbar_drag":false,
					"bindEvent_content_touch":false,
					"bindEvent_scrollbar_click":false,
					"bindEvent_mousewheel":false,
					"bindEvent_buttonsContinuous_y":false,
					"bindEvent_buttonsContinuous_x":false,
					"bindEvent_buttonsPixels_y":false,
					"bindEvent_buttonsPixels_x":false,
					"bindEvent_focusin":false,
					"bindEvent_autoHideScrollbar":false,
					/*buttons intervals*/
					"mCSB_buttonScrollRight":false,
					"mCSB_buttonScrollLeft":false,
					"mCSB_buttonScrollDown":false,
					"mCSB_buttonScrollUp":false
				});
				/*max-width/max-height*/
				if(options.horizontalScroll){
					if($this.css("max-width")!=="none"){
						if(!options.advanced.updateOnContentResize){ /*needs updateOnContentResize*/
							options.advanced.updateOnContentResize=true;
						}
					}
				}else{
					if($this.css("max-height")!=="none"){
						var percentage=false,maxHeight=parseInt($this.css("max-height"));
						if($this.css("max-height").indexOf("%")>=0){
							percentage=maxHeight,
							maxHeight=$this.parent().height()*percentage/100;
						}
						$this.css("overflow","hidden");
						mCustomScrollBox.css("max-height",maxHeight);
					}
				}
				$this.mCustomScrollbar("update");
				/*window resize fn (for layouts based on percentages)*/
				if(options.advanced.updateOnBrowserResize){
					var mCSB_resizeTimeout,currWinWidth=$(window).width(),currWinHeight=$(window).height();
					$(window).bind("resize."+$this.data("mCustomScrollbarIndex"),function(){
						if(mCSB_resizeTimeout){
							clearTimeout(mCSB_resizeTimeout);
						}
						mCSB_resizeTimeout=setTimeout(function(){
							if(!$this.is(".mCS_disabled") && !$this.is(".mCS_destroyed")){
								var winWidth=$(window).width(),winHeight=$(window).height();
								if(currWinWidth!==winWidth || currWinHeight!==winHeight){ /*ie8 fix*/
									if($this.css("max-height")!=="none" && percentage){
										mCustomScrollBox.css("max-height",$this.parent().height()*percentage/100);
									}
									$this.mCustomScrollbar("update");
									currWinWidth=winWidth; currWinHeight=winHeight;
								}
							}
						},150);
					});
				}
				/*content resize fn (for dynamically generated content)*/
				if(options.advanced.updateOnContentResize){
					var mCSB_onContentResize;
					if(options.horizontalScroll){
						var mCSB_containerOldSize=mCSB_container.outerWidth();
					}else{
						var mCSB_containerOldSize=mCSB_container.outerHeight();
					}
					mCSB_onContentResize=setInterval(function(){
						if(options.horizontalScroll){
							if(options.advanced.autoExpandHorizontalScroll){
								mCSB_container.css({"position":"absolute","width":"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({"width":mCSB_container.outerWidth(),"position":"relative"}).unwrap();
							}
							var mCSB_containerNewSize=mCSB_container.outerWidth();
						}else{
							var mCSB_containerNewSize=mCSB_container.outerHeight();
						}
						if(mCSB_containerNewSize!=mCSB_containerOldSize){
							$this.mCustomScrollbar("update");
							mCSB_containerOldSize=mCSB_containerNewSize;
						}
					},300);
				}
			});
		},
		update:function(){
			var $this=$(this),
				mCustomScrollBox=$this.children(".mCustomScrollBox"),
				mCSB_container=mCustomScrollBox.children(".mCSB_container");
			mCSB_container.removeClass("mCS_no_scrollbar");
			$this.removeClass("mCS_disabled mCS_destroyed");
			mCustomScrollBox.scrollTop(0).scrollLeft(0); /*reset scrollTop/scrollLeft to prevent browser focus scrolling*/
			var mCSB_scrollTools=mCustomScrollBox.children(".mCSB_scrollTools"),
				mCSB_draggerContainer=mCSB_scrollTools.children(".mCSB_draggerContainer"),
				mCSB_dragger=mCSB_draggerContainer.children(".mCSB_dragger");
			if($this.data("horizontalScroll")){
				var mCSB_buttonLeft=mCSB_scrollTools.children(".mCSB_buttonLeft"),
					mCSB_buttonRight=mCSB_scrollTools.children(".mCSB_buttonRight"),
					mCustomScrollBoxW=mCustomScrollBox.width();
				if($this.data("autoExpandHorizontalScroll")){
					mCSB_container.css({"position":"absolute","width":"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({"width":mCSB_container.outerWidth(),"position":"relative"}).unwrap();
				}
				var mCSB_containerW=mCSB_container.outerWidth();
			}else{
				var mCSB_buttonUp=mCSB_scrollTools.children(".mCSB_buttonUp"),
					mCSB_buttonDown=mCSB_scrollTools.children(".mCSB_buttonDown"),
					mCustomScrollBoxH=mCustomScrollBox.height(),
					mCSB_containerH=mCSB_container.outerHeight();
			}
			if(mCSB_containerH>mCustomScrollBoxH && !$this.data("horizontalScroll")){ /*content needs vertical scrolling*/
				mCSB_scrollTools.css("display","block");
				var mCSB_draggerContainerH=mCSB_draggerContainer.height();
				/*auto adjust scrollbar dragger length analogous to content*/
				if($this.data("autoDraggerLength")){
					var draggerH=Math.round(mCustomScrollBoxH/mCSB_containerH*mCSB_draggerContainerH),
						minDraggerH=mCSB_dragger.data("minDraggerHeight");
					if(draggerH<=minDraggerH){ /*min dragger height*/
						mCSB_dragger.css({"height":minDraggerH});
					}else if(draggerH>=mCSB_draggerContainerH-10){ /*max dragger height*/
						var mCSB_draggerContainerMaxH=mCSB_draggerContainerH-10;
						mCSB_dragger.css({"height":mCSB_draggerContainerMaxH});
					}else{
						mCSB_dragger.css({"height":draggerH});
					}
					mCSB_dragger.children(".mCSB_dragger_bar").css({"line-height":mCSB_dragger.height()+"px"});
				}
				var mCSB_draggerH=mCSB_dragger.height(),
				/*calculate and store scroll amount, add scrolling*/
					scrollAmount=(mCSB_containerH-mCustomScrollBoxH)/(mCSB_draggerContainerH-mCSB_draggerH);
				$this.data("scrollAmount",scrollAmount).mCustomScrollbar("scrolling",mCustomScrollBox,mCSB_container,mCSB_draggerContainer,mCSB_dragger,mCSB_buttonUp,mCSB_buttonDown,mCSB_buttonLeft,mCSB_buttonRight);
				/*scroll*/
				var mCSB_containerP=Math.abs(mCSB_container.position().top);
				$this.mCustomScrollbar("scrollTo",mCSB_containerP,{scrollInertia:0,trigger:"internal"});
			}else if(mCSB_containerW>mCustomScrollBoxW && $this.data("horizontalScroll")){ /*content needs horizontal scrolling*/
				mCSB_scrollTools.css("display","block");
				var mCSB_draggerContainerW=mCSB_draggerContainer.width();
				/*auto adjust scrollbar dragger length analogous to content*/
				if($this.data("autoDraggerLength")){
					var draggerW=Math.round(mCustomScrollBoxW/mCSB_containerW*mCSB_draggerContainerW),
						minDraggerW=mCSB_dragger.data("minDraggerWidth");
					if(draggerW<=minDraggerW){ /*min dragger height*/
						mCSB_dragger.css({"width":minDraggerW});
					}else if(draggerW>=mCSB_draggerContainerW-10){ /*max dragger height*/
						var mCSB_draggerContainerMaxW=mCSB_draggerContainerW-10;
						mCSB_dragger.css({"width":mCSB_draggerContainerMaxW});
					}else{
						mCSB_dragger.css({"width":draggerW});
					}
				}
				var mCSB_draggerW=mCSB_dragger.width(),
				/*calculate and store scroll amount, add scrolling*/
					scrollAmount=(mCSB_containerW-mCustomScrollBoxW)/(mCSB_draggerContainerW-mCSB_draggerW);
				$this.data("scrollAmount",scrollAmount).mCustomScrollbar("scrolling",mCustomScrollBox,mCSB_container,mCSB_draggerContainer,mCSB_dragger,mCSB_buttonUp,mCSB_buttonDown,mCSB_buttonLeft,mCSB_buttonRight);
				/*scroll*/
				var mCSB_containerP=Math.abs(mCSB_container.position().left);
				$this.mCustomScrollbar("scrollTo",mCSB_containerP,{scrollInertia:0,trigger:"internal"});
			}else{ /*content does not need scrolling*/
				/*unbind events, reset content position, hide scrollbars, remove classes*/
				mCustomScrollBox.unbind("mousewheel focusin");
				if($this.data("horizontalScroll")){
					mCSB_dragger.add(mCSB_container).css("left",0);
				}else{
					mCSB_dragger.add(mCSB_container).css("top",0);
				}
				if ($this.data("alwaysShowScrollbar")) {
					if(!$this.data("horizontalScroll")){ /*vertical scrolling*/
						mCSB_dragger.css({"height":mCSB_draggerContainer.height()});
					}else if($this.data("horizontalScroll")){ /*horizontal scrolling*/
						mCSB_dragger.css({"width":mCSB_draggerContainer.width()});
					}
				} else {
					mCSB_scrollTools.css("display","none");
					mCSB_container.addClass("mCS_no_scrollbar");
				}
				$this.data({"bindEvent_mousewheel":false,"bindEvent_focusin":false});
			}
		},
		scrolling:function(mCustomScrollBox,mCSB_container,mCSB_draggerContainer,mCSB_dragger,mCSB_buttonUp,mCSB_buttonDown,mCSB_buttonLeft,mCSB_buttonRight){
			var $this=$(this);
			/*scrollbar drag scrolling*/
			if(!$this.data("bindEvent_scrollbar_drag")){
				var mCSB_draggerDragY,mCSB_draggerDragX,
					mCSB_dragger_downEvent,mCSB_dragger_moveEvent,mCSB_dragger_upEvent;
				if($.support.pointer){ /*pointer*/
					mCSB_dragger_downEvent="pointerdown";
					mCSB_dragger_moveEvent="pointermove";
					mCSB_dragger_upEvent="pointerup";
				}else if($.support.msPointer){ /*MSPointer*/
					mCSB_dragger_downEvent="MSPointerDown";
					mCSB_dragger_moveEvent="MSPointerMove";
					mCSB_dragger_upEvent="MSPointerUp";
				}
				if($.support.pointer || $.support.msPointer){ /*pointer, MSPointer*/
					mCSB_dragger.bind(mCSB_dragger_downEvent,function(e){
						e.preventDefault();
						$this.data({"on_drag":true}); mCSB_dragger.addClass("mCSB_dragger_onDrag");
						var elem=$(this),
							elemOffset=elem.offset(),
							x=e.originalEvent.pageX-elemOffset.left,
							y=e.originalEvent.pageY-elemOffset.top;
						if(x<elem.width() && x>0 && y<elem.height() && y>0){
							mCSB_draggerDragY=y;
							mCSB_draggerDragX=x;
						}
					});
					$(document).bind(mCSB_dragger_moveEvent+"."+$this.data("mCustomScrollbarIndex"),function(e){
						e.preventDefault();
						if($this.data("on_drag")){
							var elem=mCSB_dragger,
								elemOffset=elem.offset(),
								x=e.originalEvent.pageX-elemOffset.left,
								y=e.originalEvent.pageY-elemOffset.top;
							scrollbarDrag(mCSB_draggerDragY,mCSB_draggerDragX,y,x);
						}
					}).bind(mCSB_dragger_upEvent+"."+$this.data("mCustomScrollbarIndex"),function(e){
						$this.data({"on_drag":false}); mCSB_dragger.removeClass("mCSB_dragger_onDrag");
					});
				}else{ /*mouse/touch*/
					mCSB_dragger.bind("mousedown touchstart",function(e){
						e.preventDefault(); e.stopImmediatePropagation();
						var	elem=$(this),elemOffset=elem.offset(),x,y;
						if(e.type==="touchstart"){
							var touch=e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
							x=touch.pageX-elemOffset.left; y=touch.pageY-elemOffset.top;
						}else{
							$this.data({"on_drag":true}); mCSB_dragger.addClass("mCSB_dragger_onDrag");
							x=e.pageX-elemOffset.left; y=e.pageY-elemOffset.top;
						}
						if(x<elem.width() && x>0 && y<elem.height() && y>0){
							mCSB_draggerDragY=y; mCSB_draggerDragX=x;
						}
					}).bind("touchmove",function(e){
						e.preventDefault(); e.stopImmediatePropagation();
						var touch=e.originalEvent.touches[0] || e.originalEvent.changedTouches[0],
							elem=$(this),
							elemOffset=elem.offset(),
							x=touch.pageX-elemOffset.left,
							y=touch.pageY-elemOffset.top;
						scrollbarDrag(mCSB_draggerDragY,mCSB_draggerDragX,y,x);
					});
					$(document).bind("mousemove."+$this.data("mCustomScrollbarIndex"),function(e){
						if($this.data("on_drag")){
							var elem=mCSB_dragger,
								elemOffset=elem.offset(),
								x=e.pageX-elemOffset.left,
								y=e.pageY-elemOffset.top;
							scrollbarDrag(mCSB_draggerDragY,mCSB_draggerDragX,y,x);
						}
					}).bind("mouseup."+$this.data("mCustomScrollbarIndex"),function(e){
						$this.data({"on_drag":false}); mCSB_dragger.removeClass("mCSB_dragger_onDrag");
					});
				}
				$this.data({"bindEvent_scrollbar_drag":true});
			}
			function scrollbarDrag(mCSB_draggerDragY,mCSB_draggerDragX,y,x){
				if($this.data("horizontalScroll")){
					$this.mCustomScrollbar("scrollTo",(mCSB_dragger.position().left-(mCSB_draggerDragX))+x,{moveDragger:true,trigger:"internal"});
				}else{
					$this.mCustomScrollbar("scrollTo",(mCSB_dragger.position().top-(mCSB_draggerDragY))+y,{moveDragger:true,trigger:"internal"});
				}
			}
			/*content touch-drag*/
			if($.support.touch && $this.data("contentTouchScroll")){
				if(!$this.data("bindEvent_content_touch")){
					var touch,
						elem,elemOffset,y,x,mCSB_containerTouchY,mCSB_containerTouchX;
					mCSB_container.bind("touchstart",function(e){
						e.stopImmediatePropagation();
						touch=e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
						elem=$(this);
						elemOffset=elem.offset();
						x=touch.pageX-elemOffset.left;
						y=touch.pageY-elemOffset.top;
						mCSB_containerTouchY=y;
						mCSB_containerTouchX=x;
					});
					mCSB_container.bind("touchmove",function(e){
						e.preventDefault(); e.stopImmediatePropagation();
						touch=e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
						elem=$(this).parent();
						elemOffset=elem.offset();
						x=touch.pageX-elemOffset.left;
						y=touch.pageY-elemOffset.top;
						if($this.data("horizontalScroll")){
							$this.mCustomScrollbar("scrollTo",mCSB_containerTouchX-x,{trigger:"internal"});
						}else{
							$this.mCustomScrollbar("scrollTo",mCSB_containerTouchY-y,{trigger:"internal"});
						}
					});
				}
			}
			/*dragger rail click scrolling*/
			if(!$this.data("bindEvent_scrollbar_click")){
				mCSB_draggerContainer.bind("click",function(e){
					var scrollToPos=(e.pageY-mCSB_draggerContainer.offset().top)*$this.data("scrollAmount"),target=$(e.target);
					if($this.data("horizontalScroll")){
						scrollToPos=(e.pageX-mCSB_draggerContainer.offset().left)*$this.data("scrollAmount");
					}
					if(target.hasClass("mCSB_draggerContainer") || target.hasClass("mCSB_draggerRail")){
						$this.mCustomScrollbar("scrollTo",scrollToPos,{trigger:"internal",scrollEasing:"draggerRailEase"});
					}
				});
				$this.data({"bindEvent_scrollbar_click":true});
			}
			/*mousewheel scrolling*/
			if($this.data("mouseWheel")){
				if(!$this.data("bindEvent_mousewheel")){
					mCustomScrollBox.bind("mousewheel",function(e,delta){
						var scrollTo,mouseWheelPixels=$this.data("mouseWheelPixels"),absPos=Math.abs(mCSB_container.position().top),
							draggerPos=mCSB_dragger.position().top,limit=mCSB_draggerContainer.height()-mCSB_dragger.height();
						if($this.data("normalizeMouseWheelDelta")){
							if(delta<0){delta=-1;}else{delta=1;}
						}
						if(mouseWheelPixels==="auto"){
							mouseWheelPixels=100+Math.round($this.data("scrollAmount")/2);
						}
						if($this.data("horizontalScroll")){
							draggerPos=mCSB_dragger.position().left; 
							limit=mCSB_draggerContainer.width()-mCSB_dragger.width();
							absPos=Math.abs(mCSB_container.position().left);
						}
						if((delta>0 && draggerPos!==0) || (delta<0 && draggerPos!==limit)){e.preventDefault(); e.stopImmediatePropagation();}
						scrollTo=absPos-(delta*mouseWheelPixels);
						$this.mCustomScrollbar("scrollTo",scrollTo,{trigger:"internal"});
					});
					$this.data({"bindEvent_mousewheel":true});
				}
			}
			/*buttons scrolling*/
			if($this.data("scrollButtons_enable")){
				if($this.data("scrollButtons_scrollType")==="pixels"){ /*scroll by pixels*/
					if($this.data("horizontalScroll")){
						mCSB_buttonRight.add(mCSB_buttonLeft).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",mCSB_buttonRight_stop,mCSB_buttonLeft_stop);
						$this.data({"bindEvent_buttonsContinuous_x":false});
						if(!$this.data("bindEvent_buttonsPixels_x")){
							/*scroll right*/
							mCSB_buttonRight.bind("click",function(e){
								e.preventDefault();
								PixelsScrollTo(Math.abs(mCSB_container.position().left)+$this.data("scrollButtons_scrollAmount"));
							});
							/*scroll left*/
							mCSB_buttonLeft.bind("click",function(e){
								e.preventDefault();
								PixelsScrollTo(Math.abs(mCSB_container.position().left)-$this.data("scrollButtons_scrollAmount"));
							});
							$this.data({"bindEvent_buttonsPixels_x":true});
						}
					}else{
						mCSB_buttonDown.add(mCSB_buttonUp).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",mCSB_buttonRight_stop,mCSB_buttonLeft_stop);
						$this.data({"bindEvent_buttonsContinuous_y":false});
						if(!$this.data("bindEvent_buttonsPixels_y")){
							/*scroll down*/
							mCSB_buttonDown.bind("click",function(e){
								e.preventDefault();
								PixelsScrollTo(Math.abs(mCSB_container.position().top)+$this.data("scrollButtons_scrollAmount"));
							});
							/*scroll up*/
							mCSB_buttonUp.bind("click",function(e){
								e.preventDefault();
								PixelsScrollTo(Math.abs(mCSB_container.position().top)-$this.data("scrollButtons_scrollAmount"));
							});
							$this.data({"bindEvent_buttonsPixels_y":true});
						}
					}
					function PixelsScrollTo(to){
						if(!mCSB_dragger.data("preventAction")){
							mCSB_dragger.data("preventAction",true);
							$this.mCustomScrollbar("scrollTo",to,{trigger:"internal"});
						}
					}
				}else{ /*continuous scrolling*/
					if($this.data("horizontalScroll")){
						mCSB_buttonRight.add(mCSB_buttonLeft).unbind("click");
						$this.data({"bindEvent_buttonsPixels_x":false});
						if(!$this.data("bindEvent_buttonsContinuous_x")){
							/*scroll right*/
							mCSB_buttonRight.bind("mousedown touchstart MSPointerDown pointerdown",function(e){
								e.preventDefault();
								var scrollButtonsSpeed=ScrollButtonsSpeed();
								$this.data({"mCSB_buttonScrollRight":setInterval(function(){
									$this.mCustomScrollbar("scrollTo",Math.abs(mCSB_container.position().left)+scrollButtonsSpeed,{trigger:"internal",scrollEasing:"easeOutCirc"});
								},17)});
							});
							var mCSB_buttonRight_stop=function(e){
								e.preventDefault(); clearInterval($this.data("mCSB_buttonScrollRight"));
							}
							mCSB_buttonRight.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",mCSB_buttonRight_stop);
							/*scroll left*/
							mCSB_buttonLeft.bind("mousedown touchstart MSPointerDown pointerdown",function(e){
								e.preventDefault();
								var scrollButtonsSpeed=ScrollButtonsSpeed();
								$this.data({"mCSB_buttonScrollLeft":setInterval(function(){
									$this.mCustomScrollbar("scrollTo",Math.abs(mCSB_container.position().left)-scrollButtonsSpeed,{trigger:"internal",scrollEasing:"easeOutCirc"});
								},17)});
							});	
							var mCSB_buttonLeft_stop=function(e){
								e.preventDefault(); clearInterval($this.data("mCSB_buttonScrollLeft"));
							}
							mCSB_buttonLeft.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",mCSB_buttonLeft_stop);
							$this.data({"bindEvent_buttonsContinuous_x":true});
						}
					}else{
						mCSB_buttonDown.add(mCSB_buttonUp).unbind("click");
						$this.data({"bindEvent_buttonsPixels_y":false});
						if(!$this.data("bindEvent_buttonsContinuous_y")){
							/*scroll down*/
							mCSB_buttonDown.bind("mousedown touchstart MSPointerDown pointerdown",function(e){
								e.preventDefault();
								var scrollButtonsSpeed=ScrollButtonsSpeed();
								$this.data({"mCSB_buttonScrollDown":setInterval(function(){
									$this.mCustomScrollbar("scrollTo",Math.abs(mCSB_container.position().top)+scrollButtonsSpeed,{trigger:"internal",scrollEasing:"easeOutCirc"});
								},17)});
							});
							var mCSB_buttonDown_stop=function(e){
								e.preventDefault(); clearInterval($this.data("mCSB_buttonScrollDown"));
							}
							mCSB_buttonDown.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",mCSB_buttonDown_stop);
							/*scroll up*/
							mCSB_buttonUp.bind("mousedown touchstart MSPointerDown pointerdown",function(e){
								e.preventDefault();
								var scrollButtonsSpeed=ScrollButtonsSpeed();
								$this.data({"mCSB_buttonScrollUp":setInterval(function(){
									$this.mCustomScrollbar("scrollTo",Math.abs(mCSB_container.position().top)-scrollButtonsSpeed,{trigger:"internal",scrollEasing:"easeOutCirc"});
								},17)});
							});	
							var mCSB_buttonUp_stop=function(e){
								e.preventDefault(); clearInterval($this.data("mCSB_buttonScrollUp"));
							}
							mCSB_buttonUp.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",mCSB_buttonUp_stop);
							$this.data({"bindEvent_buttonsContinuous_y":true});
						}
					}
					function ScrollButtonsSpeed(){
						var speed=$this.data("scrollButtons_scrollSpeed");
						if($this.data("scrollButtons_scrollSpeed")==="auto"){
							speed=Math.round(($this.data("scrollInertia")+100)/40);
						}
						return speed;
					}
				}
			}
			/*scrolling on element focus (e.g. via TAB key)*/
			if($this.data("autoScrollOnFocus")){
				if(!$this.data("bindEvent_focusin")){
					mCustomScrollBox.bind("focusin",function(){
						mCustomScrollBox.scrollTop(0).scrollLeft(0);
						var focusedElem=$(document.activeElement);
						if(focusedElem.is("input,textarea,select,button,a[tabindex],area,object")){
							var mCSB_containerPos=mCSB_container.position().top,
								focusedElemPos=focusedElem.position().top,
								visibleLimit=mCustomScrollBox.height()-focusedElem.outerHeight();
							if($this.data("horizontalScroll")){
								mCSB_containerPos=mCSB_container.position().left;
								focusedElemPos=focusedElem.position().left;
								visibleLimit=mCustomScrollBox.width()-focusedElem.outerWidth();
							}
							if(mCSB_containerPos+focusedElemPos<0 || mCSB_containerPos+focusedElemPos>visibleLimit){
								$this.mCustomScrollbar("scrollTo",focusedElemPos,{trigger:"internal"});
							}
						}
					});
					$this.data({"bindEvent_focusin":true});
				}
			}
			/*auto-hide scrollbar*/
			if($this.data("autoHideScrollbar") && !$this.data("alwaysShowScrollbar")){
				if(!$this.data("bindEvent_autoHideScrollbar")){
					mCustomScrollBox.bind("mouseenter",function(e){
						mCustomScrollBox.addClass("mCS-mouse-over");
						functions.showScrollbar.call(mCustomScrollBox.children(".mCSB_scrollTools"));
					}).bind("mouseleave touchend",function(e){
						mCustomScrollBox.removeClass("mCS-mouse-over");
						if(e.type==="mouseleave"){functions.hideScrollbar.call(mCustomScrollBox.children(".mCSB_scrollTools"));}
					});
					$this.data({"bindEvent_autoHideScrollbar":true});
				}
			}
		},
		scrollTo:function(scrollTo,options){
			var $this=$(this),
				defaults={
					moveDragger:false,
					trigger:"external",
					callbacks:true,
					scrollInertia:$this.data("scrollInertia"),
					scrollEasing:$this.data("scrollEasing")
				},
				options=$.extend(defaults,options),
				draggerScrollTo,
				mCustomScrollBox=$this.children(".mCustomScrollBox"),
				mCSB_container=mCustomScrollBox.children(".mCSB_container"),
				mCSB_scrollTools=mCustomScrollBox.children(".mCSB_scrollTools"),
				mCSB_draggerContainer=mCSB_scrollTools.children(".mCSB_draggerContainer"),
				mCSB_dragger=mCSB_draggerContainer.children(".mCSB_dragger"),
				contentSpeed=draggerSpeed=options.scrollInertia,
				scrollBeginning,scrollBeginningOffset,totalScroll,totalScrollOffset;
			if(!mCSB_container.hasClass("mCS_no_scrollbar")){
				$this.data({"mCS_trigger":options.trigger});
				if($this.data("mCS_Init")){options.callbacks=false;}
				if(scrollTo || scrollTo===0){
					if(typeof(scrollTo)==="number"){ /*if integer, scroll by number of pixels*/
						if(options.moveDragger){ /*scroll dragger*/
							draggerScrollTo=scrollTo;
							if($this.data("horizontalScroll")){
								scrollTo=mCSB_dragger.position().left*$this.data("scrollAmount");
							}else{
								scrollTo=mCSB_dragger.position().top*$this.data("scrollAmount");
							}
							draggerSpeed=0;
						}else{ /*scroll content by default*/
							draggerScrollTo=scrollTo/$this.data("scrollAmount");
						}
					}else if(typeof(scrollTo)==="string"){ /*if string, scroll by element position*/
						var target;
						if(scrollTo==="top"){ /*scroll to top*/
							target=0;
						}else if(scrollTo==="bottom" && !$this.data("horizontalScroll")){ /*scroll to bottom*/
							target=mCSB_container.outerHeight()-mCustomScrollBox.height();
						}else if(scrollTo==="left"){ /*scroll to left*/
							target=0;
						}else if(scrollTo==="right" && $this.data("horizontalScroll")){ /*scroll to right*/
							target=mCSB_container.outerWidth()-mCustomScrollBox.width();
						}else if(scrollTo==="first"){ /*scroll to first element position*/
							target=$this.find(".mCSB_container").find(":first");
						}else if(scrollTo==="last"){ /*scroll to last element position*/
							target=$this.find(".mCSB_container").find(":last");
						}else{ /*scroll to element position*/
							target=$this.find(scrollTo);
						}
						if(target.length===1){ /*if such unique element exists, scroll to it*/
							if($this.data("horizontalScroll")){
								scrollTo=target.position().left;
							}else{
								scrollTo=target.position().top;
							}
							draggerScrollTo=scrollTo/$this.data("scrollAmount");
						}else{
							draggerScrollTo=scrollTo=target;
						}
					}
					/*scroll to*/
					if($this.data("horizontalScroll")){
						if($this.data("onTotalScrollBack_Offset")){ /*scroll beginning offset*/
							scrollBeginningOffset=-$this.data("onTotalScrollBack_Offset");
						}
						if($this.data("onTotalScroll_Offset")){ /*total scroll offset*/
							totalScrollOffset=mCustomScrollBox.width()-mCSB_container.outerWidth()+$this.data("onTotalScroll_Offset");
						}
						if(draggerScrollTo<0){ /*scroll start position*/
							draggerScrollTo=scrollTo=0; clearInterval($this.data("mCSB_buttonScrollLeft"));
							if(!scrollBeginningOffset){scrollBeginning=true;}
						}else if(draggerScrollTo>=mCSB_draggerContainer.width()-mCSB_dragger.width()){ /*scroll end position*/
							draggerScrollTo=mCSB_draggerContainer.width()-mCSB_dragger.width();
							scrollTo=mCustomScrollBox.width()-mCSB_container.outerWidth(); clearInterval($this.data("mCSB_buttonScrollRight"));
							if(!totalScrollOffset){totalScroll=true;}
						}else{scrollTo=-scrollTo;}
						var snapAmount = $this.data("snapAmount");
						if (snapAmount) {
							scrollTo = Math.round(scrollTo / snapAmount) * snapAmount - $this.data("snapOffset");
						}
						/*scrolling animation*/
						functions.mTweenAxis.call(this,mCSB_dragger[0],"left",Math.round(draggerScrollTo),draggerSpeed,options.scrollEasing);
						functions.mTweenAxis.call(this,mCSB_container[0],"left",Math.round(scrollTo),contentSpeed,options.scrollEasing,{
							onStart:function(){
								if(options.callbacks && !$this.data("mCS_tweenRunning")){callbacks("onScrollStart");}
								if($this.data("autoHideScrollbar") && !$this.data("alwaysShowScrollbar")){functions.showScrollbar.call(mCSB_scrollTools);}
							},
							onUpdate:function(){
								if(options.callbacks){callbacks("whileScrolling");}
							},
							onComplete:function(){
								if(options.callbacks){
									callbacks("onScroll");
									if(scrollBeginning || (scrollBeginningOffset && mCSB_container.position().left>=scrollBeginningOffset)){callbacks("onTotalScrollBack");}
									if(totalScroll || (totalScrollOffset && mCSB_container.position().left<=totalScrollOffset)){callbacks("onTotalScroll");}
								}
								mCSB_dragger.data("preventAction",false); $this.data("mCS_tweenRunning",false);
								if($this.data("autoHideScrollbar") && !$this.data("alwaysShowScrollbar")){if(!mCustomScrollBox.hasClass("mCS-mouse-over")){functions.hideScrollbar.call(mCSB_scrollTools);}}
							}
						});
					}else{
						if($this.data("onTotalScrollBack_Offset")){ /*scroll beginning offset*/
							scrollBeginningOffset=-$this.data("onTotalScrollBack_Offset");
						}
						if($this.data("onTotalScroll_Offset")){ /*total scroll offset*/
							totalScrollOffset=mCustomScrollBox.height()-mCSB_container.outerHeight()+$this.data("onTotalScroll_Offset");
						}
						if(draggerScrollTo<0){ /*scroll start position*/
							draggerScrollTo=scrollTo=0; clearInterval($this.data("mCSB_buttonScrollUp"));
							if(!scrollBeginningOffset){scrollBeginning=true;}
						}else if(draggerScrollTo>=mCSB_draggerContainer.height()-mCSB_dragger.height()){ /*scroll end position*/
							draggerScrollTo=mCSB_draggerContainer.height()-mCSB_dragger.height();
							scrollTo=mCustomScrollBox.height()-mCSB_container.outerHeight(); clearInterval($this.data("mCSB_buttonScrollDown"));
							if(!totalScrollOffset){totalScroll=true;}
						}else{scrollTo=-scrollTo;}
						var snapAmount = $this.data("snapAmount");
						if (snapAmount) {
							scrollTo = Math.round(scrollTo / snapAmount) * snapAmount - $this.data("snapOffset");
						}
						/*scrolling animation*/
						functions.mTweenAxis.call(this,mCSB_dragger[0],"top",Math.round(draggerScrollTo),draggerSpeed,options.scrollEasing);
						functions.mTweenAxis.call(this,mCSB_container[0],"top",Math.round(scrollTo),contentSpeed,options.scrollEasing,{
							onStart:function(){
								if(options.callbacks && !$this.data("mCS_tweenRunning")){callbacks("onScrollStart");}
								if($this.data("autoHideScrollbar") && !$this.data("alwaysShowScrollbar")){functions.showScrollbar.call(mCSB_scrollTools);}
							},
							onUpdate:function(){
								if(options.callbacks){callbacks("whileScrolling");}
							},
							onComplete:function(){
								if(options.callbacks){
									callbacks("onScroll");
									if(scrollBeginning || (scrollBeginningOffset && mCSB_container.position().top>=scrollBeginningOffset)){callbacks("onTotalScrollBack");}
									if(totalScroll || (totalScrollOffset && mCSB_container.position().top<=totalScrollOffset)){callbacks("onTotalScroll");}
								}
								mCSB_dragger.data("preventAction",false); $this.data("mCS_tweenRunning",false);
								if($this.data("autoHideScrollbar") && !$this.data("alwaysShowScrollbar")){if(!mCustomScrollBox.hasClass("mCS-mouse-over")){functions.hideScrollbar.call(mCSB_scrollTools);}}
							}
						});
					}
					if($this.data("mCS_Init")){$this.data({"mCS_Init":false});}
				}
			}
			/*callbacks*/
			function callbacks(cb){
				if ($this.data("mCustomScrollbarIndex")) {
					this.mcs = {
						top: mCSB_container.position().top, left: mCSB_container.position().left,
						draggerTop: mCSB_dragger.position().top, draggerLeft: mCSB_dragger.position().left,
						topPct: Math.round((100 * Math.abs(mCSB_container.position().top)) / Math.abs(mCSB_container.outerHeight() - mCustomScrollBox.height())),
						leftPct: Math.round((100 * Math.abs(mCSB_container.position().left)) / Math.abs(mCSB_container.outerWidth() - mCustomScrollBox.width()))
					};
					switch (cb) {
						/*start scrolling callback*/
						case "onScrollStart":
							$this.data("mCS_tweenRunning", true).data("onScrollStart_Callback").call($this, this.mcs);
							break;
						case "whileScrolling":
							$this.data("whileScrolling_Callback").call($this, this.mcs);
							break;
						case "onScroll":
							$this.data("onScroll_Callback").call($this, this.mcs);
							break;
						case "onTotalScrollBack":
							$this.data("onTotalScrollBack_Callback").call($this, this.mcs);
							break;
						case "onTotalScroll":
							$this.data("onTotalScroll_Callback").call($this, this.mcs);
							break;
					}
				}
			}
		},
		stop:function(){
			var $this=$(this),
				mCSB_container=$this.children().children(".mCSB_container"),
				mCSB_dragger=$this.children().children().children().children(".mCSB_dragger");
			functions.mTweenAxisStop.call(this,mCSB_container[0]);
			functions.mTweenAxisStop.call(this,mCSB_dragger[0]);
		},
		disable:function(resetScroll){
			var $this=$(this),
				mCustomScrollBox=$this.children(".mCustomScrollBox"),
				mCSB_container=mCustomScrollBox.children(".mCSB_container"),
				mCSB_scrollTools=mCustomScrollBox.children(".mCSB_scrollTools"),
				mCSB_dragger=mCSB_scrollTools.children().children(".mCSB_dragger");
			mCustomScrollBox.unbind("mousewheel focusin mouseenter mouseleave touchend");
			mCSB_container.unbind("touchstart touchmove")
			if(resetScroll){
				if($this.data("horizontalScroll")){
					mCSB_dragger.add(mCSB_container).css("left",0);
				}else{
					mCSB_dragger.add(mCSB_container).css("top",0);
				}
			}
			mCSB_scrollTools.css("display","none");
			mCSB_container.addClass("mCS_no_scrollbar");
			$this.data({"bindEvent_mousewheel":false,"bindEvent_focusin":false,"bindEvent_content_touch":false,"bindEvent_autoHideScrollbar":false}).addClass("mCS_disabled");
		},
		destroy:function(){
			var $this=$(this);
			$this.removeClass("mCustomScrollbar _mCS_"+$this.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();
			$(document).unbind("mousemove."+$this.data("mCustomScrollbarIndex")+" mouseup."+$this.data("mCustomScrollbarIndex")+" MSPointerMove."+$this.data("mCustomScrollbarIndex")+" MSPointerUp."+$this.data("mCustomScrollbarIndex"));
			$(window).unbind("resize."+$this.data("mCustomScrollbarIndex"));
		}
	},
	functions={
		/*hide/show scrollbar*/
		showScrollbar:function(){
			this.stop().animate({opacity:1},"fast");
		},
		hideScrollbar:function(){
			this.stop().animate({opacity:0},"fast");
		},
		/*js animation tween*/
		mTweenAxis:function(el,prop,to,duration,easing,callbacks){
			var callbacks=callbacks || {},
				onStart=callbacks.onStart || function(){},onUpdate=callbacks.onUpdate || function(){},onComplete=callbacks.onComplete || function(){};
			var startTime=_getTime(),_delay,progress=0,from=el.offsetTop,elStyle=el.style;
			if(prop==="left"){from=el.offsetLeft;}
			var diff=to-from;
			_cancelTween();
			_startTween();
			function _getTime(){
				if(window.performance && window.performance.now){
					return window.performance.now();
				}else{
					if(window.performance && window.performance.webkitNow){
						return window.performance.webkitNow();
					}else{
						if(Date.now){return Date.now();}else{return new Date().getTime();}
					}
				}
			}
			function _step(){
				if(!progress){onStart.call();}
				progress=_getTime()-startTime;
				_tween();
				if(progress>=el._time){
					el._time=(progress>el._time) ? progress+_delay-(progress- el._time) : progress+_delay-1;
					if(el._time<progress+1){el._time=progress+1;}
				}
				if(el._time<duration){el._id=_request(_step);}else{onComplete.call();}
			}
			function _tween(){
				if(duration>0){
					el.currVal=_ease(el._time,from,diff,duration,easing);
					elStyle[prop]=Math.round(el.currVal)+"px";
				}else{
					elStyle[prop]=to+"px";
				}
				onUpdate.call();
			}
			function _startTween(){
				_delay=1000/60;
				el._time=progress+_delay;
				_request=(!window.requestAnimationFrame) ? function(f){_tween(); return setTimeout(f,0.01);} : window.requestAnimationFrame;
				el._id=_request(_step);
			}
			function _cancelTween(){
				if(el._id==null){return;}
				if(!window.requestAnimationFrame){clearTimeout(el._id);
				}else{window.cancelAnimationFrame(el._id);}
				el._id=null;
			}
			function _ease(t,b,c,d,type){
				switch(type){
					case "linear":
						return c*t/d + b;
						break;
					case "easeOutQuad":
						t /= d; return -c * t*(t-2) + b;
						break;
					case "easeInOutQuad":
						t /= d/2;
						if (t < 1) return c/2*t*t + b;
						t--;
						return -c/2 * (t*(t-2) - 1) + b;
						break;
					case "easeOutCubic":
						t /= d; t--; return c*(t*t*t + 1) + b;
						break;
					case "easeOutQuart":
						t /= d; t--; return -c * (t*t*t*t - 1) + b;
						break;
					case "easeOutQuint":
						t /= d; t--; return c*(t*t*t*t*t + 1) + b;
						break;
					case "easeOutCirc":
						t /= d; t--; return c * Math.sqrt(1 - t*t) + b;
						break;
					case "easeOutSine":
						return c * Math.sin(t/d * (Math.PI/2)) + b;
						break;
					case "easeOutExpo":
						return c * ( -Math.pow( 2, -10 * t/d ) + 1 ) + b;
						break;
					case "mcsEaseOut":
						var ts=(t/=d)*t,tc=ts*t;
						return b+c*(0.499999999999997*tc*ts + -2.5*ts*ts + 5.5*tc + -6.5*ts + 4*t);
						break;
					case "draggerRailEase":
						t /= d/2;
						if (t < 1) return c/2*t*t*t + b;
						t -= 2;
						return c/2*(t*t*t + 2) + b;
						break;
				}
			}
		},
		/*stop js animation tweens*/
		mTweenAxisStop:function(el){
			if(el._id==null){return;}
			if(!window.requestAnimationFrame){clearTimeout(el._id);
			}else{window.cancelAnimationFrame(el._id);}
			el._id=null;
		},
		/*detect requestAnimationFrame and polyfill*/
		rafPolyfill:function(){
			var pfx=["ms","moz","webkit","o"],i=pfx.length;
			while(--i > -1 && !window.requestAnimationFrame){
				window.requestAnimationFrame=window[pfx[i]+"RequestAnimationFrame"];
				window.cancelAnimationFrame=window[pfx[i]+"CancelAnimationFrame"] || window[pfx[i]+"CancelRequestAnimationFrame"];
			}
		}
	}
	/*detect features*/
	functions.rafPolyfill.call(); /*requestAnimationFrame*/
	$.support.touch=!!('ontouchstart' in window); /*touch*/
	$.support.pointer=window.navigator.pointerEnabled; /*pointer support*/
	$.support.msPointer=window.navigator.msPointerEnabled; /*MSPointer support*/
	/*plugin dependencies*/
	var _dlp=("https:"==document.location.protocol) ? "https:" : "http:";
	$.event.special.mousewheel || document.write('<script src="'+_dlp+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>');
	/*plugin fn*/
	$.fn.mCustomScrollbar=function(method){
		if(methods[method]){
			return methods[method].apply(this,Array.prototype.slice.call(arguments,1));
		}else if(typeof method==="object" || !method){
			return methods.init.apply(this,arguments);
		}else{
			$.error("Method "+method+" does not exist");
		}
	};
})(jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/jquery.mCustomScrollbar.js", e)}};

// Source: /js/libs/respond.min.js
try{
/*! Respond.js v1.4.2: min/max-width media query polyfill
 * Copyright 2014 Scott Jehl
 * Licensed under MIT
 * http://j.mp/respondjs */

!function(a){"use strict";a.matchMedia=a.matchMedia||function(a){var b,c=a.documentElement,d=c.firstElementChild||c.firstChild,e=a.createElement("body"),f=a.createElement("div");return f.id="mq-test-1",f.style.cssText="position:absolute;top:-100em",e.style.background="none",e.appendChild(f),function(a){return f.innerHTML='&shy;<style media="'+a+'"> #mq-test-1 { width: 42px; }</style>',c.insertBefore(e,d),b=42===f.offsetWidth,c.removeChild(e),{matches:b,media:a}}}(a.document)}(this),function(a){"use strict";function b(){v(!0)}var c={};a.respond=c,c.update=function(){};var d=[],e=function(){var b=!1;try{b=new a.XMLHttpRequest}catch(c){b=new a.ActiveXObject("Microsoft.XMLHTTP")}return function(){return b}}(),f=function(a,b){var c=e();c&&(c.open("GET",a,!0),c.onreadystatechange=function(){4!==c.readyState||200!==c.status&&304!==c.status||b(c.responseText)},4!==c.readyState&&c.send(null))},g=function(a){return a.replace(c.regex.minmaxwh,"").match(c.regex.other)};if(c.ajax=f,c.queue=d,c.unsupportedmq=g,c.regex={media:/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},c.mediaQueriesSupported=a.matchMedia&&null!==a.matchMedia("only all")&&a.matchMedia("only all").matches,!c.mediaQueriesSupported){var h,i,j,k=a.document,l=k.documentElement,m=[],n=[],o=[],p={},q=30,r=k.getElementsByTagName("head")[0]||l,s=k.getElementsByTagName("base")[0],t=r.getElementsByTagName("link"),u=function(){var a,b=k.createElement("div"),c=k.body,d=l.style.fontSize,e=c&&c.style.fontSize,f=!1;return b.style.cssText="position:absolute;font-size:1em;width:1em",c||(c=f=k.createElement("body"),c.style.background="none"),l.style.fontSize="100%",c.style.fontSize="100%",c.appendChild(b),f&&l.insertBefore(c,l.firstChild),a=b.offsetWidth,f?l.removeChild(c):c.removeChild(b),l.style.fontSize=d,e&&(c.style.fontSize=e),a=j=parseFloat(a)},v=function(b){var c="clientWidth",d=l[c],e="CSS1Compat"===k.compatMode&&d||k.body[c]||d,f={},g=t[t.length-1],p=(new Date).getTime();if(b&&h&&q>p-h)return a.clearTimeout(i),i=a.setTimeout(v,q),void 0;h=p;for(var s in m)if(m.hasOwnProperty(s)){var w=m[s],x=w.minw,y=w.maxw,z=null===x,A=null===y,B="em";x&&(x=parseFloat(x)*(x.indexOf(B)>-1?j||u():1)),y&&(y=parseFloat(y)*(y.indexOf(B)>-1?j||u():1)),w.hasquery&&(z&&A||!(z||e>=x)||!(A||y>=e))||(f[w.media]||(f[w.media]=[]),f[w.media].push(n[w.rules]))}for(var C in o)o.hasOwnProperty(C)&&o[C]&&o[C].parentNode===r&&r.removeChild(o[C]);o.length=0;for(var D in f)if(f.hasOwnProperty(D)){var E=k.createElement("style"),F=f[D].join("\n");E.type="text/css",E.media=D,r.insertBefore(E,g.nextSibling),E.styleSheet?E.styleSheet.cssText=F:E.appendChild(k.createTextNode(F)),o.push(E)}},w=function(a,b,d){var e=a.replace(c.regex.comments,"").replace(c.regex.keyframes,"").match(c.regex.media),f=e&&e.length||0;b=b.substring(0,b.lastIndexOf("/"));var h=function(a){return a.replace(c.regex.urls,"$1"+b+"$2$3")},i=!f&&d;b.length&&(b+="/"),i&&(f=1);for(var j=0;f>j;j++){var k,l,o,p;i?(k=d,n.push(h(a))):(k=e[j].match(c.regex.findStyles)&&RegExp.$1,n.push(RegExp.$2&&h(RegExp.$2))),o=k.split(","),p=o.length;for(var q=0;p>q;q++)l=o[q],g(l)||m.push({media:l.split("(")[0].match(c.regex.only)&&RegExp.$2||"all",rules:n.length-1,hasquery:l.indexOf("(")>-1,minw:l.match(c.regex.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:l.match(c.regex.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}v()},x=function(){if(d.length){var b=d.shift();f(b.href,function(c){w(c,b.href,b.media),p[b.href]=!0,a.setTimeout(function(){x()},0)})}},y=function(){for(var b=0;b<t.length;b++){var c=t[b],e=c.href,f=c.media,g=c.rel&&"stylesheet"===c.rel.toLowerCase();e&&g&&!p[e]&&(c.styleSheet&&c.styleSheet.rawCssText?(w(c.styleSheet.rawCssText,e,f),p[e]=!0):(!/^([a-zA-Z:]*\/\/)/.test(e)&&!s||e.replace(RegExp.$1,"").split("/")[0]===a.location.host)&&("//"===e.substring(0,2)&&(e=a.location.protocol+e),d.push({href:e,media:f})))}x()};y(),c.update=y,c.getEmValue=u,a.addEventListener?a.addEventListener("resize",b,!1):a.attachEvent&&a.attachEvent("onresize",b)}}(this);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/respond.min.js", e)}};

// Source: /js/libs/jquery.ba-bbq.min.js
try{
/*
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,p){var i,m=Array.prototype.slice,r=decodeURIComponent,a=$.param,c,l,v,b=$.bbq=$.bbq||{},q,u,j,e=$.event.special,d="hashchange",A="querystring",D="fragment",y="elemUrlAttr",g="location",k="href",t="src",x=/^.*\?|#.*$/g,w=/^.*\#/,h,C={};function E(F){return typeof F==="string"}function B(G){var F=m.call(arguments,1);return function(){return G.apply(this,F.concat(m.call(arguments)))}}function n(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function o(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function f(H,M,F,I,G){var O,L,K,N,J;if(I!==i){K=F.match(H?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);J=K[3]||"";if(G===2&&E(I)){L=I.replace(H?w:x,"")}else{N=l(K[2]);I=E(I)?l[H?D:A](I):I;L=G===2?I:G===1?$.extend({},I,N):$.extend({},N,I);L=a(L);if(H){L=L.replace(h,r)}}O=K[1]+(H?"#":L||!K[1]?"?":"")+L+J}else{O=M(F!==i?F:p[g][k])}return O}a[A]=B(f,0,o);a[D]=c=B(f,1,n);c.noEscape=function(G){G=G||"";var F=$.map(G.split(""),encodeURIComponent);h=new RegExp(F.join("|"),"g")};c.noEscape(",/");$.deparam=l=function(I,F){var H={},G={"true":!0,"false":!1,"null":null};$.each(I.replace(/\+/g," ").split("&"),function(L,Q){var K=Q.split("="),P=r(K[0]),J,O=H,M=0,R=P.split("]["),N=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[N])){R[N]=R[N].replace(/\]$/,"");R=R.shift().split("[").concat(R);N=R.length-1}else{N=0}if(K.length===2){J=r(K[1]);if(F){J=J&&!isNaN(J)?+J:J==="undefined"?i:G[J]!==i?G[J]:J}if(N){for(;M<=N;M++){P=R[M]===""?O.length:R[M];O=O[P]=M<N?O[P]||(R[M+1]&&isNaN(R[M+1])?{}:[]):J}}else{if($.isArray(H[P])){H[P].push(J)}else{if(H[P]!==i){H[P]=[H[P],J]}else{H[P]=J}}}}else{if(P){H[P]=F?i:""}}});return H};function z(H,F,G){if(F===i||typeof F==="boolean"){G=F;F=a[H?D:A]()}else{F=E(F)?F.replace(H?w:x,""):F}return l(F,G)}l[A]=B(z,0);l[D]=v=B(z,1);$[y]||($[y]=function(F){return $.extend(C,F)})({a:k,base:k,iframe:t,img:t,input:t,form:"action",link:k,script:t});j=$[y];function s(I,G,H,F){if(!E(H)&&typeof H!=="object"){F=H;H=G;G=i}return this.each(function(){var L=$(this),J=G||j()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,F))})}$.fn[A]=B(s,A);$.fn[D]=B(s,D);b.pushState=q=function(I,F){if(E(I)&&/^#/.test(I)&&F===i){F=2}var H=I!==i,G=c(p[g][k],H?I:{},H?F:2);p[g][k]=G+(/#/.test(G)?"":"#")};b.getState=u=function(F,G){return F===i||typeof F==="boolean"?v(F):v(G)[F]};b.removeState=function(F){var G={};if(F!==i){G=u();$.each($.isArray(F)?F:arguments,function(I,H){delete G[H]})}q(G,2)};e[d]=$.extend(e[d],{add:function(F){var H;function G(J){var I=J[D]=c();J.getState=function(K,L){return K===i||typeof K==="boolean"?l(I,K):l(I,L)[K]};H.apply(this,arguments)}if($.isFunction(F)){H=F;return G}else{H=F.handler;F.handler=G}}})})(jQuery,this);
/*
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,i,b){var j,k=$.event.special,c="location",d="hashchange",l="href",f=$.browser,g=document.documentMode,h=f.msie&&(g===b||g<8),e="on"+d in i&&!h;function a(m){m=m||i[c][l];return m.replace(/^[^#]*#?(.*)$/,"$1")}$[d+"Delay"]=100;k[d]=$.extend(k[d],{setup:function(){if(e){return false}$(j.start)},teardown:function(){if(e){return false}$(j.stop)}});j=(function(){var m={},r,n,o,q;function p(){o=q=function(s){return s};if(h){n=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;q=function(){return a(n.document[c][l])};o=function(u,s){if(u!==s){var t=n.document;t.open().close();t[c].hash="#"+u}};o(a())}}m.start=function(){if(r){return}var t=a();o||p();(function s(){var v=a(),u=q(t);if(v!==t){o(t=v,u);$(i).trigger(d)}else{if(u!==t){i[c][l]=i[c][l].replace(/#.*/,"")+"#"+u}}r=setTimeout(s,$[d+"Delay"])})()};m.stop=function(){if(!n){r&&clearTimeout(r);r=0}};return m})()})(jQuery,this);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/libs/jquery.ba-bbq.min.js", e)}};

// Source: /js/bcom.nav.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.nav=function(){"use strict";var module={};return module.active=!1,module.states={toc:"toc-active",profile:"profile-active",search:"search-active"},module.panels={toc:$(".toc-mod"),search:$(".search-mod"),profile:$(".nav-profile-mod")},module.updateBodyState=function(state){module.clearBodyState(),state!==module.active?(module.active=state,$("body").addClass(module.states[state])):module.active=!1},module.clearBodyState=function(){_.each(module.states,function(s){$("body").removeClass(s)})},module.checkForAd=function(){$("#ad_searchbar").length>0||$(".nav-search-form").css("margin-left","0px")},module.init=function(){$(".js-toc-trigger").on("click",function(){var $body=$("body"),s=s_gi("nytbglobe");return $body.hasClass("page-hp")&&!$body.hasClass("page-section")?"toc"!==module.active?(s.tl(this,"o","Main Nav Hamburger - Expand_hp"),bcom.util.clearSVars(s)):(s.tl(this,"o","Main Nav Hamburger - Collapse_hp"),bcom.util.clearSVars(s)):"toc"!==module.active?(s.tl(this,"o","Main Nav Hamburger - Expand"),bcom.util.clearSVars(s)):(s.tl(this,"o","Main Nav Hamburger - Collapse"),bcom.util.clearSVars(s)),module.updateBodyState("toc"),!1}),$(".js-search-trigger").on("click",function(){return module.updateBodyState("search"),!1}),$(".js-profile-trigger").on("click",function(){return module.updateBodyState("profile"),!1}),$(".page-content").on("click",function(){module.active=!1,module.clearBodyState()}),$("html").hasClass("touch")&&module.clearBodyState()},module.checkForAd(),module}(),$(function(){bcom.nav.init()});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.nav.js", e)}};

// Source: /js/bcom.simple-galleries.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.galleries=function(){"use strict";function redrawSlides(){var $galleryType=$(".gallery-type");if($galleryType.hasClass("click-gallery")){if("object"==typeof s&&module.firstFire===!1&&(bcom.util.resetSVars(module.omniture),s=s_gi("nytbglobe,nytbgglobal"),s.prop5=module.currentSlide+1,s.t(),bcom.util.resetSVars(module.omniture)),module.currentSlide<0&&(module.currentSlide=0),$(".gallery-slide").hide(),module.currentSlide>payload.length-1&&(module.currentSlide=payload.length-1),0===module.currentSlide)$galleryType.addClass("first-slide");else{$galleryType.removeClass("first-slide");var humanReadableSlidePosition=module.currentSlide+1;window.location.hash=module.hashProto+humanReadableSlidePosition}$galleryType.hasClass("num-descend")?$(".slide-num").text(numSlides-module.currentSlide):$galleryType.hasClass("num-ascend")&&$(".slide-num").text(module.currentSlide),$(".current-page").text(module.currentSlide+1),$(".total-pages").text(payload.length);var output=Mustache.to_html(module.template,payload[module.currentSlide]);$(".story-mod .gallery-slides").html(output);var nextSlide=payload[module.currentSlide+1]?module.currentSlide+1:0,nextSlideHead=payload[nextSlide].slide_head;$("#next-slide-headline").text(nextSlideHead),clickAds.loaded&&clickAds.startRefresh(),clickAds.loaded=!0}else if($galleryType.hasClass("scrolling-gallery")){var slidesWithAds=scrollAds.merge(payload),output=Mustache.to_html(module.template,slidesWithAds);$(".story-mod .gallery-slides").html(output),scrollAds.show()}}var module={};module.template=$("#gallery_template").html(),module.previewTemplate=$("#gallery_preview").html(),module.currentSlide=0,module.galleryType=null,module.hash=window.location.hash.trim(),module.hashProto="#slide-",module.omniture=bcom.util.saveSVars(s),module.firstFire=!0,module.init=function(payload){if(0!==payload.length){module.hash&&module.hash.indexOf(module.hashProto)>-1&&(module.currentSlide=parseInt(module.hash.substring(module.hashProto.length),10)-1);var $galleryType=$(".gallery-type");module.galleryType=$galleryType.hasClass("image-focused-gallery")?"image-focused":$galleryType.hasClass("text-focused-gallery")?"text-focused":"split-focused",$(document).on("click",".preview-trigger",function(e){e.preventDefault();var that=this;$.magnificPopup.open({type:"inline",mainClass:"mfp-zoom-in",removalDelay:200,items:[{src:that.hash,el:that}],callbacks:{beforeOpen:function(){var output=Mustache.to_html(module.previewTemplate,payload);$("#mfp-gallery-preview .gallery-slides").html(output)},open:function(){s=s_gi("nytbglobe,nytbgglobal"),s.pageName=s.pageName+" | Modal preview",s.prop6=s.prop6+" | Modal preview",s.t(),bcom.util.resetSVars(module.omniture),s=s_gi("nytbglobe"),"image-focused"===module.galleryType&&s.tl(this,"o","Image_Gallery_Preview_Button"),"text-focused"===module.galleryType&&s.tl(this,"o","Text_Gallery_Preview_Button"),"split-focused"===module.galleryType&&s.tl(this,"o","Split_Gallery_Preview_Button")},close:function(){}},midClick:!0}),$(document).on("click","#mfp-gallery-preview .gallery-img-link",function(e){if(e.preventDefault(),$(".gallery-type").hasClass("click-gallery"))module.currentSlide=parseInt(e.currentTarget.dataset.imageId,10),redrawSlides();else{var position=$("#gallery-slide-"+e.currentTarget.dataset.imageId).offset().top;$("html, body").animate({scrollTop:position-80},1e3)}var s=s_gi("nytbglobe");s.tl(this,"o","Gallery_Modal_Preview_Image_Click"),$.magnificPopup.close()})}),$(document).on("mouseenter",".swiper-mod, .gallery-body-mod",function(){$(this).addClass("is-hovering")}).on("mouseleave",".swiper-mod, .gallery-body-mod",function(){$(this).removeClass("is-hovering")});var keyObj={49:function(){$(".gallery-type").addClass("image-focused-gallery").removeClass("split-focused-gallery").removeClass("text-focused-gallery")},50:function(){$(".gallery-type").removeClass("image-focused-gallery").addClass("split-focused-gallery").removeClass("text-focused-gallery")},51:function(){$(".gallery-type").removeClass("image-focused-gallery").removeClass("split-focused-gallery").addClass("text-focused-gallery")},52:function(){$(".gallery-type").removeClass("click-gallery").addClass("scrolling-gallery"),redrawSlides()},53:function(){$(".gallery-type").addClass("click-gallery").removeClass("scrolling-gallery"),redrawSlides()},37:function(){module.currentSlide--,redrawSlides()},39:function(){module.currentSlide++,redrawSlides()}};if($(document).on("keydown",function(e){$.inArray(e.which+"",Object.keys(keyObj))>=0&&keyObj[e.which]()}),"undefined"!=typeof Hammer){var imgNav=$(".gallery-wrapper");new Hammer(imgNav).on("swipeleft",function(){module.currentSlide++,redrawSlides()}),new Hammer(imgNav).on("swiperight",function(){module.currentSlide--,redrawSlides()})}$(document).on("click",".prev-btn, .swiper-prev",function(e){e.preventDefault(),0==module.currentSlide&&(module.currentSlide=payload.length),module.currentSlide--,redrawSlides()}),$(document).on("click",".next-btn, .swiper-next",function(e){e.preventDefault(),module.currentSlide==payload.length-1&&(module.currentSlide=-1),module.currentSlide++,redrawSlides()}),$(".gallery-wrapper").length&&redrawSlides(),$(window).width()<600&&$(".gallery-type").hasClass("click-gallery")&&($(".gallery-type").removeClass("click-gallery").addClass("scrolling-gallery scrolling-gallery-fix"),redrawSlides()),$(window).resize(function(){$(window).width()<600?$(".gallery-type").hasClass("click-gallery")&&($(".gallery-type").removeClass("click-gallery").addClass("scrolling-gallery scrolling-gallery-fix"),redrawSlides()):$(".gallery-type").hasClass("scrolling-gallery-fix")&&($(".gallery-type").addClass("click-gallery").removeClass("scrolling-gallery scrolling-gallery-fix"),redrawSlides())}),module.firstFire=!1}};var clickAds={loaded:!1,catalog:["ad_lead1","ad_toprightslot"],refresh:function(){var definitionArray=[],currentBreakPoint=bcom.util.getCurrentBreakPoint();$.each(clickAds.catalog,function(i,adName){bcom.dfp.refreshingAds[adName]&&bcom.dfp.refreshingAds[adName].adDefinition&&definitionArray.push(bcom.dfp.refreshingAds[adName].adDefinition)}),definitionArray.length>0&&googletag.cmd.push(function(){googletag.pubads().setTargeting("breakpoint",currentBreakPoint),googletag.pubads().refresh(definitionArray)})}};clickAds.startRefresh=_.debounce(clickAds.refresh,bcom.dfp.refreshRate);var scrollAds={max:20,count:0,displayed:!1,allAds:[],merge:function(slides){for(var slidesWithAds=[],i=0;i<slides.length;i++){if(i>0&&i%bcom.dfp.galleryCount===0&&scrollAds.count<scrollAds.max){scrollAds.count++;var adObject={adName:"ad_gallery"+scrollAds.count,adSize:[[300,250]],pos:["atf","gallery"+scrollAds.count]};scrollAds.allAds.push(adObject),slidesWithAds.push(adObject)}slidesWithAds.push(slides[i])}return slidesWithAds},show:function(){scrollAds.displayed||(scrollAds.define(),scrollAds.display())},define:function(){var networkCode=bcom.dfp.networkCode,adUnit=bcom.dfp.adUnit;$.each(scrollAds.allAds,function(i,adObject){googletag.cmd.push(function(){adObject.adDefinition=googletag.defineSlot("/"+networkCode+"/"+adUnit,adObject.adSize,adObject.adName).addService(googletag.pubads()).setTargeting("pos",adObject.pos)})})},display:function(){var currentBreakPoint=bcom.util.getCurrentBreakPoint();googletag.cmd.push(function(){$.each(scrollAds.allAds,function(i,adObject){googletag.pubads().setTargeting("breakpoint",currentBreakPoint),googletag.display(adObject.adName)})}),scrollAds.displayed=!0}};return module}(),$(function(){$(".gallery-wrapper").length>0&&"undefined"!=payload&&bcom.galleries.init(payload)});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.simple-galleries.js", e)}};

// Source: /js/bcom.carousel.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.carousel=function(){"use strict";var that=this,module={};return module.currentSlide=0,module.init=function(){if($(".swiper-mod").on("mouseenter",function(){$(".lead-tz-mod").addClass("is-hovering")}).on("mouseleave",function(){$(".lead-tz-mod").removeClass("is-hovering")}),"undefined"!=typeof Swiper){var leadSwiper=new Swiper(".swiper-mod",{mode:"horizontal",speed:300,loop:!0,calculateHeight:!0,onSlideClick:function(){that.isVideoCheck(leadSwiper.clickedSlide)},noSwiping:function(){return $(window).width()<768?!0:!1}}),leadTimeout=0;$(".swiper-prev").click(function(){leadSwiper.swipePrev()}),$(".swiper-next").click(function(){leadSwiper.swipeNext()}),$(".lead-nav-item").on("mouseenter",function(){var index=$(".lead-nav-item").index(this);leadTimeout=setTimeout(function(){leadSwiper.swipeTo(index)},300)}).on("mouseleave",function(){clearTimeout(leadTimeout)})}$(".swiper-prev").on("click",function(e){e.preventDefault(),module.currentSlide--}),$(".swiper-next").on("click",function(e){e.preventDefault(),module.currentSlide++})},module.isVideoCheck=function(clickedSlide){var $clickedSlide=$(clickedSlide),dataset=$clickedSlide.context.dataset;"true"===dataset.video&&""!=dataset.videoID&&($(".lead-tz-mod:visible")&&$(".lead-tz-mod").slideUp(),BCL.addPlayer(dataset.videoID))},module}(),$(function(){$(".swiper-mod").length>0&&bcom.carousel.init()});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.carousel.js", e)}};

// Source: /js/bcom.user.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.user=function(){"use strict";var module={};module.init=function(){module.data={imageUrl:"//p.o0bc.com/rw/SysConfig/WebPortal/BDC/Framework/img/user-blank.jpg",is_logged_in:!1,notifications:{}},populateData().always(render),updatePathUrl()};var populateData=function(){var pathAuth=bcom.util.getCookie("pathAuth");return pathAuth?(module.data.is_logged_in=!0,module.data.has_screen_name=!1,$.ajax({type:"GET",url:"/ugc/users/regiauthtoken/"+pathAuth,dataType:"json"}).done(function(response){for(var attr in response)module.data[attr]=response[attr];if(module.data.has_screen_name=!0,module.data.notifications.supported=!1,module.data.notifications.supported){var ls_notifications_state=localStorage.getItem("notifications"),enabled="enabled"==ls_notifications_state;module.data.notifications.enabled=enabled}})):$.Deferred().resolve()},render=function(){var profileTemplate=document.getElementById("nav-profile-mustache").innerHTML,navAvatarTemplate=document.getElementById("nav-avatar-mustache").innerHTML,profileOutput=Mustache.render(profileTemplate,module.data),navAvatarOutput=Mustache.render(navAvatarTemplate,module.data);$("body").append(profileOutput),$("#trigger-avatar-profile").html(navAvatarOutput)},updatePathUrl=function(){bcom.util.setCookie("pathUrl",document.location.href)};return module}(),$(function(){bcom.user.init()});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.user.js", e)}};

// Source: /js/bcom.videoplayer.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.videoPlayer={},$(function(){function init_brightcove(options){if(!$.isReady&&$.browser.msie&&$.browser.version<8)return!1;var $el=$(this),that=this,width=$el.parent().width(),height=Math.round(.56*width);options.params.width=width,options.params.height=height,$el.data("autoplay")===!0&&(options.params.autoStart=!0),bcom.util.getScripts(["https://sadmin.brightcove.com/js/BrightcoveExperiences.js"],function(){var id="myExperience"+ ++brightcove_player_id,obj=$("<object/>").attr("id",id).addClass(options.className).get(0);$.each(options.params,function(name,value){var param=$("<param/>").attr("name",name.toString().replace(/"/g,"&quot;")).attr("value",value.toString().replace(/"/g,"&quot;")).get(0);obj.appendChild(param)}),that.html(obj),brightcove.createExperiences()})}function init_ndn(options){addVideoVendorScript("http://launch.newsinc.com/js/embed.js",options.build_mode,!0)}function init_cinesport(options){var $el=$(this),videoID=$el.data("videoId"),width=$el.parent().width(),autoPlay=$el.data("autoplay"),height=Math.round(.56*width);autoPlay=autoPlay===!1?"":"autostart=on;";var $frame=$('<iframe name="csprt" frameborder="0" align="top,left" marginheight="0" marginwidth="0" scrolling="no"></iframe>'),src="http://cinesport.boston.com/inline/"+videoID+"/#"+autoPlay+"nologo;social=off";$frame.attr("src",src).attr("width",width).attr("height",height),this.html($frame),addVideoVendorScript("http://edgecdn.cinesport.com/container.js",options.build_mode,!0)}function init_perform(options){var divId=$(this).attr("id"),playerId=$(this).data("player-id"),channelId=$(this).data("channel-id"),videoId=$(this).data("video-id");addVideoVendorScript(["http://static.eplayer.performgroup.com/flash/js/swfobject.js","http://static.eplayer.performgroup.com/flash/js/performgroup.js"],options.build_mode,!1),players_loaded[options.build_mode]>1?addResponsivePlayer(playerId,channelId,videoId,divId,"eplayer41",{autoHide:!0,age:1385051870805}):setTimeout(function(){addResponsivePlayer(playerId,channelId,videoId,divId,"eplayer41",{autoHide:!0,age:1385051870805})},3e3)}function init_ustream(){var $that=$(this),videoId=$that.attr("id");$("<iframe>").attr("src","http://www.ustream.tv/embed/"+videoId+"?v=3&wmode=direct").appendTo($that)}function init_nesn(options){var $el=$(this),videoId=($el.attr("id"),$el.data("videoId")),videoType=$el.data("videoType"),playerType=$el.data("playerType");addVideoVendorScript("http://www.springboardplatform.com/js/overlay",options.build_mode,!1),$('<iframe id="'+playerType+"_"+videoId+'" src="http://cms.springboardplatform.com/embed_iframe/899/'+videoType+"/"+videoId+"/"+playerType+'/nesn.com/10" width="100%" height="100%" frameborder="0" scrolling="no">').appendTo($(this))}function addVideoVendorScript(vendorSrc,build_mode){if(players_loaded[build_mode]>0)return!1;for("string"==typeof vendorSrc&&(vendorSrc=[vendorSrc]),i=0;i<vendorSrc.length;i++)bcom.util.addScriptToHead(vendorSrc[i]);players_loaded[build_mode]++}function initVideoPlugin(){document.domain=document.domain,$.fn.videoPlayer=function(opts){return this.each(function(){var data,widget=$(this),child=widget.children().eq(0),rev=(child.attr("style")||"",widget.attr("data-schema")||1),type=widget.attr("data-player")||default_type,defaults=[{reload:!1}],settings=$.extend(defaults,opts);options=$.extend({},{params:deparam(widget.attr("data-params")||""),flashvars:deparam(widget.attr("data-flashvars")||""),attributes:deparam(widget.attr("data-attributes")||"")},deparam(widget.attr("data-options")||"")),widget.data("videoPlayer",data=widget.data("videoPlayer")||{}),(!data.ready||settings.reload)&&($.each(schemas,function(i,v){return defaults[i]=v,rev-1>i}),defaults=$.extend.apply(null,[{}].concat(defaults)),options=$.extend(!0,{},defaults._default,defaults[type],options,opts),function revive(obj){var k,v;for(k in obj)v=obj[k],"[object Object]"===Object.prototype.toString.call(v)?revive(v):$.isFunction(v)&&"_init"!==k&&(obj[k]=v(options))}(options),$.isFunction(options._init)&&(data.ready=options._init.call(widget,options)!==!1))})}}var brightcove_player_id=0,players_loaded={brightcove:0,ndn:0,cinesport:0,perform:0,ustream:0,nesn:0},default_type="article",schemas=($(".inner").width()||674,[{_default:{build_mode:"brightcove",_init:init_brightcove,className:"BrightcoveExperience",params:{wmode:"transparent",bgcolor:"#FFFFFF",publisherID:"245991542",isVid:"true",isUI:"true",dynamicStreaming:"true",includeAPI:"true",templateReadyHandler:"bcom.videoPlayer.video.templateReady",adServerURL:function(){var baseUrl=(window.location,"http://pubads.g.doubleclick.net/gampad/ads?"),buildCustomParams=function(){var keyValuePairs=bcom.dfp.keyValuePairs,customParamString="pos=preroll&";for(var key in keyValuePairs)customParamString+=key+"="+keyValuePairs[key]+"&";return encodeURIComponent(customParamString.slice(0,customParamString.length-1))},additionalParams=["env=vp","&gdfp_req=1","&impl=s","&output=xml_vast2","&cmsid=5699","&iu="+bcom.dfp.networkCode+"/"+bcom.dfp.adUnit,"&sz=640x480","&unviewed_position_start=1","&description_url="+encodeURIComponent("http://boston.com"),"&cust_params="+buildCustomParams(),"&ciu_szs=300x250"].join("");return baseUrl+additionalParams}}},article:{params:{playerID:"2080955193001",autoStart:!1}},articleNoTremorAds:{params:{playerID:"2148987492001",autoStart:!1}},multiclip:{params:{playerID:"2253104600001",playerKey:"AQ~~,AAAAAA6piHY~,DqRT40XOAr8TkujSe-QpRyR1KRT5m7dL"}}},{_default:{_init:init_ndn,build_mode:"ndn",freewheel:90106,section:"boston.com"},clicktoplay:{wid:2},autoplay:{wid:1}},{_default:{build_mode:"cinesport",_init:init_cinesport}},{_default:{build_mode:"perform",_init:init_perform}},{_default:{build_mode:"ustream",_init:init_ustream}},{_default:{build_mode:"nesn",_init:init_nesn}}]);bcom.videoPlayer={video:{players:{},templateReady:function(event){!event||!event.target||!event.target.experience;var experienceID=event.target.experience.id;bcom.videoPlayer.video.players[experienceID]||(bcom.videoPlayer.video.players[experienceID]=BcomVideoPlayer(),bcom.videoPlayer.video.players[experienceID].init(experienceID))},init:function(){initVideoPlugin(),$(".videoplayer").videoPlayer()}}}});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.videoplayer.js", e)}};

// Source: /js/bcom.mustreads.js
try{
$(".must-reads .mr-btn").click(function(e){if(e.preventDefault(),$(".must-reads").toggleClass("mr-open"),$(".must-reads").hasClass("mr-open")){$(".mr-btn").text("Show Fewer"),$(".must-reads").removeClass("mr-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Must Reads - Show all"),bcom.util.clearSVars(s)}else{$(".mr-btn").text("Show All"),$(".must-reads").addClass("mr-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Must Reads - Show fewer"),bcom.util.clearSVars(s)}}),$(".event-listings .event-btn").click(function(e){if(e.preventDefault(),$(".event-listings").toggleClass("event-open"),$(".event-listings").hasClass("event-open")){$(".event-btn").text("Show Fewer"),$(".event-listings").removeClass("event-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Must Reads - Show all"),bcom.util.clearSVars(s)}else{$(".event-btn").text("Show All"),$(".event-listings").addClass("event-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Event Listings - Show fewer"),bcom.util.clearSVars(s)}});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.mustreads.js", e)}};

// Source: /js/bcom.trending.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.trending=function(){"use strict";function getTrending(){$.ajax({url:url}).done(function(data){var rendered=Mustache.render(template,data);$(".trending-list").html(rendered).addClass("rendered")})}var template=$("#trending-item").html(),url="http://r.qaedit.boston.com/partners/chartbeat/chartbeat.json",module={};module.init=function(){return 0===$(".trending").length?!1:(Mustache.parse(template),getTrending(),void $(".trending .trending-btn").click(function(e){if(e.preventDefault(),$(".trending").toggleClass("trending-open"),$(".trending").hasClass("trending-open")){$(".trending-btn").text("Show Fewer"),$(".trending").removeClass("trending-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Trending - Show all"),bcom.util.clearSVars(s)}else{$(".trending-btn").text("Show All"),$(".trending").addClass("trending-closed");var s=s_gi("nytbglobe");s.tl(this,"o","Trending - Show fewer"),bcom.util.clearSVars(s)}}))},module.init()}();
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.trending.js", e)}};

// Source: /js/bcom.share.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.share={defaultShareValues:{headline:"",shorturl:"",canonical:"",thumbnail:"",providers:""},emailFailCount:0,setupShareBox:function(data){$("#mfp-share li.share-icon").hide(),$("#mfp-share .title").html(data.headline),$("#mfp-share .copy-txt-link").text(data.shorturl),this.shareValues=_.clone(this.defaultShareValues);for(var providers=this.getNetworks(data.providers),i=0;i<providers.length;i++){var provider=providers[i];$("#mfp-share li.share-icon."+provider).show()}this.shareValues.headline=data.headline,this.shareValues.shorturl=data.shorturl,this.shareValues.canonical=data.canonical,this.shareValues.thumbnail=data.thumbnail,this.shareValues.providers=data.providers},gigyaEmailSumbitCallback:function(){},socialShare:function(e){var params={provider:e.currentTarget.dataset.provider,url:this.shareValues.canonical,title:this.shareValues.headline,thumbnailURL:this.shareValues.thumbnail};gigya.socialize.postBookmark(params)},getNetworks:function(data){return data?data.split(","):["facebook","twitter","googleplus","pinterest","linkedin","email"]},emailSubmit:function(formData){$("label.error").fadeOut("fast");var senderValid=this.checkEmailField(formData.your_email,!1),recipientValid=this.checkEmailField(formData.recipient_email,!0);if(senderValid===!1||recipientValid===!1)return senderValid===!1&&$('label[for="your_email"].error').fadeIn(),recipientValid===!1&&$('label[for="recipient_email"].error').fadeIn(),!1;var dataString="sender_name=&sender_email="+formData.your_email+"&recipient_email="+formData.recipient_email+"&message="+formData.share_message+"&story_url="+encodeURIComponent(this.shareValues.canonical);return $.ajax({type:"POST",url:"/emtaf/",data:dataString,async:!1,success:this.emailSuccess,error:this.emailError(formData)}),!1},checkEmailField:function(emailField,allowMultipleAddresses){var fieldValid=!0;if(allowMultipleAddresses){var emailAddresses=emailField.split(/ *, */);$.each(emailAddresses,function(k,emailAddress){bcom.share.isValidEmailAddress(emailAddress)===!1&&(fieldValid=!1)})}else bcom.share.isValidEmailAddress(emailField)===!1&&(fieldValid=!1);return fieldValid},isValidEmailAddress:function(emailAddress){var emailRegexStr=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return emailRegexStr.test(emailAddress)},resetRecipientEmailField:function(recipientEmailField){recipientEmailField.attr("defaultValue")===recipientEmailField.val()&&recipientEmailField.val("")},emailError:function(formData){return bcom.share.emailFailCount<2?(bcom.share.emailFailCount++,void bcom.share.emailSubmit(formData)):(bcom.share.showResponse("Message not sent."),bcom.share.hideResponse(),!1)},emailSuccess:function(){bcom.share.emailFailCount=0,bcom.share.showResponse("E-mail Success!"),bcom.share.hideResponse()},showEtafBox:function(){$("#mfp-share .share-message").slideDown(500),$("#mfp-share .share-icon-list").slideUp(500)},hideEtafBox:function(e){e.preventDefault(),$(".share-message").slideUp(500),$(".share-icon-list").slideDown(500),$("#mfp-share .email-share").hide(),$("#mfp-share .char-count").removeClass("length-warning")},hideResponse:function(){window.setTimeout(function(){$.magnificPopup.close()},5e3)},showResponse:function(statusMsg){$.magnificPopup.open({items:{src:'<div class="share-mod success"><p class="txt-lg">'+statusMsg+"</p></div>"},type:"inline",mainClass:"mfp-zoom-in",removalDelay:500,alignTop:!0})},checkShareCommentLength:function(){var $target=$("#mfp-share .char-count"),$textarea=$("#mfp-share .share-message-textarea"),textlength=$textarea.val().length,charLimit=($('#mfp-share input[name="provider"]').val(),140);$target.text(textlength),textlength>charLimit?$target.addClass("length-warning"):$target.removeClass("length-warning")}},$(function(){$(".share-icon-link").on("click",function(e){"email"!=e.currentTarget.dataset.provider?bcom.share.socialShare(e):bcom.share.showEtafBox()}),$(" .l-story-txt-share .social-btn").on("click",function(e){var gigyaParams={provider:e.currentTarget.dataset.provider,url:e.currentTarget.dataset.canonical,title:e.currentTarget.dataset.headline,thumbnailURL:e.currentTarget.dataset.thumbnail};gigya.socialize.postBookmark(gigyaParams)}),$("form.share-form .cancel-link").on("click",function(e){bcom.share.hideEtafBox(e)}),$("form.share-form").on("submit",function(e){e.preventDefault(),bcom.share.emailSubmit($(this).serializeObject())}),$(document).on("click",".popup-trigger",function(e){e.preventDefault();var originalYPos=e.pageY,that=this;$.magnificPopup.open({type:"inline",mainClass:"mfp-zoom-in",removalDelay:500,alignTop:!0,fixedContentPos:!0,closeOnBgClick:!1,closeOnContentClick:!1,items:[{src:that.hash,el:that}],callbacks:{beforeOpen:function(){bcom.share.setupShareBox(that.dataset)},open:function(){window.scrollTo(0,0)},beforeClose:function(){var adjustedYPos=originalYPos;window.scrollTo(0,adjustedYPos-300)},close:function(){$("#mfp-share li.share-icon, .share-message, .email-share").hide(),$("#mfp-share .title, #mfp-share .copy-txt-link").empty(),$(".share-icon-list").show(),bcom.share.emailFailCount=0}},midClick:!0})})});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.share.js", e)}};

// Source: /js/bcom.stream-scoreboard.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.streamscoreboard=function(el,league,gameCode){var template=$("#stream-scoreboard-mustache").html(),domain=location.protocol+"//"+location.host;Mustache.parse(template);var url=domain+"/partners/stats/"+league+"/"+gameCode+".txt";$.ajax({url:url,dataType:"json"}).done(function(data){data.sport=league,data.segment_number="0"!=data.segment_number?bcom.util.getOrdinal(data.segment_number):void 0;var rendered=Mustache.render(template,data);el.html(rendered).addClass("rendered")}).fail(function(){}).always(function(){})};
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.stream-scoreboard.js", e)}};

// Source: /js/bcom.wishabi.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.wishabi=function(){"use strict";function getFlyers(flyerId,$el){var wishabiTemplate=$("#wishabi_flyer").html();$.ajax({url:apiHost+apiPath,data:{mtypeid:flyerId,key:vendorKey,t:(new Date).getTime()},crossDomain:!0,dataType:"jsonp"}).done(function(data){var output=Mustache.to_html(wishabiTemplate,data);$el.html(output).addClass("rendered")})}var module={},apiHost="http://api.flyertown.ca",apiPath="/flyermodules",vendorKey="5e30bf9636f28066";return module.init=function(){$(".wishabi").not(".rendered").each(function(){var $el=$(this),flyerId=$el.data("wishabi-id");getFlyers(flyerId,$el)})},module}(),$(function(){$(".wishabi").length>0&&bcom.wishabi.init()});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.wishabi.js", e)}};

// Source: /js/bcom.omniclick.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.omniclick=function(){"use strict";var section="",module={};module.init=function(){omnitureSectionForTracking&&(section=omnitureSectionForTracking+" | "),$(document).on("click",".omniclick",function(e){e.preventDefault();var s=s_gi("nytbglobe");s.tl(e.currentTarget,"o",section+e.currentTarget.getAttribute("data-omniclick")),window.location.href=e.currentTarget.href}),$(document).on("click",".omnibutton",function(e){var s=s_gi("nytbglobe");s.tl(e.currentTarget,"o",section+e.currentTarget.getAttribute("data-omniclick"))}),$(document).on("click",".omnistack",function(e){e.preventDefault();var s=s_gi("nytbglobe");s.tl(e.currentTarget,"o",section+e.currentTarget.getAttribute("data-omniclick")),window.location.href=e.currentTarget.href})},module.init()}();
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.omniclick.js", e)}};

// Source: /js/bcom.comments.js
try{
!function(win,$,methode){$.ajaxSetup({cache:!1});var loc=(win.document,win.location),hash=loc.hash,ugc=ugc||{};ugc.endpoints=function(){var isMTMobile=loc.href.indexOf("mobile.html")>0,base=isMTMobile?"/bdc-ugc/":"/ugc/";return{user:base+"users/",topic:base+"topics/",ia:base+"interactions/",commentsHtml:isMTMobile?"/bdc-ugc/ajax/comments.html":"/ajax/comments.html"}}(),methode=methode||{},ugc.init=function(){$("#comments").length&&("#comments"===hash&&(ugc.pageUI.loadCommentsFlag=!0,ugc.pageUI.commentsOpen=!0),hash.indexOf("#comment-")>=0&&(ugc.pageUI.loadCommentsFlag=!0,ugc.pageUI.commentsOpen=!0,ugc.comments.ia=hash.split("-")[1]),ugc.pageUI.init(),ugc.comments.init())},ugc.forms={clearForm:function($form){$form.trigger("reset"),$("#image-url").length&&""!==$("#image-url").val()&&this.removePhoto()},checkForm:function($form){var message='<div class="required-message">Please enter a comment.</div>',missingCount=0,requiredInputs=$form.find('[data-required="true"]'),overWordCount=!1,overWordCountBy=0;return overWordCount?(alert("You are over the permitted word count by "+overWordCountBy+" words. Please edit your submission and re-submit."),!1):($.each(requiredInputs,function(){""===$(this).val()&&missingCount++}),missingCount>0?($(".required-message").length||$form.parent().append(message),!1):($(".required-message").length&&$(".required-message").remove(),!0))}},ugc.actions={createIa:function(actionObj,silent){return silent=silent||!1,this.ajaxCall("POST",ugc.endpoints.ia,actionObj,silent)},modifyIa:function(actionId,actionObj,silent){return this.ajaxCall("PATCH",ugc.endpoints.ia+actionId,actionObj,silent)},modifyUser:function(userId,actionObj,silent){return this.ajaxCall("PATCH",ugc.endpoints.user+userId,actionObj,silent)},streamComment:function(commentId){$.getJSON(ugc.endpoints.ia+commentId,function(c){var infoPathData,streamData={method:"create",model:{id:c.id,is_comment:!0,comment:{total:$("#comments-wrapper").attr("data-comment-count"),user:{profile:c.actingUserProfileUrl,name:c.actingUserName,avatar:c.actingUserImageUrl}},head:c.topicTitle,body:c.body,url:c.topicUrl}};infoPathData=ugc.util.isMovableTypeId(ugc.comments.uuid)?{source:"Movable Type",id:ugc.comments.uuid}:{uuid:ugc.comments.uuid},$.ajax({url:methode.infoPath,dataType:"json",async:!1,data:infoPathData,success:function(info){streamData.model.streams=info.streams,streamData.model.section=info.section}}),$.ajax({type:"POST",url:methode.streamSubmitPath,contentType:"application/json",processData:!1,data:JSON.stringify(streamData)})})},ajaxCall:function(type,url,data,silent){var dataType=url.match(".html")?"html":"json";return silent||ugc.util.statusMessage("action"),$.ajax({type:type,url:url,data:JSON.stringify(data),dataType:dataType,contentType:"application/json",xhr:function(){return null==window.XMLHttpRequest||null==(new window.XMLHttpRequest).addEventListener?new window.ActiveXObject("Microsoft.XMLHTTP"):$.ajaxSettings.xhr()}}).done(function(){silent||ugc.util.statusMessage("success")}).fail(function(jqXHR){403===jqXHR.status?($(".status-message").remove(),alert(jqXHR.responseText)):silent||ugc.util.statusMessage("error")})}},ugc.comments={topicId:!1,uuid:!1,commentCount:0,pageType:"comments",sortOrder:"OLDEST_CREATE_DT",page:1,limit:25,ia:!1,init:function(){return"undefined"!=typeof topicId&&(ugc.comments.topicId=topicId),"undefined"!=typeof methode.uuid&&(ugc.comments.uuid=methode.uuid),"undefined"!=typeof pluckID&&(ugc.comments.uuid=pluckID),ugc.comments.topicId?void ugc.comments.fetchComments():(ugc.comments.uuid&&ugc.comments.fetchTopicId(ugc.comments.uuid).success(function(topicData){topicData.total>0?(ugc.comments.topicId=topicData.topics[0].id,ugc.comments.fetchComments()):ugc.comments.createTopic(ugc.comments.uuid).success(function(topicData){ugc.comments.topicId=topicData.id,ugc.comments.fetchComments()})}),void ugc.comments.eventHandlers())},eventHandlers:function(){$(document).on("click",".more-replies a",function(event){event.preventDefault(),ugc.comments.toggleReplies($(this))}),$(document).on("click",".comment-filter",function(event){event.preventDefault(),ugc.comments.page=1,ugc.comments.sortComments($(this))}),$(document).on("click",".comment-permalink",function(event){event.preventDefault();var hash=$(this).attr("href");loc.hash=hash,ugc.pageUI.goToEl(hash,!0)}),$(document).on("click",".pagination a",function(event){event.preventDefault(),ugc.comments.paginateComments($(this))}),$(document).on("click",".user-action",function(event){event.preventDefault(),event.stopPropagation(),ugc.comments.userAction($(this))}),$(document).on("click",".expandable-form",function(){$(this).addClass("expandable-form-active")}),$(document).on("submit",".add-comment-form",function(event){event.preventDefault(),ugc.comments.submitComment($(this))}),$(document).on("click",".cancel",function(event){event.preventDefault(),$(".user-form").remove()}),$(document).on("click",".admin-action",function(event){event.preventDefault(),event.stopPropagation(),ugc.comments.adminAction($(this))}),$(document).on("click",".close-modal",function(event){event.preventDefault(),$(".ugc-modal").remove()})},userAction:function($el){var elData=$el.data();"reply"===elData.actionType&&this.submitReply(elData.actionId),"report"===elData.actionType&&this.abuseReport(elData.actionId),"like-dislike"===elData.actionType&&this.likeDislike(elData.actionId,elData.property,$el)},fetchTopicId:function(id){var url=ugc.endpoints.topic+"?cmsUuid="+id;return ugc.actions.ajaxCall("GET",url,{},!0)},createTopic:function(id){var url="/ugc/topics",createObj={cmsUuid:id,site:"BCOM",title:$("title").text(),type:"ARTICLE"};return ugc.actions.ajaxCall("POST",url,createObj,!0)},commentsUrl:function(){var url=[ugc.endpoints.commentsHtml+"?topic="+ugc.comments.topicId,"&sort="+ugc.comments.sortOrder,"&page="+ugc.comments.page];return ugc.comments.ia&&url.push("&comment="+ugc.comments.ia),ugc.pageUI.loadCommentsFlag||url.push("&noComments=true"),url.join("")},fetchComments:function(){return ugc.actions.ajaxCall("GET",ugc.comments.commentsUrl(),{},!0).success(function(comments){$("#comments-wrapper").replaceWith(comments).remove(),ugc.comments.count=$(".ugc.comments-wrapper").data().commentCount,ugc.comments.updateCommentCounts(),ugc.pageUI.updateUI(ugc.pageUI.loadCommentsFlag)})},sortComments:function($el){ugc.comments.ia=!1,ugc.comments.sortOrder=$el.data().sort,ugc.comments.fetchComments()},paginateComments:function($el){ugc.comments.ia=!1,ugc.comments.page=$el.data().page,ugc.comments.fetchComments(!0)},submitComment:function($form){var actionObj=$form.serializeObject();ugc.forms.checkForm($form)&&ugc.actions.createIa(actionObj).success(function(comment){ugc.pageUI.loadCommentsFlag=!0,ugc.pageUI.commentsOpen=!0,ugc.comments.ia=comment.id,ugc.forms.clearForm($form),loc.hash="comment-"+ugc.comments.ia,ugc.comments.fetchComments()})},updateCommentCounts:function(){$(".total-comment-count").text(ugc.comments.count)},submitReply:function(actionId){$(".user-form").remove();var $formWrapper=ugc.templates.commentReply(actionId);$formWrapper.insertAfter($("#comment-"+actionId+" > .comment-holder")),$formWrapper.find("form").on("submit",function(event){event.preventDefault();var actionObj=$(this).serializeObject();ugc.forms.checkForm($(this))&&ugc.actions.createIa(actionObj).success(function(reply){$(".user-form").remove(),loc.hash="comment-"+reply.id,ugc.comments.getReplies(actionId,$("#comment-"+actionId+" .more-replies a")),ugc.pageUI.goToEl("#comment-"+actionId),ugc.comments.count++,ugc.comments.updateCommentCounts()})})},cancelReply:function(){$(".cancel-reply").on("click",function(event){event.preventDefault(),$(".new-reply").remove(),$(this).unbind()})},likeDislike:function(actionId,property,$el){var actionObj={};actionObj.parentKey=actionId,actionObj.type="likes"===property?"LIKE_ARTICLE_COMMENT":"DISLIKE_ARTICLE_COMMENT",ugc.actions.createIa(actionObj,!0).success(function(){var $countSpan=$el.find(".count"),count=parseInt($countSpan.text(),10);$countSpan.text(++count),$el.toggleClass("voted")})},abuseReport:function(actionId){$(".user-form").remove();var $formWrapper=ugc.templates.commentAbuseReport(actionId);$formWrapper.insertAfter($("#comment-"+actionId+" > .comment-holder")).eq(0),$formWrapper.find("form").on("submit",function(event){event.preventDefault();var actionObj=$(this).serializeObject();ugc.actions.createIa(actionObj),$(".user-form").remove()})},getReplies:function(actionId,$el){var $childrenUl,url=ugc.endpoints.commentsHtml+"?parent="+actionId,$parent=$("#comment-"+actionId),childCount=$parent.attr("data-reply-count");ugc.actions.ajaxCall("GET",url,{},!0).success(function(replies){if(childCount>0){{$("#children-"+actionId)}$("#children-"+actionId).html(replies),childCount>=2&&$el.data({action:"hide"}).text("Hide replies").parent("div").removeClass("show-more").addClass("hide-more")}else $childrenUl=$('<ul class="children comment-reply-list" id="children-'+actionId+'" />').html(replies),$parent.append($childrenUl);childCount++,$parent.attr({"data-reply-count":childCount})})},toggleReplies:function($el){var elData=$el.data();if("show"===elData.action)this.getReplies(elData.actionId,$el);else{var $children=$("#children-"+elData.actionId),childCount=$children.children("li").length;$children.children("li").filter(":gt(1)").remove(),$el.data({action:"show"}).text("View "+parseInt(childCount-2,10)+" Replies").parent("div").removeClass("hide-more").addClass("show-more")}ugc.pageUI.goToEl("#comment-"+elData.actionId)},adminAction:function($el){var elData=$el.data();if("stream"===elData.actionType)return ugc.actions.streamComment(elData.actionId);var $formWrapper=ugc.templates.adminReasonForm(elData.property,elData.value);$formWrapper.appendTo("body").find("form").submit(function(event){event.preventDefault();var uiDataValue,uiDataText,actionObj=$(this).serializeObject();"ia"===elData.actionType&&(ugc.actions.modifyIa(elData.actionId,actionObj),uiDataValue="BLOCKED"===elData.value?"UNMODERATED":"BLOCKED",uiDataText="BLOCKED"===elData.value?"Unblock comment":"Block comment"),"user"===elData.actionType&&(ugc.actions.modifyUser(elData.actionId,actionObj),uiDataValue="true"===elData.value?"false":"true",uiDataText="true"===elData.value?"Unblock user":"Block user"),$(".ugc-modal").remove(),elData.text=uiDataText,elData.value=uiDataValue,$el.data(elData),$el.text(uiDataText)})}},ugc.util={statusMessage:function(type,customMessageText){$(".status-message").remove();var $messageBox=$('<div class="status-message" />'),$message=$('<span class="message" />'),messageText=customMessageText||"";"action"==type&&""===messageText&&(messageText="Sending..."),"success"==type&&""===messageText&&(messageText="Success!"),"error"==type&&""===messageText&&(messageText="There was an error. Please refresh the page and try again."),$message.text(messageText).addClass(type).appendTo($messageBox),$("body").prepend($messageBox),("success"==type||"error"==type)&&window.setTimeout(function(){$messageBox.fadeOut(400,function(){$(this).remove()})},3e3)},getQueryStringValue:function(key){for(var queryStringArray=loc.search.substr(1).split("&"),i=0;i<queryStringArray.length;i++){var keyValueArray=queryStringArray[i].split("=");if(keyValueArray[0]===key)return keyValueArray[1]}return!1},isMovableTypeId:function(id){return/\d+_\d+_\d+/g.test(id)}},ugc.templates={commentReply:function(parent){var commentReply=['<div class="new-reply user-form">','<form action="#" method="post" class="form comment-reply-form" id="comment-reply-form">','<input type="hidden" name="type" value="ARTICLE_COMMENT" />','<input type="hidden" name="parentKey" value="'+parent+'" />','<input type="hidden" name="topicKey" value="'+ugc.comments.topicId+'" />','<div class="form-row">','<label for="textarea">Add to the conversation</label>','<div class="input-mod">','<textarea class="textarea" data-required="true" id="reply-to-'+parent+'" name="body" rows="3" placeholder="Reply to this comment"></textarea>','<input type="submit" class="comment-reply-btn submit-btn" value="Reply" />','<p class="comment-disclaimer txt-sm">Your comment is subject to the rules of our <a class="link" href="/help/posting-rules">Posting Policy</a>.<br>This comment may appear on your public profile. <a class="link" href="/help/faq">Public Profile FAQ</a></p>','<div class="content-disclaimer-abr-mod">','<div class="tz-sponsor-icon content-disclaimer-icon">','<i class="content-disclaimer-abr link-secondary">Privacy Policy</i>','<i class="sponsor-hover-info">Your comment is subject to the rules of our <a class="link" href="#">Posting Policy</a>.<br>This comment may appear on your public profile. <a class="link" href="#">Public Profile FAQ</a></i>',"</div>","</div>","</div>","</div>","</form>","</div>"].join("");return $(commentReply)},commentAbuseReport:function(actionId){var form=['<div class="report-abuse user-form">','<form action="#" class="report-abuse-form">','<input type="hidden" name="parentKey" value="'+actionId+'" />','<div class="form-section">',"<label>Reason for reporting:</label>",'<select name="type" class="demerit-type">','<option value="DEMERIT_OBSCENITY_VULGARITY">Obscenity or vulgarity</option>','<option value="DEMERIT_HATE_SPEECH">Hate speech</option>','<option value="DEMERIT_PERSONAL_ATTACK">Personal attack</option>','<option value="DEMERIT_ADVERTISING_SPAM">Advertising spam</option>','<option value="DEMERIT_COPYRIGHT_PLAGIARISM">Copyright or plagiarism</option>','<option value="DEMERIT_OTHER">Other</option>',"</select>","</div>",'<div class="form-section">','<textarea type="text" id="abuse-textarea" class="add-abuse-comment short" name="body" placeholder="Additional comments (optional)..."></textarea>',"</div>",'<div class="form-section submit">','<input type="submit" class="comment-abuse-btn submit-btn" value="Report" />','<a href="#" class="cancel">Cancel</a>',"</div>","</form>","</div><!-- / .report-abuse -->"].join("");return $(form)},adminReasonForm:function(property,value){var modal=['<div class="ugc-modal">','<form class="admin-reason">','<div class="heading">Reason for this action?<a href="#" class="close-modal" data-action="close">&times;</a></div>','<div class="form-section">','<input type="hidden" name="'+property+'" value="'+value+'" />','<textarea name="adminReason" autofocus></textarea>',"</div>",'<div class="form-section submit">','<input type="submit" value="Submit" class="btn primary"/>',"</div>","</form>","</div>"].join("");return $(modal)}},ugc.pageUI={commentsOpen:!1,loadCommentsFlag:!1,$comments:$("#comments"),headerHeight:$(".main-nav").outerHeight()+30,init:function(){ugc.pageUI.eventHandlers()},eventHandlers:function(){$(".js-goto-open-comments").on("click",function(event){event.preventDefault(),ugc.pageUI.loadCommentsFlag&&!ugc.pageUI.commentsOpen?ugc.pageUI.openComments():ugc.pageUI.loadComments()}),$(document).on("click",".js-toggle-comments",function(event){event.preventDefault(),ugc.pageUI.loadCommentsFlag?ugc.pageUI.toggleComments():ugc.pageUI.loadComments()})},loadComments:function(){ugc.pageUI.loadCommentsFlag=!0,ugc.pageUI.commentsOpen=!0,ugc.comments.fetchComments()},openComments:function(){ugc.pageUI.setOpen(),ugc.pageUI.goToEl("#comments",!1)},toggleComments:function(){ugc.pageUI.commentsOpen=ugc.pageUI.commentsOpen?!1:!0,ugc.pageUI.updateUI()},updateUI:function(loadComments){if(ugc.pageUI.commentsOpen?ugc.pageUI.setOpen():ugc.pageUI.setClosed(),loadComments){var goTo=ugc.comments.ia?"#comment-"+ugc.comments.ia:"#comments",highlight=ugc.comments.ia?!0:!1;ugc.pageUI.goToEl(goTo,highlight)}},setOpen:function(){ugc.pageUI.$comments.addClass("open").removeClass("closed"),$(".view-comments").text("Hide"),loc.hash="#comments"},setClosed:function(){ugc.pageUI.$comments.addClass("closed").removeClass("open"),$(".view-comments").text("View")},goToEl:function(elId,highlight){var $el=$(elId);if($el.length){var elTop=$el.offset().top-ugc.pageUI.headerHeight;$("html, body").animate({scrollTop:elTop},500),highlight&&ugc.pageUI.fadeColorOut($el,"#ebf5fd")}},fadeColorOut:function(element,color){$(element).css("-webkit-transition","all 0.6s ease").css("backgroundColor","#fff").css("-moz-transition","all 0.9s ease").css("-o-transition","all 0.9s ease").css("-ms-transition","all 0.9s ease").css("backgroundColor",color).delay(1500).queue(function(){$(this).css("backgroundColor","#fff"),$(this).dequeue()})}},$(document).ready(function(){ugc.init()})}(this,jQuery,methode),function($,a){$.fn.serializeObject=function(){var b={};return $.each(this.serializeArray(),function(d,e){var f=e.name,c=e.value;b[f]=b[f]===a?c:$.isArray(b[f])?b[f].concat(c):[b[f],c]}),b}}(jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.comments.js", e)}};

// Source: /js/bcom.profiles.js
try{
!function(win,$){$.ajaxSetup({cache:!1});var loc=(win.document,win.location),ugc=ugc||{};ugc.init=function(){ugc.profiles.init()},ugc.forms={clearForm:function($form){$form.trigger("reset"),$("#image-url").length&&""!==$("#image-url").val()&&this.removePhoto()},checkForm:function($form){var message='<div class="required-message">Please fill out all required fields.</div>',missingCount=0,requiredInputs=$form.find('[data-required="true"]'),textareaId=$form.find("textarea").attr("id"),editor=tinymce.get(textareaId);return editor&&editor.overWordCount?(alert("You are over the permitted word count by "+editor.overWordCountBy+" words. Please edit your submission and re-submit."),!1):($form.find(".checkboxes").length&&0===$form.find("input:checked").length&&missingCount++,$.each(requiredInputs,function(){""===$(this).val()&&missingCount++}),missingCount>0?($(".required-message").length||$form.parent().append(message),!1):($(".required-message").length&&$(".required-message").remove(),!0))},tinyMCEInit:function(textareaId,type,wordLimit){tinymce.baseURL="//"+loc.host+"/js/libs/tinymce";var optionsObject={menubar:!1,statusbar:!1,toolbar:!1,browser_spellcheck:!0,invalid_elements:"img",auto_focus:textareaId,plugins:"wordcount paste",paste_as_text:!0,paste_data_images:!1,setup:function(editor){editor.on("PreProcess",function(){editor.overWordCount=!1;var wordCount=editor.plugins.wordcount.getCount();wordCount>wordLimit&&(editor.overWordCount=!0,editor.overWordCountBy=wordCount-wordLimit)})}};"basic"!==type&&(optionsObject.statusbar=!0,optionsObject.auto_focus=!1,optionsObject.toolbar="bold italic underline",optionsObject.toolbar_items_size="small",optionsObject.plugins="wordcount paste");var editor=new tinymce.Editor(textareaId,optionsObject,tinymce.EditorManager);return editor.render(),editor},tinyMCERemove:function(editor){editor.remove()},uploadPhoto:function(){$("#upload-image").modal(),$("#image-target").load(function(){var imageUrl;imageUrl=$("html.oldie").length?$(window.frames.image_target.document.XMLDocument).find("url").text():$("#image-target").contents().find("url").text(),$("#image-url").val(imageUrl),$(".image-preview").attr({src:imageUrl}),$(".add-photo, .submit-photo").toggle(),$("#upload-image").modal("hide")})},removePhoto:function(){$("#image-url").val(""),$(".image-preview").attr({src:""}),$(".add-photo, .submit-photo").toggle()}},ugc.actions={iaEndpoint:"/ugc/interactions/",userEndpoint:"/ugc/users/",ignoreUserEndpoint:"/ugc/ignoreduser/id/",createIa:function(actionObj,silent){return silent=silent||!1,this.ajaxCall("POST",this.iaEndpoint,actionObj,silent)},modifyIa:function(actionId,actionObj,silent){return this.ajaxCall("PATCH",this.iaEndpoint+actionId,actionObj,silent)},modifyUser:function(userId,actionObj,silent){return this.ajaxCall("PATCH",this.userEndpoint+userId,actionObj,silent)},ignoreUser:function(userId,type,silent){return this.ajaxCall(type,this.ignoreUserEndpoint+userId,{},silent)},ajaxCall:function(type,url,data,silent){var dataType="GET"===type?"html":"json";return silent||ugc.util.statusMessage("action"),$.ajax({type:type,url:url,data:JSON.stringify(data),dataType:dataType,contentType:"application/json",xhr:function(){return null==window.XMLHttpRequest||null==(new window.XMLHttpRequest).addEventListener?new window.ActiveXObject("Microsoft.XMLHTTP"):$.ajaxSettings.xhr()}}).done(function(){silent||ugc.util.statusMessage("success")}).fail(function(jqXHR){403===jqXHR.status?($(".status-message").remove(),alert(jqXHR.responseText)):silent||ugc.util.statusMessage("error")})}},ugc.profiles={init:function(){this.eventHandlers()},eventHandlers:function(){$(".user-action").on("click",function(event){event.preventDefault(),ugc.profiles.userAction($(this))}),$("#edit-profile-form").length&&(ugc.aboutMeEditor=ugc.forms.tinyMCEInit("forum-signature","basic"),$("#edit-profile-form").on("submit",function(event){event.preventDefault(),ugc.profiles.editProfile($(this))}),$("#edit-avatar-form").submit(function(event){ugc.profiles.editAvatar(event)}),$("#custom-avatar").change(function(){ugc.profiles.selectAvatar($(this))}),$("#show-stock-avatars").on("click",function(event){event.preventDefault(),ugc.profiles.toggleAvatars($(this))}),$(document).on("click",".avatar-list input",function(){ugc.profiles.setStockAvatar($(this))})),$("#submit-message-form").length&&(ugc.addMessageEditor=ugc.forms.tinyMCEInit("message-body","basic"),$("#submit-message-form").on("submit",function(event){event.preventDefault(),ugc.profiles.sendMessage($(this))})),$(".messages").length&&$(".admin-actions").length&&$(".admin-action").on("click",function(event){event.preventDefault(),ugc.profiles.adminAction($(this))}),$(document).on("click",".close-modal",function(event){event.preventDefault(),$(".ugc-modal").remove()})},editProfile:function($form){ugc.aboutMeEditor.save();var userId=$("#user-id").val(),actionObj=$form.serializeObject();ugc.forms.checkForm($form)&&ugc.actions.modifyUser(userId,actionObj).success(function(){window.location.href=window.location.href})},stockAvatarsLoaded:!1,toggleAvatars:function($el){ugc.profiles.stockAvatarsLoaded?$("ul.avatar-list").slideToggle("medium",function(){"open"===$el.attr("data-toggle")?($el.children("strong").text("Use one of ours..."),$el.attr("data-toggle","closed")):($el.children("strong").text("Hide avatars"),$el.attr("data-toggle","open"))}):(ugc.profiles.fetchAvatars(),ugc.profiles.stockAvatarsLoaded=!0,$el.attr("data-toggle","open"),$el.children("strong").text("Hide avatars"))},fetchAvatars:function(){var $stockAvatarUl=$('<ul class="avatar-list" />');$.getJSON("/ugc/avatars/stock",function(data){$.each(data.avatars,function(i){var count=i+1,li=["<li>",'<label for="avatar-'+count+'"><img src="'+this.url+'" alt="" class="stock-avatar" /></label>','<input type="radio" data-url="'+this.url+'"name="stockAvatarPath" value="'+this.path+'" id="avatar-'+count+'"/>',"</li>"].join("");$stockAvatarUl.append(li)}),$("#stock-avatars").append($stockAvatarUl)})},selectAvatar:function($input){return""===$input.val()?!1:($('#edit-avatar-form input[type="radio"]:checked').each(function(){$(this).prop("checked",!1)}),void $("#edit-avatar-form").submit())},editAvatar:function(event){event.preventDefault();var fileElement=document.getElementById("custom-avatar"),formData=new FormData;formData.append("file",fileElement.files[0],fileElement.files[0].name);var xhr=new XMLHttpRequest;xhr.open("POST",document.getElementById("edit-avatar-form").getAttribute("action"),!0),xhr.onload=function(){if(201===xhr.status){var patt1=new RegExp("<imageUrl>(.*?)</imageUrl>"),imageUrl=patt1.exec(xhr.responseText);ugc.profiles.updateAvatarUi(imageUrl[1])}else ugc.util.statusMessage("error","There was a problem uploading your avatar. Please adhere to file type/size restrictions.")},ugc.util.statusMessage("action","Uploading image..."),xhr.send(formData)},setStockAvatar:function($input){var userId=$("#user-id").val(),imageUrl=$input.attr("data-url"),imagePath=$input.val(),actionObj={imageUrl:imagePath};ugc.actions.modifyUser(userId,actionObj,!0),ugc.profiles.updateAvatarUi(imageUrl)},updateAvatarUi:function(imageUrl){$("img.profile-image, img.user-avatar").attr("src",imageUrl),$("ul.avatar-list").hide(),$("#show-stock-avatars strong").text("Use one of ours..."),$("#show-stock-avatars").attr("data-toggle","closed");var $profile=$(".profile-head"),profileTop=$profile.offset().top;$("html, body").animate({scrollTop:profileTop},500),$('#edit-avatar-form input[type="radio"]:checked').each(function(){$(this).prop("checked",!1)}),ugc.util.statusMessage("success","Your avatar has been updated.")},userAction:function($el){var elData=$el.data();"report"===elData.actionType&&this.abuseReport(elData.actionId,elData.reportType),"ignore-user"===elData.actionType&&this.ignoreUser(elData.actionId,elData.ignoreType,$el)},abuseReport:function(actionId,reportType){var keyName="user"===reportType?"namedUserKey":"parentKey";$form=ugc.templates.commentAbuseReport(actionId,keyName),$form.appendTo("body").submit(function(event){event.preventDefault();var actionObj=$(this).find("form").serializeObject();ugc.actions.createIa(actionObj),$(".ugc-modal").remove()})},ignoreUser:function(actionId,ignoreType,$el){var httpMethod="start-ignore"===ignoreType?"POST":"DELETE";ugc.actions.ignoreUser(actionId,httpMethod).success(function(){if("start-ignore"===ignoreType){var userName=$el.text().split(" ")[1];$el.data({ignoreType:"stop-ignore"}).removeClass("ignore-user").addClass("unignore-user").text("Stop ignoring "+userName)}else{var userName=$el.text().split(" ")[2];$el.data({ignoreType:"start-ignore"}).removeClass("unignore-user").addClass("ignore-user").text("Ignore "+userName)}})},sendMessage:function($form){ugc.addMessageEditor.save();var actionObj=$form.serializeObject();ugc.forms.checkForm($form)&&ugc.actions.createIa(actionObj).success(function(){window.location.href=window.location.href})},adminAction:function($el){var elData=$el.data();$form=ugc.templates.adminReasonForm(elData.property,elData.value),$form.appendTo("body"),$form.find("form").submit(function(event){event.preventDefault();var uiDataValue,uiDataText,actionObj=$(this).serializeObject();"ia"===elData.actionType&&(ugc.actions.modifyIa(elData.actionId,actionObj),uiDataValue="BLOCKED"===elData.value?"UNMODERATED":"BLOCKED",uiDataText="BLOCKED"===elData.value?"Unblock message":"Block message"),"user"===elData.actionType&&(ugc.actions.modifyUser(elData.actionId,actionObj),uiDataValue="true"===elData.value?"false":"true",uiDataText="true"===elData.value?"Unblock user":"Block user"),$(".ugc-modal").remove(),$el.text(uiDataText).data("value",uiDataValue)})}},ugc.util={statusMessage:function(type,customMessageText){$(".status-message").remove();var $messageBox=$('<div class="status-message" />'),$message=$('<span class="message" />'),messageText=customMessageText||"";"action"==type&&""===messageText&&(messageText="Sending..."),"success"==type&&""===messageText&&(messageText="Success!"),"error"==type&&""===messageText&&(messageText="There was an error. Please refresh the page and try again."),$message.text(messageText).addClass(type).appendTo($messageBox),$("body").prepend($messageBox),("success"==type||"error"==type)&&window.setTimeout(function(){$messageBox.fadeOut(400,function(){$(this).remove()})},3e3)}},ugc.templates={commentAbuseReport:function(actionId,keyType){var modal=['<div class="ugc-modal abuse">','<div class="heading">Report abuse<a href="#" class="close-modal" data-action="close">&times;</a></div>','<form action="#" class="report-abuse-form">','<input type="hidden" name="'+keyType+'" value="'+actionId+'" />','<div class="form-section">',"<label>Reason for reporting:</label>",'<select name="type" class="demerit-type">','<option value="DEMERIT_OBSCENITY_VULGARITY">Obscenity or vulgarity</option>','<option value="DEMERIT_HATE_SPEECH">Hate speech</option>','<option value="DEMERIT_PERSONAL_ATTACK">Personal attack</option>','<option value="DEMERIT_ADVERTISING_SPAM">Advertising spam</option>','<option value="DEMERIT_COPYRIGHT_PLAGIARISM">Copyright or plagiarism</option>','<option value="DEMERIT_OTHER">Other</option>',"</select>","</div>",'<div class="form-section">','<textarea type="text" id="abuse-textarea" class="add-abuse-comment" name="body" placeholder="Comment (optional)"></textarea>',"</div>",'<div class="form-section submit">','<input type="submit" value="Submit" class="btn-strong btn-medium"/>',"</div>","</form>","</div>"].join("");return $(modal)},adminReasonForm:function(property,value){var modal=['<div class="ugc-modal">','<form class="admin-reason">','<div class="heading">Reason for this action?<a href="#" class="close-modal" data-action="close">&times;</a></div>','<div class="form-section">','<input type="hidden" name="'+property+'" value="'+value+'" />','<textarea name="adminReason" autofocus></textarea>',"</div>",'<div class="form-section submit">','<input type="submit" value="Save" class="btn-strong btn-medium"/>',"</div>","</form>","</div>"].join("");return $(modal)}},$(document).ready(function(){$(".user-profile").length&&ugc.init()})}(this,jQuery),function($,a){$.fn.serializeObject=function(){var b={};return $.each(this.serializeArray(),function(d,e){var f=e.name,c=e.value;b[f]=b[f]===a?c:$.isArray(b[f])?b[f].concat(c):[b[f],c]}),b}}(jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.profiles.js", e)}};

// Source: /js/infiniScroll.js
try{
!function(){Backbone.InfiniScroll=function(collection,options){function buildQueryParams(model){var params={};return params[self.options.param]="function"==typeof model[self.options.untilAttr]?model[self.options.untilAttr]():model.get(self.options.untilAttr),params[self.options.pageSizeParam]=self.options.pageSize,self.options.includePage&&(params.page=page+1),params}options=options||{};var $el,$target,targetEvent,targetEventHandler,fetchOn,page,pageSize,self={},prevScrollY=0;pageSize=collection.length||25,self.collection=collection,self.options=_.defaults(options,{success:function(){},error:function(){},onFetch:function(){},target:$(window),targetEvent:"scroll",targetSelector:null,param:"until",extraParams:{},pageSizeParam:"page_size",untilAttr:"id",pageSize:pageSize,scrollOffset:100,remove:!1,strict:!1,includePage:!1});var initialize=function(){$el=self.options.$el,$target=self.options.target,targetEvent=self.options.targetEvent,targetSelector=self.options.targetSelector;var targetEventHandlerMap={scroll:self.throttledWatchScroll,click:self.onClickLoadMoreButton};targetEventHandler=targetEventHandlerMap[targetEvent],fetchOn=!0,page=1,$target.on(targetEvent,targetSelector,targetEventHandler)};return self.destroy=function(){$target.off(targetEvent,targetSelector,targetEventHandler)},self.enableFetch=function(){fetchOn=!0,"click"===self.options.targetEvent&&$(self.options.targetSelector).show()},self.disableFetch=function(){fetchOn=!1,"click"===self.options.targetEvent&&$(self.options.targetSelector).hide()},self.onFetch=function(){self.options.onFetch()},self.atMaxPage=function(){return self.options.maxPage&&page+1>=self.options.maxPage},self.fetchSuccess=function(collection,response){!self.atMaxPage()&&(self.options.strict&&collection.length>=(page+1)*self.options.pageSize||!self.options.strict&&response.data.length>0)?(self.enableFetch(),page+=1):self.disableFetch(),self.options.success(collection,response)},self.fetchError=function(collection,response){self.enableFetch(),self.options.error(collection,response)},self._fetch=function(){var lastModel=self.collection.last();lastModel&&(self.onFetch(),self.disableFetch(),self.collection.fetch({success:self.fetchSuccess,error:self.fetchError,remove:self.options.remove,data:$.extend(buildQueryParams(lastModel),self.options.extraParams)}))},self.watchScroll=function(){var scrollY=$target.scrollTop()+$target.height(),elHeight=$el.offset().top+$el.get(0).scrollHeight;elHeight||(elHight=$(document).height()),fetchOn&&scrollY>=elHeight-self.options.scrollOffset&&scrollY>=prevScrollY&&self._fetch(),prevScrollY=scrollY},self.throttledWatchScroll=_.throttle(self.watchScroll,500),self.onClickLoadMoreButton=function(e){e.preventDefault(),self._fetch()},initialize(),self}}();
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/infiniScroll.js", e)}};

// Source: /js/bcom.customscroll.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.customScroll=function(){"use strict";var module={};return module.init=function(){$("html").hasClass("ie8")||($(window).width()>=520?$(".toc-mod").mCustomScrollbar({contentTouchScroll:!0,scrollInertia:100}):$(".toc-mod").css("overflow-y","scroll"))},module.initFilterNav=function(){$(".filter-nav-mod").scroll(function(){$(".filter-nav-mod").addClass("no-after")})},module}(),$(function(){$(".toc-mod")&&bcom.customScroll.init(),bcom.customScroll.initFilterNav()});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.customscroll.js", e)}};

// Source: /js/bcom.breaking-scoreboard.js
try{
"undefined"==typeof bcom&&(bcom={}),bcom.breakingScoreboard=function(el,league,gameCode){var template=$("#breaking-scoreboard-mustache").html(),domain=location.protocol+"//"+location.host,url=domain+"/partners/stats/"+league+"/"+gameCode+".txt";$.ajax({url:url,dataType:"json"}).done(function(data){switch(data.moreType,data.sport=league,data.segment_number="0"!=data.segment_number?bcom.util.getOrdinal(data.segment_number):void 0,league){case"mlb":data.moreType="Red Sox";break;case"nba":data.moreType="Celtics";break;case"nfl":data.moreType="Patriots";break;case"nhl":data.moreType="Bruins";break;default:data.moreType=!1}var rendered=Mustache.render(template,data);el.html(rendered).addClass("rendered")}).fail(function(){}).always(function(){})},$(function(){if($(".breaking-scoreboard-mod")){var $scoreboards=$(".breaking-scoreboard-mod");$.each($scoreboards,function(){var that=this,$that=$(this);bcom.breakingScoreboard($that,that.getAttribute("data-league"),that.getAttribute("data-game-code"))})}});
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.breaking-scoreboard.js", e)}};

// Source: /js/app.js
try{
delete console,function(win,$,undefined){"use strict";if(window.stream){var app={root:"/",stream:window.stream,streamFetchSize:window.stream.queryLimit||25,maxStreamFetches:window.stream.queryDepth||50},track={streamBundleNumber:function(){return app.collection.fetchNumber},streamFilterName:function(){return _.findWhere(app.stream.filters,{id:app.collection.filterId}).name},streamName:function(){return s.prop1+" | "+app.stream.name},streamAssetType:function(){return s.prop6},nodeWhereClicked:function(event){var $target=$(event.target),nodeWhereClicked=$target.data("where-clicked");return nodeWhereClicked},nodeStyle:function(view){return"Ad"==view.model.get("fetchNumber")?"Ad":view.model.get("has_sponsor")?"Sponsored Content":"Editorial"},nodeAssetType:function(view){return view.model.get("tracking").prop6},nodeNumberClicked:function(view){var $nodes=$(".stream-items > .stream-item"),nodeNumberClicked=$nodes.index(view.$el);return nodeNumberClicked},streamInitiallyLoads:function(){var s_account="nytbglobe,nytbgglobal",s=s_gi(s_account);s.linkTrackVars="prop55,prop56,prop57,prop58,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents="event29,event37",s.prop55=s.eVar55=track.streamBundleNumber(),s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events="event29,event37",s.tl(this,"o","StreamLoad"),bcom.util.clearSVars(s)},streamLoadsMoreContent:function(){var s_account="nytbglobe,nytbgglobal",s=s_gi(s_account);s.linkTrackVars="prop55,prop56,prop57,prop58,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents="event29,event37",s.prop55=s.eVar55=track.streamBundleNumber(),s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events="event29,event37",s.tl(this,"o","StreamLoad"),bcom.util.clearSVars(s)},streamFilterApplied:function(){var s_account="nytbglobe,nytbgglobal",s=s_gi(s_account);s.linkTrackVars="prop55,prop56,prop57,prop58,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents="event39",s.prop55=s.eVar55=track.streamBundleNumber(),s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events="event39",s.tl(this,"o","StreamFilter"),bcom.util.clearSVars(s)},streamItemClicked:function(event,view){var nodeName=view.model.get("head"),isPinned=view.model.get("is_pinned"),s_account="nytbglobe,nytbgglobal",s=s_gi(s_account);s.linkTrackVars="prop50,prop51,prop52,prop53,prop54,prop55,prop56,prop57,prop58,eVar50,eVar51,eVar52,eVar53,eVar54,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents=isPinned?"event36":"event35",s.prop50=s.eVar50=track.nodeAssetType(view),s.prop51=s.eVar51=track.nodeNumberClicked(view),s.prop52=s.eVar52=nodeName,s.prop53=s.eVar53=track.nodeStyle(view),s.prop54=s.eVar54=track.nodeWhereClicked(event),s.prop55=s.eVar55=view.model.get("fetchNumber"),s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events=isPinned?"event36":"event35",s.tl(this,"o","StreamClick"),bcom.util.clearSVars(s)},newStreamItemAlert:function(){var s_account="nytbglobe",s=s_gi(s_account);s.linkTrackVars="prop50,prop51,prop52,prop53,prop54,prop55,prop56,prop57,prop58,eVar50,eVar51,eVar52,eVar53,eVar54,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents="event33",s.prop50=s.eVar50="Alert",s.prop51=s.eVar51="N/A",s.prop52=s.eVar52="Alert",s.prop53=s.eVar53="Alert",s.prop54=s.eVar54="Alert",s.prop55=s.eVar55="N/A",s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events="event33",s.tl(this,"o","NodeAlert"),bcom.util.clearSVars(s)},newStreamItemAlertClicked:function(newItemCount){var s_account="nytbglobe",s=s_gi(s_account);s.linkTrackVars="prop50,prop51,prop52,prop53,prop54,prop55,prop56,prop57,prop58,eVar50,eVar51,eVar52,eVar53,eVar54,eVar55,eVar56,eVar57,eVar58,events",s.linkTrackEvents="event34",s.prop50=s.eVar50="Alert",s.prop51=s.eVar51="N/A",s.prop52=s.eVar52=newItemCount,s.prop53=s.eVar53="Alert",s.prop54=s.eVar54="Alert",s.prop55=s.eVar55="N/A",s.prop56=s.eVar56=track.streamFilterName(),s.prop57=s.eVar57=track.streamName(),s.prop58=s.eVar58=track.streamAssetType(),s.events="event34",s.tl(this,"o","NodeAlertClick"),bcom.util.clearSVars(s)}},JST=window.JST=window.JST||{};Backbone.Layout.configure({manage:!0,prefix:"/templates/",fetchTemplate:function(path){return path+=".mustache",JST[path]||$.ajax({url:path,cache:!0,async:!1}).then(function(contents){JST[path]=contents}),JST[path]},renderTemplate:function(template,context){return Mustache.render(template,context)}});var Router=Backbone.Router.extend({initialize:function(){this.layout=new Backbone.Layout({template:"layouts/main"}),this.layout.$el.appendTo("#streams-row"),this.firstStreamRender=!0},routes:{"":"renderStream",":hash":"renderStream"},renderStream:function(hash){var isNotFilterHash=hash&&0!==hash.indexOf("filter-");if(!isNotFilterHash||this.firstStreamRender){var _this=this,filterId=hash&&0===hash.indexOf("filter-")?hash.replace("filter-",""):app.stream.filters[0].id,collection=new ContentCollection([],{stream:app.stream.id,filterId:filterId,usePubnub:app.stream.usePubnub||"true"==bcom.util.getQueryStringValue("usePubnub")});app.collection=collection,collection.fetch({reset:!0}).done(function(){_this.layout.setViews({"#stream-wrap":[app.streamView=new StreamView({collection:collection})]});var intervalId,intervalRunLimit=3,intervalRun=0,intervalDelay=333,shouldRender=function(){return!app.collection.usePubnub||app.collection.receivedAllHistory||intervalRun>intervalRunLimit},renderNow=function(){_this.layout.render(),filterId!==app.stream.filters[0].id&&track.streamFilterApplied(),_this.firstStreamRender=!1},renderWhenShouldOnInterval=function(){intervalRun++,shouldRender()&&(renderNow(),clearInterval(intervalId))};intervalId=setInterval(renderWhenShouldOnInterval,intervalDelay)})}}}),ContentModel=Backbone.Model.extend({notify:function(){if(!localStorage||"disabled"!=localStorage.getItem("notifications")){var title,body,icon;if(this.get("is_tweet")){var tweet=this.get("tweet");title=tweet.name+" @"+tweet.handle,body=tweet.text,icon=tweet.avatar}else if(this.get("is_comment")){var comment=this.get("comment");title=comment.user.name+" comments on "+this.get("title"),body=this.get("subhead"),icon=comment.user.avatar}else title=this.get("head"),body=this.get("subhead"),icon=this.get("has_image")?this.get("image").thumb_quick:null;title=bcom.util.stripHtml(title)||"missing title",body=bcom.util.stripHtml(body);var notification=new Notify(title,{body:body,icon:icon,notifyShow:function(){setTimeout(function(){$(notification.myNotify).trigger("close")},5e3)},notifyClick:function(){this.model.collection.trigger("notification:click",this.model);var newWindow=window.open(this.model.get("url"),"_blank");newWindow.focus();var s=s_gi("nytbglobe");s.tl(this.model.attributes,"o","Desktop_notification_item_click")}});notification.model=this,notification.show()}},formattedStreamDate:function(){var timestamp=this.get("timestamp"),formattedStreamDate=moment.utc(timestamp).subtract(1,"s").format("YYYYMMDDHHmmss");return formattedStreamDate},sendToTv:function(){PUBNUB.publish({channel:"globetv_ugc",message:this.get("video").id,callback:function(details){var success=details[0],response=details[1];success||alert("Fail!",response)}})}}),ContentCollection=Backbone.Collection.extend({model:ContentModel,url:"/fragment/SysConfig/WebPortal/BDC/Framework/sandbox/jflaherty/getJsonbyStream.jpt",initialize:function(models,options){this.stream=options.stream,this.filterId=options.filterId,this.name=app.stream.env+":"+this.stream+":"+this.filterId,this.fetchNumber=0,this.usePubnub=options.usePubnub,this.usePubnub&&(this.on("first:fetch:xhr:done",this.startUpdates,this),this.on("pubnub:history:received",this.subscribeToUpdates,this),this.on("pubnub:message:received",this.receiveUpdate,this))},startUpdates:function(maxLastStreamDate){var _this=this;PUBNUB.history({count:5,channel:_this.name,error:function(){},callback:function(response){_this.receiveHistory(response,_this,maxLastStreamDate)}})},receiveHistory:function(response,_this,maxLastStreamDate){var messages=response[0],startTime=response[1],allMessagesNew=(response[2],_.chain(messages).reverse().all(function(message){var modelLastStreamDate=message.model.lastStreamDate;return maxLastStreamDate>modelLastStreamDate?!1:(_this.trigger("pubnub:message:received",message),!0)}).value());allMessagesNew?PUBNUB.history({start:startTime,count:5,channel:_this.name,error:function(){},callback:function(nextResponse){_this.receiveHistory(nextResponse,_this,maxLastStreamDate)}}):(_this.receivedAllHistory=!0,_this.trigger("pubnub:history:received"))},subscribeToUpdates:function(){var _this=this;PUBNUB.subscribe({channel:_this.name,callback:function(message){_this.trigger("pubnub:message:received",message)}})},receiveUpdate:function(message){if(message.model)switch(message.method){case"create":this.add(message.model,{from_pubnub:!0})}},comparator:function(a,b){var aPinned=a.get("is_pinned"),bPinned=b.get("is_pinned"),aTime=a.get("timestamp"),bTime=b.get("timestamp");return aPinned&&!bPinned?-1:!aPinned&&bPinned?1:bTime.localeCompare(aTime)},fetch:function(options){var xhr,_this=this;return options.data=options.data||{},_.defaults(options.data,{limit:app.streamFetchSize,stream:_this.stream,filter:_this.filterId}),options.fetchNumber=_this.fetchNumber+=1,xhr=Backbone.Collection.prototype.fetch.call(this,options),xhr.done(function(response){1==_this.fetchNumber?(_this.trigger("first:fetch:xhr:done",response.maxLastStreamDate),track.streamInitiallyLoads()):track.streamLoadsMoreContent()}),xhr},parse:function(response){return _.each(response.data,function(x){x.fetchNumber=this.fetchNumber},this),response.data}}),StreamView=Backbone.Layout.extend({template:"stream",className:"stream",attributes:function(){return{id:this.collection.name+"-stream"}},initialize:function(){this.newItemCount=0,this.adCount=0,this.adLimit=20,this.visibleContentCount=0,this.filters=app.stream.filters,this.showFilter=this.filters.length>1?!0:!1,this.currentBreakPoint=bcom.util.getCurrentBreakPoint();var _this=this,scrollOptions={$el:this.$el,param:"startingdate",untilAttr:"formattedStreamDate",pageSizeParam:"limit",scrollOffset:500,pageSize:app.streamFetchSize,maxPage:app.maxStreamFetches,onFetch:function(){_this.loadingGraphic("show")},success:function(){_this.loadingGraphic("hide")}};Modernizr.touch&&$.extend(scrollOptions,{target:this.$el,targetSelector:".load-stories-btn",targetEvent:"click"}),this.infiniScroll=new Backbone.InfiniScroll(this.collection,scrollOptions),this.listenTo(this.collection,{add:this.addOne,reset:this.render,"change:is_pinned":this.onChangeIsPinned,"notification:click":this.onNotificationClick}),this.refreshOnResize()},serialize:function(){return{newItemCount:this.newItemCount,filters:this.filters,showFilter:this.showFilter}},loadingGraphic:function(status){return"show"===status?void this.$el.append('<div class="loading-stream-items"><div class="loading"><i class="dot one"></i><i class="dot two"></i><i class="dot three"></i></div></div>'):"hide"===status?void this.$el.find(".loading-stream-items").remove():void 0},beforeRender:function(){this.visibleContentCount=0,this.collection.each(function(model){this.addOne(model,this.collection)},this)},afterRender:function(){var _this=this,$quickFilters=$(".js-quick-filter"),$filterActive="filter-active";$quickFilters.removeClass($filterActive),$(".js-quick-filter-"+this.collection.filterId).addClass($filterActive),_this.scrollTop&&(bcom.util.scrollToEl(_this.$el,100),_this.scrollTop=!1),$(".filter-nav-mod").one("scroll",function(){$(".filter-nav-mod").addClass("no-after")})},remove:function(){return this.infiniScroll.destroy(),Backbone.View.prototype.remove.call(this)},createView:function(model){var ViewClass=StreamItemView;return(model.get("is_social")||model.get("is_comment"))&&(ViewClass=StreamItemSocialView),model.get("is_big_tz")&&(ViewClass=StreamItemBigTeaseView),new ViewClass({model:model,streamName:this.collection.name})},addOne:function(model,collection,options){return options=options||{},options.from_pubnub?(model.notify(),model.set("from_pubnub",!0),model.set("fetchNumber","update"),this.newItemCount+=1,this.$(".new-item-count").text(this.newItemCount),void this.$(".stream-notification").attr({"data-new-count":this.newItemCount})):(this.insertView(".stream-items",this.createView(model)).render(),this.visibleContentCount+=1,void(this.visibleContentCount%bcom.dfp.streamCount===0&&this.adCount<20&&(this.adCount++,this.insertView(".stream-items",new StreamItemAdView({count:this.adCount,fetchNumber:"ad"})).render())))},events:{"click .js-quick-filter":"onClickFilter","click .load-new-stream-items":"onLoadNewStreamItems"},onClickFilter:function(e){e.preventDefault();var filter="filter-"+$(e.target).data("filters");app.router.navigate(filter,!0)},onChangeIsPinned:function(){return this.collection.sort(),this.render()},onLoadNewStreamItems:function(e){e.preventDefault();var newItemCountAtClickTime=this.newItemCount;this.loadNewStreamItems(),track.newStreamItemAlertClicked(newItemCountAtClickTime)},onNotificationClick:function(){this.loadNewStreamItems()},loadNewStreamItems:function(){this.newItemCount=0,this.scrollTop=!0,this.render()},refreshOnResize:function(){var that=this;$(window).on("debouncedresize",function(){if(that.currentBreakPoint!==bcom.util.getCurrentBreakPoint()){var definitionArray=[];$.each(streamAds,function(i,adObject){definitionArray.push(adObject.adDefinition)}),that.currentBreakPoint=bcom.util.getCurrentBreakPoint(),googletag.cmd.push(function(){googletag.pubads().setTargeting("breakpoint",that.currentBreakpoint),googletag.pubads().refresh(definitionArray)})}})}}),streamAds={},StreamItemAdView=Backbone.Layout.extend({template:"stream-ad",className:"stream-item",initialize:function(options){options=options||{},this.count=options.count,this.adName="ad_stream"+this.count,this.adPos=["btf"],this.adPos.push("stream"+this.count),this.run=!0,streamAds[this.count]===undefined?(this.displayed=!1,streamAds[this.count]={adName:this.adName,adPos:this.adPos}):this.displayed=!0},serialize:function(){return{adName:this.adName}},afterRender:function(){if(this.run){var i=this.count,filterName=String(app.collection.filterId.replace(/-/g,"")),bundleNumber=String(track.streamBundleNumber());return googletag.cmd.push(this.displayed?function(){googletag.pubads().setTargeting("stream",filterName),googletag.pubads().setTargeting("streamcount",bundleNumber),googletag.pubads().refresh([streamAds[i].adDefinition])}:function(){streamAds[i].mapping=googletag.sizeMapping().addSize([960,0],[[300,250],[600,250],[320,50],[676,117]]).addSize([768,0],[[300,250],[600,250],[320,50],[676,117]]).addSize([0,0],[[300,250],[320,50],[676,117]]).build(),streamAds[i].adDefinition=googletag.defineSlot(bcom.dfp.networkCode+"/"+bcom.dfp.adUnit,[[300,250],[600,250],[320,50],[676,117]],streamAds[i].adName).defineSizeMapping(streamAds[i].mapping).addService(googletag.pubads()).setTargeting("pos",streamAds[i].adPos),googletag.pubads().setTargeting("stream",filterName),googletag.pubads().setTargeting("streamcount",bundleNumber),googletag.display(streamAds[i].adName)}),void(this.run=!1)}}}),StreamItemView=Backbone.Layout.extend({model:ContentModel,serialize:function(){var attrs=_.clone(this.model.attributes),timestamp=attrs.timestamp;return attrs.formattedTimestamp=moment(timestamp).fromNow(),attrs},attributes:function(){return{"class":"stream-item"}},initialize:function(){this.template="stream-item-default",this.listenTo(this.model,{change:this.render}),this.sentToTv=!1},events:{"click .user-action a":"userAction","submit .tz-poll":"submitPoll","click .external":"externalLink",swipe:"sendToTv","click a":"onClickThrough"},beforeRender:function(){this.model.get("from_pubnub")&&!this.model.get("rendered")&&this.model.set({rendered:!0},{silent:!0}),this.model.get("is_external")&&this.$el.find("a").addClass("external")},afterRender:function(){this.model.get("has_scoreboard")&&bcom.streamscoreboard(this.$el.find(".scoreboard-mod"),this.model.get("scoreboard").league,this.model.get("scoreboard").gameCode)},popupTrigger:function(e){e.preventDefault()},submitPoll:function(e){e.preventDefault();$(e.target).find("input:checked").val()},userAction:function(e){e.preventDefault();var $target=$(e.target),data=$target.data(),property=data.property,value=data.value,update={};update[property]=value,this.model.save(update)},externalLink:function(){},sendToTv:function(e){e.preventDefault(),this.sentToTv||(this.model.sendToTv(),this.sentToTv=!0)},onClickThrough:function(e){track.streamItemClicked(e,this)}}),StreamItemBigTeaseView=StreamItemView.extend({initialize:function(){this.template="stream-item-big-tease"}}),StreamItemSocialView=(StreamItemView.extend({initialize:function(){}}),StreamItemView.extend({initialize:function(){this.template="stream-item-social"},serialize:function(){var attrs=_.clone(this.model.attributes),timestamp=attrs.timestamp;return attrs.formattedTimestamp=moment(timestamp).fromNow(),attrs}}));app.router=new Router,Backbone.history.start({pushState:!1,root:app.root}),win.app=app;var enableNotifications=function(e){e.preventDefault();var _this=this,myNotification=new Notify("Notifications enabled!",{body:"Watch for new stories here!",icon:"/img/circleb-80x80.png",permissionGranted:function(){localStorage.setItem("notifications","enabled"),myNotification.show(),$(_this).text("Disable Notifications").addClass("disable-notifications").removeClass("enable-notifications")}});myNotification.requestPermission()},disableNotifications=function(e){e.preventDefault(),localStorage.setItem("notifications","disabled"),$(this).text("Enable Notifications").addClass("enable-notifications").removeClass("disable-notifications")};$(document).on("click",".enable-notifications",enableNotifications),$(document).on("click",".disable-notifications",disableNotifications),_.mixin({pushUnique:function(array,value){array[value]===undefined&&array.push(value)}})}}(window,jQuery);
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/app.js", e)}};

// Source: /js/bcom.inits.js
try{
function socialOnLoad(){setTimeout(function(){$(".nav-button-mod").removeClass("nav-button-mod-load")},3700)}$(document).ready(function(){bcom.videoPlayer.video.init(),socialOnLoad(),$("a.open-window").on("click",function(e){e.preventDefault();var $this=$(this);props=$this.context.dataset.props.replace(/(resizable|scrollbars)\=no/g,"$1=yes");var nw=window.open($this.context.dataset.url,$this.context.dataset.name,props);nw.focus(),window.event.cancelBubble=!0})}),window._taboola=window._taboola||[],_taboola.push({article:"auto"}),!function(e,f,u){e.async=1,e.src=u,f.parentNode.insertBefore(e,f)}(document.createElement("script"),document.getElementsByTagName("script")[0],"http://cdn.taboola.com/libtrc/boston/loader.js");
}catch(e){ball.errors.push(e); if (console) {console.log("caught error in", "/js/bcom.inits.js", e)}};
