/* /resources/js/posttv/ooyala/ooyala-plugin-loader.js */
function ooyalaPluginLoaderJs(){var b=window.wp_pb&&wp_pb.environment==="development",m=b?j:c,h=d("e"),a,i,f=window.wp_pb&&wp_pb.contextPath?wp_pb.contextPath:(window.TWP&&TWP.PostTV&&!!TWP.PostTV.isDebugMode?"http://posttvbeta.washingtonpost.com/posttv-beta":"http://www.washingtonpost.com/posttv"),g=window.wp_pb&&wp_pb.resourceToken?wp_pb.resourceToken:new Date().getTime();TWP=window.TWP||{};TWP.PostTV=TWP.PostTV||{};window.wp_pb=window.wp_pb||{};a=h==null||isNaN(h)?TWP.PostTV.VideoApp.playerContainer.attr("data-show-endscreen")==="1":h==1;i=TWP.PostTV.VideoApp.playerContainer.attr("data-use-custom-scrubber")==="1";function d(n,e){return decodeURIComponent((new RegExp("[?|&]"+n+"=([^&;]+?)(&|#|;|$)").exec(e||location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function k(e){if(e&&e.href){if(document.head){document.head.appendChild(e)}else{document.getElementsByTagName("head")[0].appendChild(e)}}}function c(){if(TWP.PostTV.VideoApp&&TWP.PostTV.VideoApp.playerContainer){var e,n;if(i){e=document.createElement("link");e.rel="stylesheet";if(a){if(TWP.PostTV.VideoApp.playerContainer.data("playerType")=="posttv-embed"){n=f+"/resources/js/posttv/posttv-plugins-all-embed.min.js?_="+g;e.href=f+"/resources/css/posttv/posttv-plugins-all-embed.min.css?_="+g}else{n=f+"/resources/js/posttv/posttv-plugins-all.min.js?_="+g;e.href=f+"/resources/css/posttv/posttv-plugins-all.min.css?_="+g}}else{if(TWP.PostTV.VideoApp.playerContainer.data("playerType")=="posttv-embed"){n=f+"/resources/js/posttv/posttv-plugins-truthteller-embed.min.js?_="+g;e.href=f+"/resources/css/posttv/ooyala/plugin.ooyala.postTvTruthTeller-2.0.0.min.css?_="+g}else{n=f+"/resources/js/posttv/posttv-plugins-truthteller.min.js?_="+g;e.href=f+"/resources/css/posttv/ooyala/plugin.ooyala.postTvTruthTeller-1.1.1.min.css?_="+g}}}k(e);if(n){$.getScript(n)}l()}else{console.log("The PostTV app.js is not loaded. No Ooyala plugin will be loaded.")}}function j(){if(TWP.PostTV.VideoApp&&TWP.PostTV.VideoApp.playerContainer){var n,r,o=[],e=[];if(i){e.push(f+"/resources/js/posttv/ooyala/plugin.ooyala.postTvScrubber.js?_="+g)}if(a){n=document.createElement("link");n.rel="stylesheet";n.href=f+"/resources/css/posttv/ooyala/plugin.ooyala.postTvEndscreen.min.css?_="+g;o.push(n);e.push(f+"/resources/js/posttv/ooyala/plugin.ooyala.postTvEndscreen.min.js?_="+g)}r=document.createElement("link");r.rel="stylesheet";if(TWP.PostTV.VideoApp.playerContainer.data("playerType")=="posttv-embed"){e.push(f+"/resources/js/posttv/ooyala/plugin.ooyala.postTvTruthTeller-2.0.0.min.js?_="+g);r.href=f+"/resources/css/posttv/ooyala/plugin.ooyala.postTvTruthTeller-2.0.0.min.css?_="+g}else{e.push(f+"/resources/js/posttv/ooyala/plugin.ooyala.postTvTruthTeller-1.1.1.min.js?_="+g);r.href=f+"/resources/css/posttv/ooyala/plugin.ooyala.postTvTruthTeller-1.1.1.css?_="+g}o.push(r);e.push(f+"/resources/js/posttv/ooyala/plugin.ooyala.postTvOverlay.js?_="+g);if(o.length>0){for(var q=0;q<o.length;q++){k(o[q])}}if(e.length>0){for(var p=0;p<e.length;p++){$.getScript(e[p])}}l()}else{console.log("The PostTV app.js is not loaded. No Ooyala plugin will be loaded.")}}function l(){if(window.wp_pb&&!!window.wp_pb.deferredAsync&&TWP.PostTV.VideoApp&&TWP.PostTV.VideoApp.playerContainer){var e=function(){if(window.wp_pb&&!!window.wp_pb.deferredAsync&&typeof wp_pb.loadAsyncFeatures==="function"){window.wp_pb.deferredAsync=false;wp_pb.loadAsyncFeatures()}};TWP.PostTV.VideoApp.playerContainer.on(TWP.PostTV.EVENTS.EDITORIAL_PLAY_STARTED,e);TWP.PostTV.VideoApp.playerContainer.on(TWP.PostTV.EVENTS.AD_STARTED,e)}}m.call()}if(typeof EMBED_PLAYER_TYPE=="undefined"){(function(){ooyalaPluginLoaderJs()})()};

/* /resources/js/posttv/ooyala/ooyala-player.js */
function ooyalaPlayerJs(){TWP=window.TWP||{};TWP.PostTV=TWP.PostTV||{};TWP.PostTV.players=TWP.PostTV.players||{};TWP.hpRefreshTests=TWP.hpRefreshTests||[];TWP.PostTV.adFrequency=TWP.PostTV.adFrequency||1/2;TWP.PostTV.inverseAdFrequency=TWP.PostTV.inverseAdFrequency||1/TWP.PostTV.adFrequency;TWP.PostTV.blankAdSetCode=TWP.PostTV.blankAdSetCode||"347e498d32924a56a51c7beca90b8b02";TWP.PostTV.EVENTS=$.extend(TWP.PostTV.EVENTS,{DESTROY:"destroy",ERROR:"videoError",SEND_TRACKING_DATA:"sendTrackingData",SEEK:"seek",SET_VOLUME:"setVolume",SKIP_AD:"skipAd",PLAY:"play",PAUSE:"pause",PLAY_NEXT_VIDEO:"playNextVideo",PLAYER_CREATED:"playerCreated",OO_PLAYER_INITIALIZED:"ooPlayerInitialized",OO_PLUGIN_LOADED:"ooPluginLoaded",OO_PLUGIN_FULLY_LOADED:"ooPluginFullyLoaded",WILL_CHANGE_EMBED_CODE:"willChangeEmbedCode",CONTENT_TREE_FETCHED:"contentTreeFetched",PLAYBACK_READY:"playbackReady",PLAYHEAD_TIME_CHANGED:"playheadTimeChanged",COMPANION_ADS_DISPLAYED:"companionAdsDisplayed",AD_STARTED:"adStarted",ADS_CLEARED:"adsCleared",EDITORIAL_PLAY_STARTED:"editorialPlayStarted",PLAY_COMPLETED:"ooPlayCompleted",NEED_RESIZE_VIDEO_ELEMENT:"needResizeVideoElement",SCRUBBER_NEEDS_ADJUSTMENT:"scrubberNeedsAdjustment",VOLUME_CHANGED:"volumeChanged",CAST_READY:"castReady",CAST_VIDEO:"castVideo",CAST_STARTED:"castStarted",CAST_FINISHED:"castFinished",CAST_PAUSE:"castPause",CAST_PLAY:"castPlay",CAST_SEEK:"castSeek",CAST_NEXT_VIDEO:"castNextVideo",CAST_PROGRESS:"castProgress"});TWP.PostTV.loadedResources=true;TWP.PostTV.isFlashEnabled=(function(){var hasFlash=false;try{var fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(fo){hasFlash=true}}catch(e){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined){hasFlash=true}}return hasFlash})();TWP.PostTV.areCookiesEnabled=TWP.PostTV.areCookiesEnabled||function(){var cookieEnabled=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled="testcookie" in document.cookie?true:false}return(cookieEnabled)};TWP.PostTV.getCookie=TWP.PostTV.getCookie||function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null};TWP.PostTV.incrementCountingCookie=TWP.PostTV.incrementCountingCookie||function(name,options){if(!!name){options=options||{};TWP.PostTV.setCookie(name,TWP.PostTV.getCountingCookie(name)+1,options.expires,options.path,options.domain,options.secure)}};TWP.PostTV.getCountingCookie=TWP.PostTV.getIntegerCookie||function(name){var count=0;if(!!name&&TWP.PostTV.areCookiesEnabled()){var v=TWP.PostTV.getCookie(name);count=!isNaN(parseInt(v))?parseInt(v):0;count=(count<0)?0:count}return count};TWP.PostTV.getFlagCookie=TWP.PostTV.getFlagCookie||function(name){var flag=0;if(!!name&&TWP.PostTV.areCookiesEnabled()){var v=TWP.PostTV.getCookie(name);flag=!isNaN(parseInt(v))?parseInt(v):0;flag=(flag<0)?0:flag}return(flag%2)};TWP.PostTV.toggleFlagCookie=TWP.PostTV.toggleFlagCookie||function(name,options){if(!!name){options=options||{};TWP.PostTV.setCookie(name,(TWP.PostTV.getFlagCookie(name)+1)%2,options.expires,options.path,options.domain,options.secure)}};TWP.PostTV.setCookie=function(name,value,expires,path,domain,secure){document.cookie=name+"="+escape(value)+(expires?"; expires="+expires:"")+(path?"; path="+path:"; path=/")+(domain?"; domain="+domain:"; domain="+(/(?:[^\.]+)(\.([^\.]+\.){1,}[^\.]+)$/.test(document.location.host)?RegExp.$1:document.location.host))+(secure?"; secure":"")};TWP.PostTV.getCount=TWP.PostTV.getCount||function(){return TWP.PostTV.getCountingCookie("videoplays")};TWP.PostTV.incrementCount=TWP.PostTV.incrementCount||function(options){var expirationDate=new Date();expirationDate.setTime(expirationDate.getTime()+(10*60*1000));options=jQuery.extend(options,{expires:expirationDate.toGMTString()});TWP.PostTV.incrementCountingCookie("videoplays",options)};TWP.PostTV.getPreRollsBlocked=TWP.PostTV.getPreRollsBlocked||function(){return TWP.PostTV.getFlagCookie("adsflag")};TWP.PostTV.togglePreRollsBlocked=TWP.PostTV.togglePreRollsBlocked||function(options){TWP.PostTV.toggleFlagCookie("adsflag",options)};TWP.PostTV.enablePageRefresh=!!$("#enable-page-refresh").data("enablePageRefresh");TWP.PostTV.shouldRefreshPage=TWP.PostTV.enablePageRefresh&&TWP.PostTV.isDeskweb;TWP.PostTV.destroyWhenUpdate=!!$("#destroy-when-update").data("destroyWhenUpdate");TWP.PostTV.BrowserInfo=TWP.PostTV.BrowserInfo||{init:function(userAgentStr){this.userAgentStr=userAgentStr;this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(this.userAgentStr)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";this.deviceType=this.lookUpDeviceType(this.dataDeviceType)||0},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=typeof data[i].string==="undefined"?this.userAgentStr:data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1){return data[i].identity}}else{if(dataProp){return data[i].identity}}}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1){return}return dataString.substring(index+this.versionSearchString.length+1).match(/\d+(\.\d+)+/g)[0]},lookUpDeviceType:function(data){var dataString;for(var i=0,l=data.length;i<l;i++){dataString=typeof data[i].string==="undefined"?this.userAgentStr:data[i].string;if(dataString){if($.isArray(data[i].subString)){for(var j=0,jl=data[i].subString.length;j<jl;j++){if(dataString.indexOf(data[i].subString[j])!=-1){return typeof data[i].type==="number"?data[i].type:this.lookUpDeviceType(data[i].type)}}}else{if(dataString.indexOf(data[i].subString)!=-1){return typeof data[i].type==="number"?data[i].type:this.lookUpDeviceType(data[i].type)}else{if(typeof data[i].otherwise!="undefined"){return data[i].otherwise}}}}}},dataBrowser:[{subString:"Chrome",identity:"Chrome"},{subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{subString:"Silk",identity:"Silk"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{subString:"Netscape",identity:"Netscape"},{subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{subString:"Android",identity:"Android Stock Browser",versionSearch:"Android"},{subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{subString:"iPhone",identity:"iPhone"},{subString:"iPad",identity:"iPad"},{subString:"Android",identity:"Android"},{subString:"Silk",identity:"Android for Kindle"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],dataDeviceType:[{subString:["iPhone","iPod"],type:1},{subString:["iPad","Silk"],type:2},{subString:["Android"],type:[{subString:["Firefox"],type:2},{subString:["Mobile"],type:1},{subString:null,otherwise:2}]},{subString:["Opera"],type:[{subString:["Mobi","Mini"],type:1}]},{subString:["AppleWebKit"],type:[{subString:["Mobile"],type:1}]},{subString:["Mobile"],type:1}]};if(!TWP.PostTV.BrowserInfo.browser){TWP.PostTV.BrowserInfo.init(navigator.userAgent)}TWP.PostTV.isMobile=typeof TWP.PostTV.isMobile=="boolean"?TWP.PostTV.isMobile:(function(){return TWP.PostTV.BrowserInfo.deviceType==1})();TWP.PostTV.isTablet=(function(){return TWP.PostTV.BrowserInfo.deviceType==2})();TWP.PostTV.isDeskweb=!(TWP.PostTV.isMobile||TWP.PostTV.isTablet);TWP.PostTV.shouldNotPlayPrerollAds=typeof TWP.PostTV.shouldNotPlayPrerollAds!="undefined"?TWP.PostTV.shouldNotPlayPrerollAds:(function(){var prerollCookie=TWP.PostTV.getCookie("wapo_actmgmt"),kvs,v,kv;if(prerollCookie){kvs=prerollCookie.split("|");for(var i=0,l=kvs.length;i<l;i++){kv=kvs[i].split(":");if(kv[0]=="NO_PREROLL"){v=kv[1];break}}}return v==="1"})();TWP.PostTV.Player=(function($,undefined){return function(args){var self=this,currentVideoTitle=null,previousVideoTitle=null,playheadTimeChangedArgs={};self.create=function(){function callOoyalaCreate(){self.ooPlayer=OO.Player.create(self.playerContainerId,self.embedCode,self.ooArgs);self.playerContainer.trigger(TWP.PostTV.EVENTS.OO_PLAYER_INITIALIZED)}if(typeof window.OO!="undefined"&&OO.Player){self.preparePlayerArgs();OO.ready(function(){var $html=$("html"),pluginsToBeLoaded=$html.data("oo-plugins-to-be-loaded");if(self.ooPluginsLoaded||($.isArray(pluginsToBeLoaded)&&pluginsToBeLoaded.length==0)){self.ooPluginsLoaded=true;callOoyalaCreate()}else{$html.on(TWP.PostTV.EVENTS.OO_PLUGIN_FULLY_LOADED,function(e){$html.off(TWP.PostTV.EVENTS.OO_PLUGIN_LOADED);callOoyalaCreate()});setTimeout(function(){if(!self.ooPluginsLoaded){callOoyalaCreate()}},2000)}})}else{console.log("OO is undefined!");self.sendTrackingData("PostTV Player OO Error",["event9998"],{errorCode:"ptv_ooUndefined",errorText:"OO is undefined."})}};self.onCreate=function(player){var _cbv=window._cbv||(window._cbv=[]);_cbv.push(player);self.mb=player.mb;if(!$.isEmptyObject(self.eventHandlers)){for(var eventName in self.eventHandlers){if(self.eventHandlers.hasOwnProperty(eventName)){self.mb.subscribe(eventName,self.mbSubscriber,$.proxy(self.eventHandlers[eventName],player))}}}};self.preparePlayerArgs=function(){self.ooArgs.onCreate=self.onCreate;self.ooArgs.videoJson=self.json;self.ooArgs.methodeUuid=self.methodeUuid;if(!!self.width){self.ooArgs.width=self.width}if(!!self.height){self.ooArgs.height=self.height}if(!!self.autoplay){self.ooArgs.autoplay=!!self.autoplay}if(!isNaN(Number(self.initialTime))){self.ooArgs.initialTime=Number(self.initialTime)}if(!!self.loop){self.ooArgs.loop=!!self.loop}if(!$.isEmptyObject(self.locale)){self.ooArgs.locale=self.locale}if(!!self.hide){self.flashParams.hide=self.hide}if(!!self.wmode){self.ooArgs.wmode=self.wmode}if(!$.isEmptyObject(self.flashParams)){self.ooArgs.flashParams=self.flashParams}if(self.hasAdSetCode){self.ooArgs.adSetCode=self.allowAd==0?TWP.PostTV.blankAdSetCode:self.adSetCode}if(!!self.css){self.ooArgs.css=self.css}if(!isNaN(self.index)){self.ooArgs.playerIndex=self.index}self.ooArgs["vpaid-ads-manager"]={showAdMarquee:false}};self.play=function(){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.play()}};self.stop=function(){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.pause()}};self.skipAd=function(){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.skipAd()}};self.destroy=function(){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.destroy()}};self.setPlayheadTime=function(playheadTime){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.setPlayheadTime(playheadTime)}};self.getPlayheadTime=function(){var playheadTime=-1;if(!!self.ooPlayer&&self.playerCreated){playheadTime=self.ooPlayer.getPlayheadTime()}return playheadTime};self.setVolume=function(volume){if(!!self.ooPlayer&&self.playerCreated){self.ooPlayer.setVolume(volume)}};self.setVolumeInCookie=function(volume){if(!!self.ooPlayer&&self.playerCreated){try{TWP.PostTV.setCookie("videovolume",(volume*1).toFixed(3),new Date("1/1/2022"))}catch(e){}}};self.getVolume=function(){if(!!self.ooPlayer&&self.playerCreated){try{return self.ooPlayer.getVolume()}catch(e){}return 1}};self.getVolumeFromCookie=function(){var volume=TWP.PostTV.getCookie("videovolume");if(isNaN(parseFloat(volume))||parseFloat(volume)>=1||volume==1){volume=1}else{if(parseFloat(volume)<=0){volume=0}else{volume=(parseFloat(volume)%1).toFixed(3)}}return volume};self.isFullscreen=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||(self.$html5VideoTag[0]&&self.$html5VideoTag[0].webkitDisplayingFullscreen)};self.update=function(json,args){var isOoyala=("contentConfig" in json?json.contentConfig["isOoyalaVideo"]:false),embedCode=("contentConfig" in json?json.contentConfig["videoContentId"]:null),methodeUuid=("contentConfig" in json?json.contentConfig.uuid:""),contextPath=window.wp_pb&&wp_pb.contextPath?wp_pb.contextPath:"/"+document.location.pathname.split("/")[1],shouldDestroyWhenUpdate=TWP.PostTV.destroyWhenUpdate&&(TWP.PostTV.isDeskweb||(TWP.PostTV.BrowserInfo.OS.toLowerCase().indexOf("iphone")>-1&&!self.isFullscreen()));if(embedCode){if(!!self.ooPlayer){self.embedCode=embedCode;self.json=json;self.initAds(json);self.updateMetaFromJSON(json);args=$.extend({videoJson:json,adSetCode:self.adSetCode,hide:self.hide,methodeUuid:methodeUuid},args);if(args.isAutoPlaying){self.isAutoplaying=true}if(self.ooPlayer.adPlaying===true){self.skipAd()}if(TWP.PostTV.shouldRefreshPage){window.location.href=document.URL.indexOf("www.washingtonpost.com/posttv/")>-1?json.contentConfig.permaLinkURL:contextPath+"/c/video/"+json.contentConfig.uuid}else{if(args.selfDestruct&&shouldDestroyWhenUpdate){self.playerContainer.removeClass("ooyala-player-processed").addClass("ooyala-player");self.mb.subscribe(OO.EVENTS.DESTROY,"posttvOoyalaPlayer",$.proxy(function(evt,args){TWP.PostTV.initInlinePlayer(self.playerContainer[0],{json:json});self.mb.unsubscribe(OO.EVENTS.DESTROY)}),self);self.destroy()}else{self.mb.publish(TWP.PostTV.EVENTS.WILL_CHANGE_EMBED_CODE,args);self.playerContainer.trigger(TWP.PostTV.EVENTS.WILL_CHANGE_EMBED_CODE,args);self.ooPlayer.setEmbedCode(self.embedCode,args)}}if(self.$html5VideoTag){self.$html5VideoTag.load()}try{if(typeof(TWP.PostTV.attributes.playerEmbedType)!==undefined){args.updateURL=false}}catch(e){}if(args.updateURL){try{history.pushState({},json.contentConfig.title,json.contentConfig.permaLinkURL);document.title=json.contentConfig.title}catch(e){console.error(e.stack)}}if(typeof args.callback==="function"){args.callback.call()}}}else{if(!isOoyala||!embedCode){self.errorCode="notOoyalaVideo";self.errorText="This doesn't look like an Ooyala video!";self.ooPlayer.mb.publish(OO.EVENTS.ERROR)}else{self.errorCode="invalidJson";self.errorText="Invalid video json. Unable to update Ooyala player.";self.ooPlayer.mb.publish(OO.EVENTS.ERROR)}}return self};self.onPlayNextVideo=function(evt,args){var json=args.json,ajaxUrl;if($.isEmptyObject(json)){if(args.methodeUuid){$.ajax({type:"GET",url:ajaxUrl="http://www.washingtonpost.com/posttv/c/videojson/"+args.methodeUuid,contentType:"application/json",jsonpCallback:"cb_"+args.methodeUuid.replace(/-/g,""),data:{resType:"jsonp"},dataType:"jsonp",cache:true,success:function(data){self.update(data[0],args)},error:function(e){if(typeof window.console==="function"){console.error("Failed to fetch video data for video: "+args.methodeUuid+", e: "+e.message)}self.sendTrackingData("PostTV Player Error",["event999"],{errorCode:"ptv_cannotRetrieveVideoJson",errorText:"Cannot retrieve video json data at: "+ajaxUrl})}})}else{console.error("At least one of video json or uuid is required for updating the player to play the next video.");self.sendTrackingData("PostTV Player Data Error",["event999"],{errorCode:"ptv_unableToPlayNextVideo",errorText:"At least one of video json or uuid is required for updating the player to play the next video."})}}else{self.update(json,args)}};self.handleTrackingData=function(evt,args){if(args&&args.evtName&&args.evtType){self.sendTrackingData(args.evtName,args.evtType,args)}};self.resize=function(args){args=$.extend({selectorsToResize:".innerWrapper, #"+self.playerContainerId,duration:400},args);args.w=(!isNaN(args.w))?args.w:self.playerContainer.parent().width();args.h=(!isNaN(args.h))?args.h:Math.round(args.w*(270/480));$(args.selectorsToResize,self.playerContainer.parent()).each(function(i){$(this).animate({width:args.w+"px",height:args.h+"px"},{duration:args.duration,step:function(currentValue,o){if(o.prop=="width"){$(args.selectorsToResize,self.playerContainer.parent()).width(currentValue)}else{if(o.prop=="height"){$(args.selectorsToResize,self.playerContainer.parent()).height(currentValue)}}}})});return self};self.initAds=function(json){var adSetConfig,d_ad,t_ad,m_ad,nbf_ad;if(typeof json=="undefined"){json={}}else{adSetConfig=json.adConfig&&json.adConfig.adSetConfig&&!$.isEmptyObject(json.adConfig.adSetConfig)?json.adConfig.adSetConfig:adSetConfig;if(adSetConfig&&!$.isEmptyObject(adSetConfig.adSetCodes)){d_ad=adSetConfig.adSetCodes.desktop||"";t_ad=adSetConfig.adSetCodes.tablet||"";m_ad=adSetConfig.adSetCodes.mweb||"";nbf_ad=adSetConfig.adSetCodes.noBackFilled||""}}self.showCompanionAdIfAny=(typeof args.showCompanionAdIfAny!="undefined"?args.showCompanionAdIfAny:0);self.allowAd=!isNaN(parseInt(args.allowAd))&&(parseInt(args.allowAd)+1) in [0,1,2]?parseInt(args.allowAd):self.getAllowAd(json);self.ads={adZone:args.adZone||("adConfig" in json&&json.adConfig.videoAdZone?json.adConfig.videoAdZone:"wpni.video.oodef"),adParameters:args.adParameters||("adConfig" in json?json.adConfig.adParameters:null),adURL:args.adURL||("adConfig" in json?json.adConfig.adURL:null),companionAds:self.ads&&self.ads.companionAds?self.ads.companionAds:undefined,format:"",source:"",state:""};if(self.allowAd===0){self.adSetCode=TWP.PostTV.blankAdSetCode}else{if(args.adSetCode){self.adSetCode=args.adSetCode}else{if(TWP.PostTV.isMobile){self.adSetCode=m_ad}else{if(TWP.PostTV.isTablet){self.adSetCode=t_ad}else{if(self.isAutoplaying&&nbf_ad){self.isAutoplaying=false;self.adSetCode=nbf_ad}else{self.adSetCode=d_ad}}}}}self.hasAdSetCode=!!self.adSetCode;self.adLengthParam=args.adLengthParam||"vid=15;vid=30;";self.adSzParam=args.adSzParam||"sz=640x480;";return self};self.getAllowAd=function(json){var a=-1,isEligibleForAPreRoll=!TWP.PostTV.getPreRollsBlocked()&&"adConfig" in json&&!!json.adConfig.playVideoAds,isDueForAPreRoll,hasPreRoll,forceAd=("adConfig" in json?!!json.adConfig.forceAd:false);if(isEligibleForAPreRoll&&!TWP.PostTV.shouldNotPlayPrerollAds){if(forceAd){if(TWP.PostTV.getCount()%2==0){TWP.PostTV.incrementCount()}}else{if(self.showAdsForFirstVideoOnly){if(!self.showedAdsForFirstVideo){self.showedAdsForFirstVideo=true}else{a=0}}else{self.showCompanionAdIfAny=(typeof self.showCompanionAdIfAny!="undefined"?self.showCompanionAdIfAny:0);self.adFreq=(typeof args.adFreq!="undefined"?args.adFreq:TWP.PostTV.adFrequency);if(!isNaN(parseInt(self.adFreq))&&!isNaN(parseFloat(self.adFreq))){self.adFreq=eval(self.adFreq)}if(isNaN(self.adFreq)||self.adFreq<0||self.adFreq>1){self.adFreq=TWP.PostTV.adFrequency}if(self.adFreq==0){self.adFreq=1/1000000000}var inverseAdFreq=1/self.adFreq;isDueForAPreRoll=self.adFreq!=0&&((TWP.PostTV.getCount()%inverseAdFreq)<1);hasPreRoll=isEligibleForAPreRoll&&isDueForAPreRoll;if((hasPreRoll||(!hasPreRoll&&!isDueForAPreRoll))){TWP.PostTV.incrementCount()}a=hasPreRoll?-1:0;self.showCompanionAdIfAny=TWP.PostTV.isMobile?self.showCompanionAdIfAny:self.showCompanionAdIfAny&&hasPreRoll}}}else{a=0;self.showCompanionAdIfAny=0}return a};self.updateMetaFromJSON=function(json){if(typeof json=="undefined"){json={}}self.meta={uuid:("contentConfig" in json?json.contentConfig.uuid:""),title:args.title||("contentConfig" in json?json.contentConfig.title:""),description:args.description||("contentConfig" in json?json.contentConfig.blurb:""),section:args.section||("metaConfig" in json?json.metaConfig.section:""),subsection:args.subsection||("metaConfig" in json?json.metaConfig.subsection:""),hasCorrection:("contentConfig" in json?json.contentConfig.hasCorrection:false),correction:("contentConfig" in json?json.contentConfig.correction:null),hasClarification:("contentConfig" in json?json.contentConfig.hasClarification:false),clarification:("contentConfig" in json?json.contentConfig.clarification:null),permaLinkURL:("contentConfig" in json?json.contentConfig.permaLinkURL:null),commentsURL:("contentConfig" in json?json.contentConfig.commentsURL:null),emailURL:("contentConfig" in json?json.contentConfig.emailURL:null),embedURL:("contentConfig" in json?json.contentConfig.embedURL:null),imageThumbnailURL:("promoImage" in json&&typeof json.promoImage.image!="undefined"&&json.promoImage.image!=null&&json.promoImage.image.url!="undefined"?json.promoImage.image.url:null),ooyalaPlayerURL:("contentConfig" in json?json.contentConfig.playerURL:null),ooyalaPlayerSecureURL:("contentConfig" in json?"https://player.ooyala.com/player_v2.swf?keepEmbedCode=true&autoplay=1&embedCode="+json.contentConfig["videoContentId"]:null),relatedLinks:null,tags:("metaConfig" in json?json.metaConfig.tags:null),credits:[]};if("contentConfig" in json&&json.contentConfig.dateConfig&&json.contentConfig.dateConfig.displayDate){var displayDate=new Date(json.contentConfig.dateConfig.displayDate);self.meta.displayDate=displayDate.toDateString()}else{self.meta.displayDate=""}if("contentConfig" in json&&json.contentConfig.relatedLinks&&json.contentConfig["relatedLinks"].length>0){var relatedLinks=[];$.each(json.contentConfig.relatedLinks,function(i,relatedLink){if(relatedLink.url&&relatedLink.title){relatedLinks.push('<li><a type="resource" href="'+relatedLink.url+'">'+relatedLink.title+"</a></li>")}});self.meta.relatedLinks=relatedLinks.join("");self.meta.relatedLinksAsArray=relatedLinks}if("contentConfig" in json&&json.contentConfig.credits){self.meta.credits={editor:json.contentConfig.credits.editor,source:json.contentConfig.credits.source}}return self};self.eventHandlers={playerCreated:function(evt,playerContainerId,params){self.playerCreated=true;self.innerWrapper=$("#"+playerContainerId).find(".innerWrapper");if(!TWP.PostTV.isFlashEnabled&&typeof self.$html5VideoTag=="undefined"){self.$html5VideoTag=self.innerWrapper.find("video")}$(window).on("resize orientationchange",self.resizePlayer);if(typeof self.callbacks.playerCreated=="function"){self.callbacks.playerCreated(self)}self.bindAdBlocker();self.playerContainer.trigger(TWP.PostTV.EVENTS.PLAYER_CREATED,params).trigger(TWP.PostTV.EVENTS.WILL_CHANGE_EMBED_CODE,params);self.mb.publish(TWP.PostTV.EVENTS.WILL_CHANGE_EMBED_CODE,params);self.loadChartbeatVideoScript();self.sendTrackingData("Player Created",["event110"],{splunkOnly:true})},embedCodeChanged:function(evt){var params={};if(!self.isContentViewed){if(self.trackingLevel=="player-default-tracking"){self.sendTrackingData("Content View",["event30"],params)}self.isContentViewed=true}self.clearAdsCountdown();self.showedCompanionAd=false;self.removeCompanionAd();self.playStartTriggered=false;self.hasPlayedAds=false;self.isPlayingAds=false;self.companionAdsDisplayed=false;self.initProgress();if(typeof self.callbacks.embedCodeChanged=="function"){self.callbacks.embedCodeChanged(self)}if(!$.isEmptyObject(self.json)){self.playerContainer.data("videoJson",self.json)}},contentTreeFetched:function(evt){self.setVolume(self.volume);if(typeof self.callbacks.contentTreeFetched=="function"){self.callbacks.contentTreeFetched(self)}self.sendTrackingData("Video Data Fetched",["event111"],{splunkOnly:true});self.playerContainer.trigger(TWP.PostTV.EVENTS.CONTENT_TREE_FETCHED)},willPlayFromBeginning:function(evt){if(self.hasPlayedAds&&!self.isPlayingAds&&!self.playStartTriggered){self.mb.publish(TWP.PostTV.EVENTS.EDITORIAL_PLAY_STARTED);self.playerContainer.trigger(TWP.PostTV.EVENTS.EDITORIAL_PLAY_STARTED);self.preventHpRefresh();self.playStartTriggered=true;if(typeof self.callbacks.editorialPlayStarted=="function"){self.callbacks.editorialPlayStarted(self)}if(self.trackingLevel=="player-default-tracking"){self.trackProgress("0")}}},error:function(evt,error){var errorCode=self.errorCode?self.errorCode:error.code,errorText=self.errorText?self.errorText:self.ooPlayer?self.ooPlayer.getErrorText():"";self.sendTrackingData("Ooyala Player Error",["event9999"],{errorCode:errorCode,errorText:errorText});self.addMsg({msg:errorCode,className:"ptv-error-msg",time:10000});if(typeof window.console==="function"){console.log("Ooyala Player Error Code: "+errorCode+", errorText: "+errorText)}if(typeof self.callbacks.videoError=="function"){self.callbacks.videoError(self)}self.errorCode="";self.errorText="";self.playerContainer.trigger(TWP.PostTV.EVENTS.ERROR,error)},playheadTimeChanged:function(evt,time,duration,buffer){self.playheadTime=this.getPlayheadTime();self.time=this.getTotalTime();if(self.trackingLevel=="player-default-tracking"){self.trackProgress()}if(typeof self.callbacks.playheadTimeChanged=="function"){self.callbacks.playheadTimeChanged(self)}playheadTimeChangedArgs.time=self.playheadTime;playheadTimeChangedArgs.duration=self.time;playheadTimeChangedArgs.buffer=buffer;playheadTimeChangedArgs.playStarted=self.playStartTriggered;self.playerContainer.trigger(TWP.PostTV.EVENTS.PLAYHEAD_TIME_CHANGED,playheadTimeChangedArgs)},playbackReady:function(evt){self.sendTrackingData("Player Controls Ready",["event112"],{splunkOnly:true});self.playerContainer.trigger(TWP.PostTV.EVENTS.PLAYBACK_READY)},buffering:function(evt){self.sendTrackingData("Player buffering",["event113"],{splunkOnly:true})},buffered:function(evt){self.sendTrackingData("Player buffered",["event114"],{splunkOnly:true})},volumeChanged:function(evt){self.previousCookieVolume=self.getVolumeFromCookie();self.volume=this.getVolume();self.setVolumeInCookie(self.volume);if(typeof self.callbacks.volumeChanged=="function"){self.callbacks.volumeChanged(self)}self.playerContainer.trigger(TWP.PostTV.EVENTS.VOLUME_CHANGED)},playing:function(evt){if((!self.hasPlayedAds||(self.hasPlayedAds&&!self.isPlayingAds))&&!self.playStartTriggered){self.mb.publish(TWP.PostTV.EVENTS.EDITORIAL_PLAY_STARTED);self.playerContainer.trigger(TWP.PostTV.EVENTS.EDITORIAL_PLAY_STARTED);self.preventHpRefresh();self.playStartTriggered=true;if(typeof self.callbacks.editorialPlayStarted=="function"){self.callbacks.editorialPlayStarted(self)}if(self.trackingLevel=="player-default-tracking"){self.trackProgress("0")}}},played:function(evt){if(typeof self.callbacks.playCompleted=="function"){self.callbacks.playCompleted(self)}if(self.trackingLevel=="player-default-tracking"){self.trackProgress("100")}self.allowHpRefresh();self.playStartTriggered=false;self.switchVideo=true;self.playerContainer.trigger(TWP.PostTV.EVENTS.PLAY_COMPLETED)},willPlayAds:function(evt,adData){if(!self.isPlayingAds){self.isPlayingAds=true;self.hasPlayedAds=true;self.preventHpRefresh();self.ads.duration=(function(data){var r=0;if(data===undefined){return r}if(data.duration!=undefined){return parseInt(data.duration)}if(data.durationInMilliseconds!=undefined){r=parseInt(data.durationInMilliseconds/1000)}return r})(adData);if(typeof self.callbacks.adStarted=="function"){self.callbacks.adStarted(self)}if(self.trackingLevel=="player-default-tracking"){self.sendTrackingData("Video Ad Start",["event7"])}self.playerContainer.trigger(TWP.PostTV.EVENTS.AD_STARTED)}},willShowCompanionAds:function(evt,companionAds){if(!self.companionAdsDisplayed){self.companionAdsDisplayed=true;self.hasCompanionAd=companionAds.ads&&companionAds.ads.length>0;self.ads.companionAds=companionAds.ads;if(typeof self.callbacks.companionAds=="function"){self.callbacks.companionAds(self)}self.mb.publish(TWP.PostTV.EVENTS.COMPANION_ADS_DISPLAYED);self.playerContainer.trigger(TWP.PostTV.EVENTS.COMPANION_ADS_DISPLAYED)}},adsPlayed:function(evt){self.isPlayingAds=false;self.companionAdsDisplayed=false;if(typeof self.callbacks.adCompleted=="function"){self.callbacks.adCompleted(self)}if(self.trackingLevel=="player-default-tracking"){if(self.skipAdLinkClicked){self.skipAdLinkClicked=false;self.sendTrackingData("Skip Ad Button Clicked",["event34"]);console.log("skip ad button clicked.")}else{self.sendTrackingData("Video Ad Complete",["event8"]);console.log("video ad completed")}}self.allowHpRefresh();self.mb.publish(TWP.PostTV.EVENTS.ADS_CLEARED);self.playerContainer.trigger(TWP.PostTV.EVENTS.ADS_CLEARED)},willChangeFullscreen:function(evt){},fullscreenChanged:function(evt){}};self.eventHandlers[TWP.PostTV.EVENTS.CAST_NEXT_VIDEO]=function(evt){self.playerContainer.trigger(TWP.PostTV.EVENTS.CAST_NEXT_VIDEO)};self.addMsg=function(params){var $msgBox=self.innerWrapper.find(".ptv-msg-box").length>0?self.innerWrapper.find(".ptv-msg-box"):self.innerWrapper,$msg=$("<div>"+params.msg+"</div>"),time=typeof params.time==="undefined"?2000:params.time;if(params.className){$msg.addClass(params.className)}if(params.css){$msg.css(params.css)}$msgBox.append($msg);if($msgBox.css("display")==="none"){$msgBox.show()}$msg.fadeOut(time,function(){$msg.remove();if($msgBox.is(":empty")){$msgBox.hide()}})};self.bindAdBlocker=function(){var stringContainsIpRegex=/.*(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).*/g,isLocal=document.URL.indexOf("localhost")>-1||stringContainsIpRegex.test(document.URL),param={className:"ptv-ad-blocker"};self.innerWrapper.on("mouseenter.adBlocker",function(mouseenter){var $this=$(this),$document=$(document),value="";$document.off("keypress.adblocker").on("keypress.adblocker",function(e){value+=String.fromCharCode(e.which);if(/ads/i.test(value)){TWP.PostTV.togglePreRollsBlocked({expires:new Date("1/1/2022").toGMTString()});if(!!TWP.PostTV.getPreRollsBlocked()||isLocal){param.msg="Ads disabled";TWP.PostTV.players[self.playerContainerId].skipAd()}else{param.msg="Ads enabled"}self.addMsg(param);value=""}e.stopPropagation()});$this.on("mouseleave.adBlocker",function(e){$document.off("keypress.adblocker");$this.off("mouseleave.adBlocker");value=""})})};self.bindBlurEvents=function(){$(window).on("focus",function(){self.stop()});$(window).on("blur",function(){self.stop()})};self.unbindBlurEvents=function(){$(window).off("focus blur")};self.clearAdsCountdown=function(){var $adMsg=$("#"+self.playerContainerId).find(".oo_ads_countdown");if($adMsg.length>0&&$adMsg.css("display")!="none"){$adMsg.css("display","none")}};self.preventHpRefresh=function(){try{if(!self.isModal){TWP.hpRefreshTests[self.playerContainerId]=function(){return false}}}catch(e){}};self.allowHpRefresh=function(){try{if(!self.isModal){delete TWP.hpRefreshTests[self.playerContainerId]}}catch(e){}};self.trackProgress=function(key){if(self.playStartTriggered){key=key!=null?key:Math.round(100*Math.floor((self.playheadTime/self.time)*self.progressIntervals)/self.progressIntervals);if(key in self.progress&&!self.progress[key].triggered){self.progress[key].triggered=true;self.sendTrackingData(self.progress[key].tracking.linkName,self.progress[key].tracking.event,self.progress[key].tracking.props)}}};self.initProgress=function(){self.progress={};for(var i=0;i<=self.progressIntervals;i++){var key=""+Math.round(100*i/self.progressIntervals),linkName,event,props;switch(key){case"0":linkName="Video Start";event="event9";props={};break;case"25":linkName="Video 25% Complete";event="event10";props={};break;case"50":linkName="Video 50% Complete";event="event11";props={};break;case"75":linkName="Video 75% Complete";event="event12";props={};break;case"100":linkName="Video Complete";event="event13";props={};break;default:linkName="";event="";props={};break}self.progress[key]={triggered:false,tracking:{linkName:linkName,event:event,props:props}}}};self.canShowCompanionInPlayer=function(){return !TWP.PostTV.isMobile&&self.playerContainer.width()>700};self.resizePlayer=function(){var newPlayerContainerWidth=self.playerContainer.width(),newPlayerContainerHeight=newPlayerContainerWidth*9/16;self.playerContainer.css("padding",0).css("height",newPlayerContainerHeight+"px");if(self.canShowCompanionInPlayer()){if(self.companionAdContainer){if(self.companionAdContainer.parent().length==0){self.insertCompanionAd();self.showCompanionAd()}else{self.companionAdContainer.show()}self.resizeInnerWrapper({showCompanionAd:true})}else{self.resizeInnerWrapper()}}else{if(self.companionAdContainer&&self.companionAdContainer.css("display")!="none"){self.companionAdContainer.hide()}self.resizeInnerWrapper()}};self.resizeInnerWrapper=function(params){if(self.innerWrapper){if(params&&params.showCompanionAd){var newInnerWrapperWidth=self.getPreRollWidth(),newInnerWrapperHeight=newInnerWrapperWidth*9/16,newMarginTop=Math.abs(newInnerWrapperHeight)*-0.5;self.innerWrapper.css("margin-top",newMarginTop).css("top","50%").width(newInnerWrapperWidth).height(newInnerWrapperHeight)}else{self.innerWrapper.css("margin-top","0").css("top","0").width("100%").height("100%")}if(self.isPlayingAds){self.playerContainer.trigger(TWP.PostTV.EVENTS.NEED_RESIZE_VIDEO_ELEMENT,self.isPlayingAds)}}};self.prepareCompanionAd=function(options){self.showCompanionInPlayer=!(options.companionAdParentId||options.companionAdParentClassName);self.serveCompanionAd=self.showCompanionAdIfAny&&(self.showCompanionInPlayer?self.canShowCompanionInPlayer():true)&&self.hasCompanionAd;if(self.serveCompanionAd&&!self.companionAdContainer){options=options||{};self.createCompanionAdContainer(options);if(options.companionAdParentId){$("#"+options.companionAdParentId).prepend(self.companionAdContainer)}else{if(options.companionAdParentClassName){$("."+options.companionAdParentClassName).prepend(self.companionAdContainer)}else{self.insertCompanionAd()}}}};self.insertCompanionAd=function(){if(self.serveCompanionAd){var clearTag=document.createElement("div");clearTag.className="companion-ad-clear-both";clearTag.style.clear="both";clearTag.style.width="auto";clearTag.style.height="auto";self.needResizePlayer=true;var preRollWidth=self.getPreRollWidth(),preRollHeight=preRollWidth*9/16,preRollMarginTop=Math.abs(preRollHeight)*-0.5;self.originalPlayerContainerHeight=self.playerContainer.height();self.innerWrapper.width(preRollWidth).height(preRollHeight).css("margin-top",preRollMarginTop).css("top","50%").css("float","left");if(self.playerContainer.height()!=self.originalPlayerContainerHeight){self.playerContainer.height(self.originalPlayerContainerHeight)}self.playerContainer.append(self.companionAdContainer).append(clearTag)}};self.createCompanionAdContainer=function(options){var companionAdContainerId=self.playerContainerId+"-companion-ad";if($("#"+companionAdContainerId).length){$("#"+companionAdContainerId).remove()}self.companionAdContainer=$('<div id="'+companionAdContainerId+'"></div>');if(options.companionClassName){self.companionAdContainer.addClass(options.companionClassName)}if(options.style&&isJSONObject(options.style)){self.companionAdContainer.css(options.style)}else{if(!self.showCompanionInPlayer){self.companionAdContainer.css({position:"absolute",height:"100%",width:"100%","z-index":100,"background-color":"#303030"})}}self.companionAdContainer.hide()};self.showCompanionAd=function(){if(self.serveCompanionAd&&!self.showedCompanionAd){var i=self.ads.companionAds.length-1;TWP.PostTV.ooyalaVASTCompanionAds.show(self.companionAdContainer.attr("id"),self.ads.companionAds[i],self.ads.companionAds[i].width||320,self.ads.companionAds[i].height||250);if(self.isPlaylist){self.companionAdContainer.slideDown("slow")}else{self.companionAdContainer.show()}self.showedCompanionAd=true;if(self.showCompanionInPlayer){self.resizePlayer()}else{self.companionAdContainer.find("img, iframe").css({position:"absolute",margin:"auto",top:0,bottom:0,left:0,right:0})}self.companionAdContainer.on("click.companionAdClicked",function(e){self.mb.publish(OO.EVENTS.PAUSE,{showPlayButton:true})})}};self.removeCompanionAd=function(){if(self.serveCompanionAd){if(self.companionAdContainer){self.companionAdContainer.off("click.companionAdClicked")}if(self.needResizePlayer){if(self.companionAdContainer){self.companionAdContainer.hide()}self.playerContainer.css("padding",0).css("height",self.playerContainer.width()*9/16+"px");self.innerWrapper.css("margin-top","").css("top","0").width("100%").height(self.innerWrapper.width()*9/16);self.needResizePlayer=false}else{if(self.companionAdContainer){self.companionAdContainer.slideUp()}}self.companionAdContainer=undefined;self.playerContainer.find(".companion-ad-clear-both").remove();self.showedCompanionAd=false;self.serveCompanionAd=false}};self.getPlayerContainerWidth=function(){return self.playerContainer.width()};self.getPreRollWidth=function(){var playerContainerWidth=self.getPlayerContainerWidth(),companionAdContainerWidth=340;return playerContainerWidth-companionAdContainerWidth>0?playerContainerWidth-companionAdContainerWidth:0};function isJSONObject(object){var isJson=false;try{var json=$.parseJSON(object);isJson=true}catch(e){}return isJson}self.imageForNielsenBeacon=null;self.getSectionAsPrefix=function(){var sectionAsPrefix=self.meta.section.toLowerCase();if(/^\/([^\/]+)/.test(sectionAsPrefix)){sectionAsPrefix=(RegExp.$1).toLowerCase()}sectionAsPrefix+=(!!sectionAsPrefix)?":":"";return sectionAsPrefix};self.getEstDateString=function(epoch){var localDate=new Date(epoch),estDate=new Date(epoch+localDate.getTimezoneOffset()*60000-300*60000),month=estDate.getMonth()+1;return month+"/"+estDate.getDate()+"/"+estDate.getFullYear()};self.getParentTrackingData=function(){if(typeof self.parentTrackingData==="undefined"&&window!=window.parent){try{if(typeof window.parent.s!="undefined"){self.parentTrackingData={channel:window.parent.s.channel,type:window.parent.s.prop3,pageName:window.parent.s.pageName}}}catch(e){}}};self.getTrackingData=function(params){var sectionAsPrefix=self.getSectionAsPrefix(),isLiveEvent=!!self.json.liveEventConfig,uuidToken,dateString=self.getEstDateString(self.json.contentConfig.dateConfig.displayDate),credit=self.meta.credits?self.meta.credits:{},undefined;if(isLiveEvent){uuidToken=self.json.liveEventConfig.uuid.split("-")[self.json.liveEventConfig.uuid.split("-").length-1]}else{uuidToken=self.meta.uuid?self.meta.uuid.split("-")[self.meta.uuid.split("-").length-1]:""}if(params===undefined){params={}}if(self.switchVideo){previousVideoTitle=currentVideoTitle;self.switchVideo=undefined}currentVideoTitle=sectionAsPrefix+"video - "+uuidToken+" - "+dateString+" - "+(self.meta.title?self.meta.title.toLowerCase().replace(/[^\w\s[_,.-]]|'/gi,"").replace("%27",""):"no title");var isAd=!!self.isPlayingAds;var duration=0!==self.time&&isFinite(self.time)?self.time:self.json.contentConfig.videoDuration/1000;var order=!!self.json.metaConfig?self.json.metaConfig.order:0;if(order===0||order===null||!isFinite(order)){order=!!self.json.showsConfig&&self.json.showsConfig.length>0?self.json.showsConfig[0].clipDisplayOrder:0}self.getParentTrackingData();return $.extend({sessionId:TWP.PostTV.getCookie("s_vi"),page:self.parentTrackingData&&self.parentTrackingData.pageName?self.parentTrackingData.pageName:currentVideoTitle,channel:self.parentTrackingData&&self.parentTrackingData.channel?self.parentTrackingData.channel:"wp - posttv",video:currentVideoTitle,title:currentVideoTitle,type:self.parentTrackingData&&self.parentTrackingData.type?self.parentTrackingData.type:"video",section:(!!self.meta.section)?self.meta.section.toLowerCase():"",subsection:(!!self.meta.subsection)?self.meta.subsection.toLowerCase():"",source:(!!credit.source)?credit.source.toLowerCase():"",videoName:(!!credit.editor)?credit.editor.toLowerCase():"",userInfo:TWP.PostTV.BrowserInfo.OS.toLowerCase()+" "+TWP.PostTV.BrowserInfo.browser.toLowerCase()+" v"+TWP.PostTV.BrowserInfo.version,browser:TWP.PostTV.BrowserInfo.browser.toLowerCase(),os:TWP.PostTV.BrowserInfo.OS.toLowerCase(),browserVersion:TWP.PostTV.BrowserInfo.version,flashVersion:typeof swfobject==="undefined"?"n/a":swfobject.getFlashPlayerVersion().major+"."+swfobject.getFlashPlayerVersion().minor+"."+swfobject.getFlashPlayerVersion().release,previousVideo:previousVideoTitle,adsDuration:self.ads.duration?self.ads.duration:"",playerType:self.playerType,videoType:self.isLiveStream?"livestream":"vod",isLiveStream:self.isLiveStream||isLiveEvent||self.json.contentConfig.type==="live",isAd:isAd,adSetCode:self.adSetCode,isFullEpisode:self.json.contentConfig.type==="episode",isClip:!isAd&&self.json.contentConfig.type==="clip",segment:order,durationInSeconds:isAd?self.ads.duration:Math.round(duration),countOfClips:0},params)};self.sendTrackingData=function(n,e,params){var t=self.getTrackingData(params);self.sendDataToSplunk(n,e,t);if(!t.splunkOnly){self.sendDataToOmniture(n,e,t);self.sendDataToNielsen(n,e,t)}return self};self.equalsOrIsInArray=function(stringVal,arrayOrString){return(arrayOrString===stringVal)||($.isArray(arrayOrString)&&(-1!=$.inArray(stringVal,arrayOrString)))};self.sendDataToNielsen=function(n,e,params){var isAd=self.equalsOrIsInArray("event7",e);var isContent=!isAd&&self.equalsOrIsInArray("event9",e);if(isContent){var titleParamPrefix="&tl=dav0-";var sectionAsPrefix=self.getSectionAsPrefix();var currentVideoTitle=(!!self.meta.title)?sectionAsPrefix+self.meta.title.toLowerCase():"";var currentVideoCategory="";var paramCi="ci=us-904793";var paramC6="&c6=vc,b01";var paramCc="&cc=1";var paramRnd="&rnd="+Math.ceil(Math.random()*1000000000);var paramTl="&tl=dav0-"+encodeURIComponent(currentVideoTitle);var paramCg="&cg="+encodeURIComponent(currentVideoCategory);var optionalParams="";var url="http://secure-us.imrworldwide.com/cgi-bin/m?"+paramCi+paramC6+paramCc+paramRnd+paramTl+paramCg+optionalParams;self.imageForNielsenBeacon="";self.imageForNielsenBeacon=new Image();self.imageForNielsenBeacon.src=url}};self.sendDataToOmniture=function(n,e,params){if(!!window.s&&typeof s.sendDataToOmniture=="function"&&!!params){try{var data=$.extend({eVar1:params.page,eVar2:params.channel,eVar6:params.video,eVar13:params.title,eVar17:params.type,eVar41:params.section,eVar42:params.source,eVar43:params.videoName,eVar44:params.userInfo,eVar45:s._referrer?s._referrer.toLowerCase():"",eVar46:params.previousVideo,eVar47:params.subsection,eVar48:params.adsDuration,eVar49:params.playerType,prop19:params.evtAction?"posttv - "+params.evtModule+" - "+params.evtAction:""},self.appendToOmniture,params);n=n||"";e=e||[];s.sendDataToOmniture(n,e,data)}catch(e){console.log("Unable to send tracking data to omniture: "+e.stack)}}return self};self.sendDataToSplunk=function(n,e,params){if(!!params){try{e=typeof e=="undefined"?"":typeof e=="string"?e:$.isArray(e)?e[0]:"";$.ajax({url:"http://videotracker.washingtonpost.com/index.html",dataType:"jsonp",cache:false,data:{browser:params.browser,os:params.os,browserVersion:params.browserVersion,flashVersion:params.flashVersion,sessionId:params.sessionId,page:params.page,channel:params.channel,video:params.title,videoId:self.methodeUuid,videoName:params.title,videoType:params.videoType,videoSource:params.source,type:params.type,section:params.section,url:document.URL,HTTP_REFERER:document.referrer,adsDuration:params.adsDuration,playerType:params.playerType,adSetCode:params.adSetCode,evtName:n,evtType:typeof e=="string"?e:e[0]||"",evtAction:params.evtAction,evtGroup:params.evtGroup,evtModule:params.evtModule,evtTime:params.evtTime||new Date().getTime(),targetUrl:params.targetUrl,errorCode:params.errorCode,errorText:params.errorText}})}catch(e){console.log("Unable to send tracking data: "+e.stack)}}};self.loadChartbeatVideoScript=function(){window._sf_async_config=window._sf_async_config||{uid:19624,domain:"washingtonpost.com"};_sf_async_config.sections=(typeof wp_section=="string")?wp_section:(window.TWP&&TWP.Data&&TWP.Data.Tracking&&TWP.Data.Tracking.props)?TWP.Data.Tracking.props.section:"no category";_sf_async_config.path=document.location.pathname;_sf_async_config.useCanonical=true;_sf_async_config.title=(window.TWP&&TWP.Data&&TWP.Data.Tracking&&TWP.Data.Tracking.props)?TWP.Data.Tracking.props.headline:self.meta.title;_sf_async_config.videoType="ooyala";var e=document.createElement("script");e.setAttribute("language","javascript");e.setAttribute("type","text/javascript");e.setAttribute("src","//static.chartbeat.com/js/chartbeat_video.js");document.body.appendChild(e)};self.updateMetaTag=function(params){if($(params.selector).length>0){$(params.selector).attr("content",params.content)}else{var opts={};opts[params.nameAttr]=params.name;opts.content=params.content;$("<meta/>",opts).appendTo("head")}};self.updateOgMeta=function(){self.updateMetaTag({selector:"meta[property=og\\:title]",nameAttr:"property",name:"og:title",content:self.meta.title.replace("'","'")});self.updateMetaTag({selector:"meta[property=og\\:url]",nameAttr:"property",name:"og:url",content:self.meta.permaLinkURL});self.updateMetaTag({selector:"meta[property=og\\:image]",nameAttr:"property",name:"og:image",content:self.meta.imageThumbnailURL});self.updateMetaTag({selector:"meta[property=og\\:description]",nameAttr:"property",name:"og:description",content:self.meta.description});self.updateMetaTag({selector:"meta[property=og\\:video]",nameAttr:"property",name:"og:video",content:self.meta.ooyalaPlayerURL});self.updateMetaTag({selector:"meta[property=og\\:video\\:secure_url]",nameAttr:"property",name:"og:video:secure_url",content:encodeURIComponent(self.meta.ooyalaPlayerSecureURL)});$("link[rel=image_src]").attr("href",self.meta.imageThumbnailURL)};self.updateTwitterMeta=function(){if($("meta[name=twitter\\:player]").length==0){if($("meta[name=twitter\\:card]").length>0){$("meta[name=twitter\\:card]").remove()}if($("meta[name=twitter\\:site]").length>0){$("meta[name=twitter\\:site]").remove()}}self.updateMetaTag({selector:"meta[name=twitter\\:card]",nameAttr:"name",name:"twitter:card",content:"player"});self.updateMetaTag({selector:"meta[name=twitter\\:title]",nameAttr:"name",name:"twitter:title",content:self.meta.title.replace("'","'")});self.updateMetaTag({selector:"meta[name=twitter\\:description]",nameAttr:"name",name:"twitter:description",content:self.meta.description});self.updateMetaTag({selector:"meta[name=twitter\\:image]",nameAttr:"name",name:"twitter:image",content:self.meta.imageThumbnailURL});self.updateMetaTag({selector:"meta[name=twitter\\:player]",nameAttr:"name",name:"twitter:player",content:"https://player.ooyala.com/tframe.html?ec="+self.embedCode+"&pbid=MDE1ODY5NGFhMjJmMTVkNTk3OWQ2NDg5"});self.updateMetaTag({selector:"meta[name=twitter\\:player\\:width]",nameAttr:"name",name:"twitter:player:width",content:"435"});self.updateMetaTag({selector:"meta[name=twitter\\:player\\:height]",nameAttr:"name",name:"twitter:player:height",content:"251"});self.updateMetaTag({selector:"meta[name=twitter\\:site]",nameAttr:"name",name:"twitter:site",content:"@postpolitics"})};self.onPlayerCreated=function(callback){self.callbacks.playerCreated=callback;return self};self.onEmbedCodeChanged=function(callback){self.callbacks.embedCodeChanged=callback;return self};self.onContentTreeFetched=function(callback){self.callbacks.contentTreeFetched=callback;return self};self.onPlayStarted=function(callback){self.callbacks.editorialPlayStarted=callback;return self};self.onPlayCompleted=function(callback){self.callbacks.playCompleted=callback;return self};self.onCompanionAdsReady=function(callback){self.callbacks.companionAds=callback;return self};self.onAdStarted=function(callback){self.callbacks.adStarted=callback;return self};self.onAdCompleted=function(callback){self.callbacks.adCompleted=callback;return self};self.onPlayheadTimeChanged=function(callback){self.callbacks.playheadTimeChanged=callback;return self};self.onVolumeChanged=function(callback){self.callbacks.volumeChanged=callback;return self};self.onVideoError=function(callback){self.callbacks.videoError=callback;return self};self.bindPlayerContainerHandlers=function(){var self=this;self.playerContainer.on(TWP.PostTV.EVENTS.PLAY_NEXT_VIDEO,self.onPlayNextVideo).on(TWP.PostTV.EVENTS.PLAY,function(){self.mb.publish(OO.EVENTS.PLAY,{showPauseButton:true})}).on(TWP.PostTV.EVENTS.PAUSE,function(){self.mb.publish(OO.EVENTS.PAUSE,{showPlayButton:true})}).on(TWP.PostTV.EVENTS.DESTROY,function(){self.destroy()}).on(TWP.PostTV.EVENTS.SET_VOLUME,function(e,volume){self.setVolume(volume)}).on(TWP.PostTV.EVENTS.SEEK,function(e,playheadTime){self.setPlayheadTime(playheadTime)}).on(TWP.PostTV.EVENTS.SKIP_AD,function(){self.skipAd()}).on(TWP.PostTV.EVENTS.SEND_TRACKING_DATA,self.handleTrackingData)};self.initPluginControl=function(){var $html=$("html"),pluginsToBeLoaded=$html.data("oo-plugins-to-be-loaded")||[];function isTruthy(a){return a==="true"||parseInt(a)===1}if(isTruthy(self.playerContainer.attr("data-use-custom-scrubber"))&&!$html.data("ptv-scrubber-loaded")){pluginsToBeLoaded.push("scrubber")}if(isTruthy(self.playerContainer.attr("data-show-endscreen"))&&!$html.data("ptv-endscreen-loaded")){pluginsToBeLoaded.push("endscreen")}if(isTruthy(self.playerContainer.attr("data-truth-teller-enabled"))&&!$html.data("ptv-truthteller-loaded")){pluginsToBeLoaded.push("truthteller")}if(pluginsToBeLoaded.length>0){$("html").data("oo-plugins-to-be-loaded",pluginsToBeLoaded);$html.on(TWP.PostTV.EVENTS.OO_PLUGIN_LOADED,function(e,data){var pluginsToBeLoaded=$(this).data("oo-plugins-to-be-loaded"),i=$.inArray(data,pluginsToBeLoaded);if(data&&i>-1){pluginsToBeLoaded.splice(i,1)}if(pluginsToBeLoaded.length===0){self.ooPluginsLoaded=true;$(this).off(TWP.PostTV.EVENTS.OO_PLUGIN_LOADED).trigger(TWP.PostTV.EVENTS.OO_PLUGIN_FULLY_LOADED)}})}else{self.ooPluginsLoaded=true;$html.trigger(TWP.PostTV.EVENTS.OO_PLUGIN_FULLY_LOADED)}};return(function(){self.json=args.json||{};self.embedCode=args.embedCode||("contentConfig" in self.json?self.json.contentConfig.videoContentId:"");self.methodeUuid=("contentConfig" in self.json?self.json.contentConfig.uuid:"");self.playerContainerId=args.playerContainerId||"ooyala-player-container";self.playerContainer=$("#"+self.playerContainerId);self.bindPlayerContainerHandlers();self.playerType=args.playerType||"";self.isModal=$("#"+self.playerContainerId).hasClass("modal");self.isAutoplaying=false;self.width=args.width||$("#"+self.playerContainerId).width()||480;self.height=args.height||parseInt(self.width*270/480)||270;self.ooArgs=args.ooArgs||{};self.ooPlayer=null;self.callbacks={};self.mbSubscriber=args.playerType||"default-video-page";self.autoplay=TWP.PostTV.isTablet||TWP.PostTV.isMobile?false:typeof args.autoplay=="string"?!!parseInt(args.autoplay):args.autoplay||false;self.initialTime=args.initialTime||0;self.wmode=args.wmode||"opaque";self.showEndscreen=(typeof args.showEndscreen!="undefined"?args.showEndscreen:false);self.hide=!!args.hide?args.hide:self.showEndscreen?"info,sharing,channels,embed":"info,sharing,channels,embed,endscreen";self.flashParams=args.flashParams||{};self.locale=args.locale||{};self.loop=!!args.loop||false;self.css=args.css?args.css:TWP.PostTV.isMobile?"#"+self.playerContainerId+" div.oo_ads_countdown { display: none !important; }":"";self.version=args.version||2;self.playheadTime=0;self.volume=isNaN(Number(args.volume))?self.getVolumeFromCookie():Number(args.volume);self.playerCreated=false;self.showAdsForFirstVideoOnly=typeof args.showAdsForFirstVideoOnly==="boolean"?args.showAdsForFirstVideoOnly:false;self.initAds(self.json);self.updateMetaFromJSON(self.json);self.innerWrapper=null;self.isPlayingAds=false;self.hasPlayedAds=false;self.showCompanionAdIfAny=args.showCompanionAdIfAny!=undefined?args.showCompanionAdIfAny:args.hasCompanionAd!=undefined?args.hasCompanionAd:0;self.appendToOmniture={};self.trackingLevel=args.trackingLevel||"player-default-tracking";self.progressIntervals=parseInt(4);self.isPlaylist=args.isPlaylist||false;self.initProgress();self.initPluginControl();TWP.PostTV.players[self.playerContainerId]=self})()}}(jQuery));TWP.PostTV.InlinePlayerCounter=isNaN(TWP.PostTV.InlinePlayerCounter)?0:TWP.PostTV.InlinePlayerCounter;(function($){TWP.PostTV.InlinePlayer=TWP.PostTV.InlinePlayer||function(el,args){var self=this,isIE7=(document.all&&!document.querySelector)?true:false,init=function(el){self.json=args.json||{};self.callback=args.onload||null;self.preparePlayerContainer(el);return self},isTruthy=function(str){return str==="true"||parseInt(str)===1},isFalsy=function(str){return str==="false"||parseInt(str)===0};args=args||{};self.preparePlayerContainer=function(el){var container=$(el),autoplay=isFalsy(container.attr("data-autoplay"))?0:1,ajaxUrl=(typeof container.attr("data-video-uuid")!="undefined"?"http://www.washingtonpost.com/posttv/c/videojson/"+container.attr("data-video-uuid"):"");self.showEndscreen=(typeof container.attr("data-endscreen")=="undefined")||(typeof container.attr("data-endscreen")!="undefined"&&container.attr("data-endscreen")==1);self.playerType=(typeof container.attr("data-player-type")!="undefined"?container.attr("data-player-type"):"");self.initialTime=(typeof container.attr("data-initial-time")!="undefined"?(isNaN(parseFloat(container.attr("data-initial-time")))?0:parseFloat(container.attr("data-initial-time"))/1000):0);self.loop=isTruthy(container.attr("data-loop"));self.wmode=(typeof container.attr("data-wmode")!="undefined"?container.attr("data-wmode"):"");self.hide=(typeof container.attr("data-hide")!="undefined"?container.attr("data-hide"):"");self.css=(typeof container.attr("data-player-css")!="undefined"?container.attr("data-player-css"):"");self.trackingLevel=(typeof container.attr("data-tracking-level")!="undefined"?container.attr("data-tracking-level"):"");self.showCompanionAdIfAny=isFalsy(container.attr("data-companion-ad"))?0:1;self.adSetCode=(typeof container.attr("data-adset-code")!="undefined"?container.attr("data-adset-code"):"");self.adLengthParam=(typeof container.attr("data-ad-length-param")!="undefined"?container.attr("data-ad-length-param"):"");self.adZone=(typeof container.attr("data-ad-zone")!="undefined"?container.attr("data-ad-zone"):"");self.adFreq=(typeof container.attr("data-ad-freq")!="undefined"?container.attr("data-ad-freq"):TWP.PostTV.adFrequency);self.allowAd=container.attr("data-show-ad")==="-1"||isTruthy(container.attr("data-show-ad"))?-1:container.attr("data-show-ad")==="0"||container.attr("data-show-ad")==="false"?0:"";self.showAdsForFirstVideoOnly=isTruthy(container.attr("data-show-ads-for-first-video-only"));self.volume=(isNaN(Number(container.attr("data-volume")))?1:container.attr("data-volume"));self.useCustomScrubber=(typeof container.attr("data-use-custom-scrubber")!="undefined"?container.attr("data-use-custom-scrubber")==1:false);var createPlayer=function(json){self.player=new TWP.PostTV.Player({json:json,playerContainerId:container.attr("id"),autoplay:autoplay,playerType:self.playerType,initialTime:self.initialTime,loop:self.loop,wmode:self.wmode,css:self.css,trackingLevel:self.trackingLevel,showCompanionAdIfAny:self.showCompanionAdIfAny,adSetCode:self.adSetCode,adLengthParam:self.adLengthParam,adZone:self.adZone,adFreq:self.adFreq,allowAd:self.allowAd,showAdsForFirstVideoOnly:self.showAdsForFirstVideoOnly,volume:self.volume,hide:!!self.hide?self.hide:self.useCustomScrubber?"all":"",showEndscreen:self.showEndscreen});self.player.onCompanionAdsReady(function(){if(self.player.showCompanionAdIfAny&&!self.player.isFullscreen()){self.player.companionOpts=!$.isEmptyObject(args.companionOpts)?args.companionOpts:{companionClassName:"mp-companion-ad"};if(isIE7){var ie7Styles={style:{position:"absolute",paddingLeft:"25px"}};jQuery.extend(true,self.player.companionOpts,ie7Styles)}self.player.prepareCompanionAd(self.player.companionOpts);self.player.showCompanionAd()}if(!!args.callbacks&&typeof args.callbacks.onCompanionAdsReady=="function"){args.callbacks.onCompanionAdsReady(self.player)}return self.player});self.player.onAdCompleted(function(){self.player.removeCompanionAd();if(!!args.callbacks&&typeof args.callbacks.onAdCompleted=="function"){args.callbacks.onAdCompleted(self.player)}return self.player});self.player.onPlayStarted(function(){if(self.player.innerWrapper.width()!=self.player.getPlayerContainerWidth()){self.player.removeCompanionAd()}if(!!args.callbacks&&typeof args.callbacks.onPlayStarted=="function"){args.callbacks.onPlayStarted(self.player)}});if(self.callback){self.player.onEmbedCodeChanged(function(){self.callback(self.player)})}if(!!args.callbacks){if(typeof args.callbacks.onPlayerCreated=="function"){self.player.onPlayerCreated(function(){args.callbacks.onPlayerCreated(self.player)})}if(typeof args.callbacks.onEmbedCodeChanged=="function"){self.player.onEmbedCodeChanged(function(){args.callbacks.onEmbedCodeChanged(self.player)})}if(typeof args.callbacks.onContentTreeFetched=="function"){self.player.onContentTreeFetched(function(){args.callbacks.onContentTreeFetched(self.player)})}if(typeof args.callbacks.onPlayCompleted=="function"){self.player.onPlayCompleted(function(){args.callbacks.onPlayCompleted(self.player)})}if(typeof args.callbacks.onAdStarted=="function"){self.player.onAdStarted(function(){args.callbacks.onAdStarted(self.player)})}if(typeof args.callbacks.onPlayheadTimeChanged=="function"){self.player.onPlayheadTimeChanged(function(){args.callbacks.onPlayheadTimeChanged(self.player)})}if(typeof args.callbacks.onVolumeChanged=="function"){self.player.onVolumeChanged(function(){args.callbacks.onVolumeChanged(self.player)})}if(typeof args.callbacks.onVideoError=="function"){self.player.onVideoError(function(){args.callbacks.onVideoError(self.player)})}}self.player.create()};if($.isEmptyObject(self.json)){$.ajax({type:"GET",url:ajaxUrl,contentType:"application/json",jsonpCallback:"cb_"+container.attr("data-video-uuid").replace(/-/g,""),data:{resType:"jsonp"},dataType:"jsonp",cache:true,success:function(data){createPlayer(data[0])},error:function(e){if(typeof window.console==="function"){console.log("Failed to fetch video jsonp at: "+ajaxUrl+", e: "+e.message)}self.sendTrackingData("PostTV Player Data Error",["event999"],{errorCode:"ptv_cannotRetrieveVideoJson",errorText:"Cannot retrieve video json data at: "+ajaxUrl})}})}else{createPlayer(self.json)}return self};return init(el)};TWP.PostTV.initInlinePlayer=TWP.PostTV.initInlinePlayer||function(obj,args){args=args||{};var $video=$(obj).filter(":not(.ooyala-player-processed)");if(!!$video.size()){new TWP.PostTV.InlinePlayer($video.get(0),args);$video.removeClass("ooyala-player").addClass("ooyala-player-processed")}}})(jQuery)}if(typeof EMBED_PLAYER_TYPE=="undefined"){ooyalaPlayerJs()};

/* /resources/js/posttv/ooyala/ooyala-companion-ads.js */
function ooyalaCompanionAdsJs(){var a=a||0;if(!a){a++;TWP=window.TWP||{};TWP.PostTV=TWP.PostTV||{};(function(b){TWP.PostTV.ooyalaVASTCompanionAds=TWP.PostTV.ooyalaVASTCompanionAds||function(){var k,j;function l(){var n=null;if(j.contentDocument){n=j.contentDocument}else{if(j.contentWindow){n=j.contentWindow.document}else{if(j.document){n=j.document}}}}function g(o,r,q,n){var s=document.getElementById(o),p;p=document.createElement("iframe");p.id="ooyalaVASTCompanionAdIframe";p.width=q;p.height=n;p.marginWidth="0";p.marginHeight="0";p.scrolling="no";p.style.left="0px";p.style.top="0px";j=p;k=r;if(j.addEventListener){j.addEventListener("load",l,false)}else{if(j.attachEvent){j.detachEvent("onload",l);j.attachEvent("onload",l)}}p.src=r.url;s.appendChild(p)}function d(n,o){var p=document.getElementById(n);var q=[];q.push('<a target="_blank" href="');q.push(o.clickThroughUrl);q.push('"><img src="');q.push(o.url);q.push('"/></a>');p.innerHTML=q.join("")}function h(n,o){var p=document.getElementById(n);var q=[];q.push('<a target="_blank" href="');q.push(o.CompanionClickThrough);q.push('"><img src="');q.push(o.url);q.push('"/></a>');p.innerHTML=q.join("")}function e(o,q,p,n){var s=[],r="#"+o;s.push('<script type="text/javascript" src="');s.push(q.url);s.push('"><\/script>');b(r).html(writeCapture.sanitize(s.join(""),{asyncAll:true,done:function(){}}))}function c(n,o){var p=document.getElementById(n);p.innerHTML=o.htmlCode}function f(n){return(n.resourceType=="static"||n.resourceType=="iframe")}function m(n){return typeof n.resourceType==="string"?n.resourceType.toLowerCase().indexOf("iframe")>=0:false}function i(o){var n=typeof o==="string"?o.toLowerCase():"",p=false;if(n.indexOf("image")==0||["jpeg","jpg","gif","png","tiff"].indexOf(n)>=0){p=true}return p}return{show:function(o,q,p,n){if(q.htmlCode){c(o,q)}else{if(m(q)){g(o,q,p,n)}else{var r=q.creativeType||"";if(i(r)){d(o,q)}else{h(o,q)}}}}}}()})(jQuery)}}if(typeof EMBED_PLAYER_TYPE=="undefined"){ooyalaCompanionAdsJs()};

